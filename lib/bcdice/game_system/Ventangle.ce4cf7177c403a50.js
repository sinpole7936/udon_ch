(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[1567],{6509:(ge,pe,he)=>{he(5151),Opal.modules["i18n/backend/fallbacks"]=function(e){var H,$,t,c,u,v,F=e.module,B=e.class_variable_set,_=e.truthy,C=e.class_variable_get,R=e.def,q=e.send,M=e.send2,w=e.find_super,E=e.hash2,N=e.find_block_super,V=e.neqeq,j=e.thrower,A=e.return_val,U=[],L=e.nil,d=e.$$$;return H=U,v=[u=F(U[0],"I18n")].concat(H),B(v[0],"@@fallbacks",L),$=e.get_singleton_class(u),t=[$].concat(v),c=e.$r(t),R($,"$fallbacks",function(){var T=L;return B(t[1],"@@fallbacks",_(null!=t[1].$$cvars["@@fallbacks"]?"class variable":L)&&_(T=C(t[1],"@@fallbacks",!1))?T:d(d(c("I18n"),"Locale"),"Fallbacks").$new()),_(T=c("Thread").$current()["$[]"]("i18n_fallbacks"))?T:C(t[1],"@@fallbacks",!1)}),R($,"$fallbacks=",function(z){var T;return B(t[1],"@@fallbacks",_(z["$is_a?"](c("Array")))?d(d(c("I18n"),"Locale"),"Fallbacks").$new(z):z),T=["i18n_fallbacks",C(t[1],"@@fallbacks",!1)],q(c("Thread").$current(),"[]=",T),T[T.length-1]}),function($,D){var z,T,I,y,c=[F($,"Backend")].concat(D);return z=c,I=[T=F(c[0],"Fallbacks")].concat(z),y=e.$r(I),R(T,"$translate",function g(l,m,s){try{var b=j("return"),a=g.$$p||L,k=this,P=L,o=L;return g.$$p=null,null==s&&(s=y("EMPTY_HASH")),_(s.$fetch("fallback",!0))?_(s["$[]"]("fallback_in_progress"))?M(k,w(k,"translate",g,!1,!0),"translate",[l,m,s],a):(_(s["$[]"]("default"))&&(P=k["$extract_non_symbol_default!"](s)),o=s.$merge(E(["fallback_in_progress"],{fallback_in_progress:!0})),q(y("I18n").$fallbacks()["$[]"](l),"each",[],function r(x){var n=null==r.$$s?this:r.$$s;null==x&&(x=L);try{return q(n,"catch",["exception"],function f(){var i=null==f.$$s?this:f.$$s,G=L;if(G=M(i,N(i,"translate",f.$$def||r.$$def||g,!1,!1),"translate",[x,m,o],null),_(G["$nil?"]()))return L;V(l.$to_s(),x.$to_s())&&i.$on_fallback(l,x,m,s),b.$throw(G)},{$$s:n,$$ret:b})}catch(f){if(!e.rescue(f,[d(y("I18n"),"InvalidLocale")]))throw f;try{return L}finally{e.pop_exception()}}},{$$s:k}),_(s["$key?"]("default"))&&_(s["$[]"]("default")["$nil?"]())?L:_(P)?M(k,w(k,"translate",g,!1,!0),"translate",[l,L,s.$merge(E(["default"],{default:P}))],null):k.$throw("exception",d(y("I18n"),"MissingTranslation").$new(l,m,s))):M(k,w(k,"translate",g,!1,!0),"translate",[l,m,s],a)}catch(r){if(r===b)return r.$v;throw r}},-3),R(T,"$extract_non_symbol_default!",function(l){var s,m=L;return m=[l["$[]"]("default")].$flatten(),s=q(m,"detect",[],function(a){return null==a&&(a=L),a["$is_a?"](y("Symbol"))["$!"]()}),_(s)&&l["$[]="]("default",m["$[]"](0,m.$index(s))),s}),R(T,"$exists?",function g(l,m,s){try{var b=j("return"),a=g.$$p||L,k=this;return g.$$p=null,null==s&&(s=y("EMPTY_HASH")),_(s.$fetch("fallback",!0))?(q(y("I18n").$fallbacks()["$[]"](l),"each",[],function P(o){var r=null==P.$$s?this:P.$$s;null==o&&(o=L);try{if(!_(M(r,N(r,"exists?",P.$$def||g,!1,!1),"exists?",[o,m],null)))return L;b.$throw(!0)}catch(x){if(!e.rescue(x,[d(y("I18n"),"InvalidLocale")]))throw x;try{return L}finally{e.pop_exception()}}},{$$s:k,$$ret:b}),!1):M(k,w(k,"exists?",g,!1,!0),"exists?",[l,m,s],a)}catch(P){if(P===b)return P.$v;throw P}},-3),T.$private(),R(T,"$on_fallback",A(L))}(v[0],v)},Opal.modules["bcdice/randomizer"]=function(e){var u,h,z,T,I,y,$,D,B=e.klass,_=e.const_set,C=e.def,R=e.truthy,q=e.rb_gt,M=e.rb_plus,w=e.rb_le,E=e.send,N=e.rb_minus,V=e.eqeq,j=e.rb_times,A=e.eqeqeq,U=e.rb_ge,L=[],d=e.nil,W=e.$$$;return u=L,$=[(0,e.module)(L[0],"BCDice")].concat(u),D=e.$r($),h=$,T=[z=B($[0],null,"Randomizer")].concat(h),I=e.$r(T),(y=z.$$prototype).rand_results=y.detailed_rand_results=d,_(T[0],"UPPER_LIMIT_DICE_TIMES",200),_(T[0],"UPPER_LIMIT_DICE_SIDES",1e4),_(T[0],"UPPER_LIMIT_RANDS",1e4),C(z,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),z.$attr_reader("rand_results"),z.$attr_reader("detailed_rand_results"),_(T[0],"DetailedRandResult",I("Struct").$new("kind","sides","value")),C(z,"$roll_barabara",function(l,m){var s=this;return R(q(M(s.rand_results.$size(),l),I("UPPER_LIMIT_RANDS")))&&s.$raise(I("TooManyRandsError")),R(w(l,0))||R(q(l,I("UPPER_LIMIT_DICE_TIMES")))?[]:E(I("Array"),"new",[l],function b(){return(null==b.$$s?this:b.$$s).$roll_once(m)},{$$s:s})}),C(z,"$roll_sum",function(l,m){return this.$roll_barabara(l,m).$sum()}),C(z,"$roll_once",function(l){var s=d;return R(w(l,0))||R(q(l,I("UPPER_LIMIT_DICE_SIDES")))?0:(s=this.$rand_inner(l),this.$push_to_detail("normal",l,s),s)}),C(z,"$roll_index",function(l){return N(this.$roll_once(l),1)}),C(z,"$roll_tens_d10",function(){var s,m=d;return m=this.$rand_inner(10),V(m,10)&&(m=0),s=j(m,10),this.$push_to_detail("tens_d10",10,s),s}),C(z,"$roll_d9",function(){var m;return m=N(this.$rand_inner(10),1),this.$push_to_detail("d9",10,m),m}),C(z,"$roll_d66",function(l){var b,s=d;return s=E(I("Array"),"new",[2],function a(){return(null==a.$$s?this:a.$$s).$roll_once(6)},{$$s:this}),A(W(I("D66SortType"),"ASC"),b=l)?s["$sort!"]():A(W(I("D66SortType"),"DESC"),b)&&s["$sort!"]()["$reverse!"](),M(j(s["$[]"](0),10),s["$[]"](1))}),z.$private(),C(z,"$rand_inner",function(l){var s,m=this;return R(U(m.rand_results.$size(),I("UPPER_LIMIT_RANDS")))&&m.$raise(I("TooManyRandsError")),s=m.$random(l),m.rand_results["$<<"]([s,l]),s}),C(z,"$random",function(l){return M(I("Kernel").$rand(l),1)}),C(z,"$push_to_detail",function(l,m,s){var a;return a=I("DetailedRandResult").$new(l,m,s),this.detailed_rand_results.$push(a)}),B($[0],D("StandardError"),"TooManyRandsError"),d},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var E,A,H,u,v,$,D,L,V,F=e.module,B=e.klass,_=e.def,C=e.truthy,R=e.return_val,q=[],M=e.nil;return E=q,A=V=[F(q[0],"BCDice")].concat(E),H=L=[F(V[0],"DiceTable")].concat(A),v=[u=B(L[0],null,"RollResult")].concat(H),$=e.$r(v),(D=u.$$prototype).table_name=D.value=D.body=M,_(u,"$initialize",function(c,h,z){var T=this;return T.table_name=c,T.value=h,T.body=z}),u.$attr_reader("table_name"),u.$attr_reader("value"),u.$attr_reader("body"),_(u,"$to_s",function(){var c=this;return c.table_name+"("+c.value+") \uff1e "+c.body}),_(u,"$last_body",function(){var c=this;return C(c.body["$is_a?"]($("RollResult")))?c.body.$last_body():c.body}),_(u,"$empty?",R(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var E,A,H,u,v,$,D,L,V,F=e.module,B=e.klass,_=e.truthy,C=e.def,R=e.rb_minus,q=[],M=e.nil;return E=q,A=V=[F(q[0],"BCDice")].concat(E),H=L=[F(V[0],"DiceTable")].concat(A),v=[u=B(L[0],null,"ChainTable")].concat(H),$=e.$r(v),(D=u.$$prototype).times=D.sides=D.items=D.name=M,C(u,"$initialize",function(c,h,z){var T=this,I=M;return T.name=c,T.items=z.$freeze(),I=/(\d+)D(\d+)/i.$match(h),_(I)||T.$raise($("ArgumentError"),"Unexpected table type: "+h),T.times=I["$[]"](1).$to_i(),T.sides=I["$[]"](2).$to_i()}),C(u,"$roll",function(c){var z,T,h=this,I=M;return z=c.$roll_sum(h.times,h.sides),T=R(z,h.times),I=h.items["$[]"](T),_(I["$respond_to?"]("roll"))&&(I=I.$roll(c)),$("RollResult").$new(h.name,z,I)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var j,d,$,D,t,c,h,H,U,F=e.module,B=e.klass,_=e.hash2,C=e.defs,R=e.def,q=e.rb_plus,M=e.rb_times,w=e.rb_minus,E=[],N=e.nil;return j=E,d=U=[F(E[0],"BCDice")].concat(j),$=H=[F(U[0],"DiceTable")].concat(d),t=[D=B(H[0],null,"D66GridTable")].concat($),c=e.$r(t),(h=D.$$prototype).name=h.items=N,C(D,"$from_i18n",function(T,I){var g=N;return g=c("I18n").$t(T,_(["locale","raise"],{locale:I,raise:!0})),this.$new(g["$[]"]("name"),g["$[]"]("items"))}),R(D,"$initialize",function(T,I){return this.name=T,this.items=I.$freeze()}),R(D,"$roll",function(T){var y,g,l,m,s;return y=T.$roll_once(6),g=T.$roll_once(6),l=q(M(y,10),g),m=w(y,1),s=w(g,1),c("RollResult").$new(this.name,l,this.items["$[]"](m)["$[]"](s))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var N,U,v,$,D,t,d,W,j,F=e.module,B=e.klass,_=e.hash2,C=e.defs,R=e.def,M=[],w=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),N=M,U=j=[F(M[0],"BCDice")].concat(N),d=[F(j[0],"DiceTable")].concat(U),W=e.$r(d),v=d,D=[$=B(d[0],W("D66GridTable"),"D66HalfGridTable")].concat(v),t=e.$r(D),C($,"$from_i18n",function(h,z){var I=w;return I=t("I18n").$t(h,_(["locale","raise"],{locale:z,raise:!0})),this.$new(I["$[]"]("name"),I["$[]"]("items_1_2_3"),I["$[]"]("items_4_5_6"))}),R($,"$initialize",function(h,z,T){return this.name=h,this.items=[z,z,z,T,T,T].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var N,U,v,$,D,t,d,W,j,F=e.module,B=e.klass,_=e.hash2,C=e.defs,R=e.def,M=[],w=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),N=M,U=j=[F(M[0],"BCDice")].concat(N),d=[F(j[0],"DiceTable")].concat(U),W=e.$r(d),v=d,D=[$=B(d[0],W("D66GridTable"),"D66OneThirdTable")].concat(v),t=e.$r(D),C($,"$from_i18n",function(h,z){var I=w;return I=t("I18n").$t(h,_(["locale","raise"],{locale:z,raise:!0})),this.$new(I["$[]"]("name"),I["$[]"]("items_1_2"),I["$[]"]("items_3_4"),I["$[]"]("items_5_6"))}),R($,"$initialize",function(h,z,T,I){return this.name=h,this.items=[z,z,T,T,I,I].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var U,H,t,c,h,z,T,v,d,F=e.module,B=e.klass,_=e.hash2,C=e.defs,R=e.def,q=e.eqeqeq,M=e.rb_plus,w=e.rb_times,E=e.truthy,N=[],V=e.nil,j=e.$$$;return U=N,H=d=[F(N[0],"BCDice")].concat(U),t=v=[F(d[0],"DiceTable")].concat(H),h=[c=B(v[0],null,"D66Table")].concat(t),z=e.$r(h),(T=c.$$prototype).sort_type=T.items=T.name=V,C(c,"$from_i18n",function(y,g){var s,m=V;return m=z("I18n").$t(y,_(["locale"],{locale:g})),s=z("D66SortType").$const_get(m["$[]"]("d66_sort_type")),this.$new(m["$[]"]("name"),s,m["$[]"]("items"))}),R(c,"$initialize",function(y,g,l){var m=this;return m.name=y,m.sort_type=g,m.items=l.$freeze()}),R(c,"$roll",function(y){var g=this,l=V,m=V,s=V,b=V;return l=y.$roll_barabara(2,6),q(j(z("D66SortType"),"ASC"),m=g.sort_type)?l["$sort!"]():q(j(z("D66SortType"),"DESC"),m)&&l["$sort!"]()["$reverse!"](),s=M(w(l["$[]"](0),10),l["$[]"](1)),b=E(m=g.items["$[]"](s))?m:g.items["$[]"](s.$to_s()),E(b["$respond_to?"]("roll"))&&(b=b.$roll(y)),z("RollResult").$new(g.name,s,b)}),R(c,"$choice",function(y){return z("RollResult").$new(this.name,y,this.items["$[]"](y))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var L,u,$,D,W,F=e.module,B=e.klass,_=e.hash2,C=e.send,R=e.to_ary,q=e.rb_plus,M=e.rb_times,w=e.send2,E=e.find_super,N=e.def,j=[],A=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),L=j,u=W=[F(j[0],"BCDice")].concat(L),$=[F(W[0],"DiceTable")].concat(u),D=e.$r($),N(B($[0],D("D66Table"),"D66LeftRangeTable"),"$initialize",function z(T,I,y){var m;return z.$$p=null,m=_([],{}),C(y,"each",[],function(b){var a,o;return null==b&&(b=A),a=R(b),o=null==a[1]?A:a[1],C(null==a[0]?A:a[0],"each",[],function(x){return null==x&&(x=A),C(o,"each_with_index",[],function(f,i){var G,Q;return null==f&&(f=A),null==i&&(i=A),Q=q(M(x,10),q(i,1)),C(m,"[]=",G=[Q,f]),G[G.length-1]})})}),w(this,E(this,"initialize",z,!1,!0),"initialize",[T,I,m],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var A,W,D,t,c,h,z,u,L,F=e.module,B=e.klass,_=e.hash2,C=e.defs,R=e.def,q=e.truthy,M=e.rb_minus,w=e.rb_plus,E=e.rb_times,N=[],V=e.nil;return A=N,W=L=[F(N[0],"BCDice")].concat(A),D=u=[F(L[0],"DiceTable")].concat(W),c=[t=B(u[0],null,"D66ParityTable")].concat(D),h=e.$r(c),(z=t.$$prototype).odd=z.even=z.name=V,C(t,"$from_i18n",function(I,y){var l=V;return l=h("I18n").$t(I,_(["locale","raise"],{locale:y,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("odd"),l["$[]"]("even"))}),R(t,"$initialize",function(I,y,g){var l=this;return l.name=I,l.odd=y.$freeze(),l.even=g.$freeze()}),R(t,"$roll",function(I){var l,s,b,y=this,g=V;return g=I.$roll_once(6),l=I.$roll_once(6),s=(q(g["$odd?"]())?y.odd:y.even)["$[]"](M(l,1)),b=w(E(g,10),l),h("RollResult").$new(y.name,b,s)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var N,U,u,v,$,D,t,d,j,F=e.module,B=e.klass,_=e.def,C=e.rb_plus,R=e.rb_times,q=e.send,M=[],w=e.nil;return N=M,U=j=[F(M[0],"BCDice")].concat(N),u=d=[F(j[0],"DiceTable")].concat(U),$=[v=B(d[0],null,"D66RangeTable")].concat(u),D=e.$r($),(t=v.$$prototype).items=t.name=w,_(v,"$initialize",function(h,z){return this.name=h,this.items=z.$freeze()}),_(v,"$roll",function(h){var T,I,y,g=w;return T=h.$roll_once(6),I=h.$roll_once(6),y=C(R(T,10),I),g=q(this.items,"find",[],function(m){return null==m&&(m=w),m["$[]"](0)["$include?"](y)}),D("RollResult").$new(this.name,y,g["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var L,u,c,y,l,m,h,z,T,I,$,W,F=e.module,B=e.klass,_=e.const_set,C=e.send,R=e.hash2,q=e.def,M=e.eqeqeq,w=e.truthy,E=e.to_a,N=e.rb_times,V=e.rb_plus,j=[],A=e.nil;return L=j,u=W=[F(j[0],"BCDice")].concat(L),c=$=[F(W[0],"DiceTable")].concat(u),z=[h=B($[0],null,"RangeTable")].concat(c),T=e.$r(z),(I=h.$$prototype).name=I.items=I.num_of_dice=I.num_of_sides=I.formatter=A,_(z[0],"RollResult",C(T("Struct"),"new",["sum","values","content","formatted"],function y(){return(null==y.$$s?this:y.$$s).$alias_method("to_s","formatted")},{$$s:h})),_(z[0],"Item",T("Struct").$new("range","content")),_(z[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),_(z[0],"DEFAULT_FORMATTER",C(h,"lambda",[],function(g,l){return null==g&&(g=A),null==l&&(l=A),g.$name()+"("+l.$sum()+") \uff1e "+l.$content()})),h.$attr_reader("name"),h.$attr_reader("num_of_dice"),h.$attr_reader("num_of_sides"),l=[y=e.get_singleton_class(h)].concat(z),m=e.$r(l),q(y,"$from_i18n",function(b,a){var o,P=A;return P=m("I18n").$t(b,R(["locale"],{locale:a})),o=C(P["$[]"]("items"),"map",[],function r(x){return null==x&&(x=A),[(null==r.$$s?this:r.$$s).$conv_string_range(x["$[]"](0)),x["$[]"](1)]},{$$s:this}),this.$new(P["$[]"]("name"),P["$[]"]("type"),o)}),q(y,"$conv_string_range",function(b){var k,a=this;return null==a.name&&(a.name=A),M(m("Integer"),k=b)?b:M(m("String"),k)?w(b["$include?"](".."))?C(m("Range"),"new",E(C(b.$split("..",2),"map",[],function P(o){return null==o&&(o=A),(null==P.$$s?this:P.$$s).$Integer(o)},{$$s:a}))):a.$Integer(b):a.$raise(m("TypeError"),a.name+": "+b+" ("+b.$class()+") must be a String or an Integer")}),q(h,"$initialize",function y(g,l,m){var a,s=y.$$p||A,b=this,k=A;return y.$$p=null,b.name=g.$freeze(),b.formatter=w(a=s)?a:T("DEFAULT_FORMATTER"),k=T("DICE_ROLL_METHOD_RE").$match(l),w(k)||b.$raise(T("ArgumentError"),b.name+": invalid dice roll method: "+l),b.num_of_dice=k["$[]"](1).$to_i(),b.num_of_sides=k["$[]"](2).$to_i(),b.$store(m)}),q(h,"$fetch",function(g){var m,l=this;return m=C(l.items,"find",[],function(b){return null==b&&(b=A),b.$range()["$include?"](g)}),w(m)||l.$raise(T("RangeError"),l.name+": value is out of range: "+g),m}),q(h,"$roll",function(g){var s,l=this,m=A,b=A;return s=(m=g.$roll_barabara(l.num_of_dice,l.num_of_sides)).$sum(),(b=T("RollResult").$new(s,m,l.$fetch(s).$content()))["$formatted="](l.formatter["$[]"](l,b)),b}),h.$private(),q(h,"$store",function(g){var m,s,l=this;return m=C(g,"map",[],function b(a,k){return null==a&&(a=A),null==k&&(k=A),[(null==b.$$s?this:b.$$s).$coerce_to_int_range(a),k]},{$$s:l}),s=C(m,"sort_by",[],function(a,k){return null==a&&(a=A),null==k&&(k=A),a.$min()}),l.$assert_min_sum_is_covered(s),l.$assert_max_sum_is_covered(s),l.$assert_no_gap_or_overlap_in_ranges(s),l.items=C(s,"map",[],function(a,k){return null==a&&(a=A),null==k&&(k=A),T("Item").$new(a,k.$freeze()).$freeze()}).$freeze(),l}),q(h,"$coerce_to_int_range",function(g){var m;return M(T("Integer"),m=g)?T("Range").$new(g,g):M(T("Range"),m)&&w(g.$begin()["$is_a?"](T("Integer")))&&w(g.$end()["$is_a?"](T("Integer")))?g:this.$raise(T("TypeError"),this.name+": "+g+" ("+g.$class()+") must be an Integer or a Range with Integers ")}),q(h,"$assert_min_sum_is_covered",function(g){var m,l=this,s=A;return m=l.num_of_dice,s=g.$first()["$[]"](0),w(s["$include?"](m))||l.$raise(T("RangeError"),l.name+": min value ("+m+") is not covered: "+s),l}),q(h,"$assert_max_sum_is_covered",function(g){var m,l=this,s=A;return m=N(l.num_of_dice,l.num_of_sides),s=g.$last()["$[]"](0),w(s["$include?"](m))||l.$raise(T("RangeError"),l.name+": max value ("+m+") is not covered: "+s),l}),q(h,"$assert_no_gap_or_overlap_in_ranges",function(g){return C(g,"each_cons",[2],function m(s,b){var o,r,a=null==m.$$s?this:m.$$s,k=A,P=A;return null==a.name&&(a.name=A),null==s&&(s=A),null==b&&(b=A),k=s["$[]"](0),P=b["$[]"](0),o=k.$max(),r=V(o,1),w(P["$include?"](o))&&a.$raise(T("RangeError"),a.name+": Range overlap: "+k+" and "+P),w(P["$include?"](r))?A:a.$raise(T("RangeError"),a.name+": Range gap: "+k+" and "+P)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var V,L,v,h,z,T,I,D,W,A,F=e.module,B=e.klass,_=e.send,C=e.def,R=e.rb_minus,q=e.return_ivar,M=[],w=e.nil,E=e.$$$;return V=M,L=A=[F(M[0],"BCDice")].concat(V),v=W=[F(A[0],"DiceTable")].concat(L),h=D=[B(W[0],null,"SaiFicSkillTable")].concat(v),T=[z=B(D[0],null,"Category")].concat(h),I=e.$r(T),C(z,"$initialize",function(g,l,m,s){var b=this;return b.name=g,b.skills=_(l.$map(),"with_index",[2],function(k,P){return null==k&&(k=w),null==P&&(P=w),E(I("SaiFicSkillTable"),"Skill").$new(g,k,m,P,s)}),b.dice=m}),C(z,"$roll",function(g){return this.$skills()["$[]"](R(g.$roll_sum(2,6),2))}),C(z,"$to_s",q("name")),z.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var w,j,W,D,t,u,U,N,F=e.module,B=e.klass,_=e.def,C=e.hash2,R=[],q=e.nil;return w=R,j=N=[F(R[0],"BCDice")].concat(w),W=U=[F(N[0],"DiceTable")].concat(j),u=[B(U[0],null,"SaiFicSkillTable")].concat(W),(t=(D=B(u[0],null,"Skill")).$$prototype).s_format=t.category_dice=t.row_dice=t.category_name=t.name=q,_(D,"$initialize",function(h,z,T,I,y){var g=this;return g.category_name=h,g.name=z,g.category_dice=T,g.row_dice=I,g.s_format=y}),_(D,"$to_s",function(){var h=this;return h.$format(h.s_format,C(["category_dice","row_dice","category_name","skill_name"],{category_dice:h.category_dice,row_dice:h.row_dice,category_name:h.category_name,skill_name:h.name}))}),D.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var u,t,I,y,g,l,m,h,$,F=e.module,B=e.klass,_=e.ensure_kwargs,C=e.hash2,R=e.send,M=e.defs,w=e.const_set,E=e.to_ary,N=e.def,V=e.truthy,j=e.rb_minus,A=e.rb_plus,U=e.top,L=[],d=e.nil,W=e.$$$;return U.$require("bcdice/dice_table/sai_fic_skill_table/category"),U.$require("bcdice/dice_table/sai_fic_skill_table/skill"),u=L,t=$=[F(L[0],"BCDice")].concat(u),I=h=[F($[0],"DiceTable")].concat(t),g=[y=B(h[0],null,"SaiFicSkillTable")].concat(I),l=e.$r(g),(m=y.$$prototype).rtt=m.rtt_format=m.rct=m.rct_format=m.rttn=m.rttn_format=m.categories=d,M(y,"$from_i18n",function(b,a,k){var P,o,r,i,f=d;return null==(P=(k=_(k)).$$smap.rtt)&&(P=d),null==(o=k.$$smap.rct)&&(o=d),null==(r=k.$$smap.rttn)&&(r=d),i=(f=l("I18n").$t("RTT",C(["locale","raise","default"],{locale:a,raise:!1,default:C([],{})})).$merge(l("I18n").$t(b,C(["locale","raise"],{locale:a,raise:!0}))))["$[]"]("items"),f=R(f,"select",[],function(Q,K){return null==Q&&(Q=d),null==K&&(K=d),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Q)}),this.$new(i,e.to_hash(f).$merge(C(["rtt","rct","rttn"],{rtt:P,rct:o,rttn:r})))},-3),w(g[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),w(g[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),w(g[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),w(g[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),N(y,"$initialize",function(b,a){var k,P,o,r,x,n,f,i=this;return null==(k=(a=_(a)).$$smap.rtt)&&(k=d),null==(P=a.$$smap.rct)&&(P=d),null==(o=a.$$smap.rttn)&&(o=d),null==(r=a.$$smap.rtt_format)&&(r=l("DEFAULT_RTT")),null==(x=a.$$smap.rct_format)&&(x=l("DEFAULT_RCT")),null==(n=a.$$smap.rttn_format)&&(n=l("DEFAULT_RTTN")),null==(f=a.$$smap.s_format)&&(f=l("DEFAULT_S")),i.categories=R(b.$map(),"with_index",[1],function(Q,K){var $e,ce,ne;return null==Q&&(Q=d),null==K&&(K=d),ce=null==($e=E(Q))[0]?d:$e[0],ne=null==$e[1]?d:$e[1],W(l("SaiFicSkillTable"),"Category").$new(ce,ne,K,f)},{$$has_top_level_mlhs_arg:!0}),i.rtt=k,i.rct=P,i.rttn=o.$to_a(),i.rtt_format=r,i.rct_format=x,i.rttn_format=n},-2),w(g[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),y.$attr_reader("categories"),N(y,"$roll_command",function(b,a){var P,k=this,o=d,r=d;return V(["RTT",k.rtt]["$include?"](P=a))?k.$format_skill(k.rtt_format,k.$roll_skill(b)):V(["RCT",k.rct]["$include?"](P))?(o=k.$roll_category(b),k.$format(k.rct_format,C(["category_dice","category_name"],{category_dice:o.$dice(),category_name:o.$name()}))):V(r=l("RTTN").$index(P))||V(r=k.rttn.$index(P))?k.$format_skill(k.rttn_format,k.categories["$[]"](r).$roll(b)):d}),N(y,"$roll_category",function(b){return this.categories["$[]"](j(b.$roll_once(6),1))}),N(y,"$roll_skill",function(b){return this.$roll_category(b).$roll(b)}),N(y,"$prefixes",function(){var b=this;return A(["RTT[1-6]?","RCT",b.rtt,b.rct],b.rttn).$compact()}),y.$private(),N(y,"$format_skill",function(b,a){return this.$format(b,C(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:a.$category_dice(),row_dice:a.$row_dice(),category_name:a.$category_name(),skill_name:a.$name(),text:a.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var V,L,v,$,D,t,c,W,A,F=e.module,B=e.klass,_=e.hash2,C=e.defs,R=e.truthy,q=e.def,M=e.rb_minus,w=[],E=e.nil;return V=w,L=A=[F(w[0],"BCDice")].concat(V),v=W=[F(A[0],"DiceTable")].concat(L),D=[$=B(W[0],null,"Table")].concat(v),t=e.$r(D),(c=$.$$prototype).times=c.sides=c.name=c.items=E,C($,"$from_i18n",function(z,T){var y=E;return y=t("I18n").$t(z,_(["locale"],{locale:T})),this.$new(y["$[]"]("name"),y["$[]"]("type"),y["$[]"]("items"))}),q($,"$initialize",function(z,T,I){var y=this,g=E;return y.name=z,y.items=I.$freeze(),g=/(\d+)D(\d+)/i.$match(T),R(g)||y.$raise(t("ArgumentError"),"Unexpected table type: "+T),y.times=g["$[]"](1).$to_i(),y.sides=g["$[]"](2).$to_i()}),q($,"$roll",function(z){var I,T=this;return I=z.$roll_sum(T.times,T.sides),T.$choice(I)}),q($,"$choice",function(z){var I,T=this;return I=M(z,T.times),t("RollResult").$new(T.name,z,T.items["$[]"](I))})},Opal.modules["bcdice/dice_table"]=function(e){var F=e.top;return F.$require("bcdice/dice_table/roll_result"),F.$require("bcdice/dice_table/chain_table"),F.$require("bcdice/dice_table/d66_grid_table"),F.$require("bcdice/dice_table/d66_half_grid_table"),F.$require("bcdice/dice_table/d66_one_third_table"),F.$require("bcdice/dice_table/d66_left_range_table"),F.$require("bcdice/dice_table/d66_parity_table"),F.$require("bcdice/dice_table/d66_range_table"),F.$require("bcdice/dice_table/d66_table"),F.$require("bcdice/dice_table/range_table"),F.$require("bcdice/dice_table/sai_fic_skill_table"),F.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var q,N,j,w,F=e.module,B=e.const_set,_=[];return q=_,N=w=[F(_[0],"BCDice")].concat(q),j=[F(w[0],"D66SortType")].concat(N),B(j[0],"NO_SORT","no_sort"),B(j[0],"ASC","asc"),B(j[0],"DESC","desc"),function(E,N){var j=[F(E,"RoundType")].concat(N);return B(j[0],"CEIL","ceil"),B(j[0],"FLOOR","floor"),B(j[0],"ROUND","round")}(w[0],w)},Opal.modules["bcdice/translate"]=function(e){var N,U,L,d,W,j,F=e.module,B=e.ensure_kwargs,_=e.kwrestargs,R=e.hash2,q=e.def,M=[],w=e.nil;return N=M,U=j=[F(M[0],"BCDice")].concat(N),d=[L=F(j[0],"Translate")].concat(U),W=e.$r(d),q(L,"$translate",function(u,v){var $,D=this;return null==D.locale&&(D.locale=w),v=B(v),$=_(v,{}),W("I18n").$translate(u,R(["locale","raise"],{locale:D.locale,raise:!0}).$merge(e.to_hash($)))},-2)},Opal.modules["bcdice/result"]=function(e){var L,H,d,N,j,B=e.klass,_=e.send,C=e.def,R=e.return_val,q=e.return_ivar,M=[],w=e.nil;return N=M,L=j=[(0,e.module)(M[0],"BCDice")].concat(N),[d=B(j[0],null,"Result")].concat(L),C(H=e.get_singleton_class(d),"$success",function($){return _(this.$new(),"tap",[],function(c){var h;return null==c&&(c=w),c["$text="]($),_(c,"success=",h=[!0]),h[h.length-1]})}),C(H,"$failure",function($){return _(this.$new(),"tap",[],function(c){var h;return null==c&&(c=w),c["$text="]($),_(c,"failure=",h=[!0]),h[h.length-1]})}),C(H,"$critical",function($){return _(this.$new(),"tap",[],function(c){var h;return null==c&&(c=w),c["$text="]($),c["$critical="](!0),_(c,"success=",h=[!0]),h[h.length-1]})}),C(H,"$fumble",function($){return _(this.$new(),"tap",[],function(c){var h;return null==c&&(c=w),c["$text="]($),c["$fumble="](!0),_(c,"failure=",h=[!0]),h[h.length-1]})}),C(H,"$nothing",R("nothing")),C(d,"$initialize",function(u){var v=this;return null==u&&(u=w),v.text=u,v.rands=w,v.detailed_rands=w,v.secret=!1,v.success=!1,v.failure=!1,v.critical=!1,v.fumble=!1},-1),d.$attr_accessor("text","rands","detailed_rands"),d.$attr_writer("secret","success","failure","critical","fumble"),C(d,"$secret?",q("secret")),C(d,"$success?",q("success")),C(d,"$failure?",q("failure")),C(d,"$critical?",q("critical")),C(d,"$fumble?",q("fumble")),C(d,"$condition=",function(u){return this.success=u,this.failure=u["$!"]()})},Opal.modules["racc/parser"]=function(e){var z,I,y,F=e.module,B=e.klass,_=e.truthy,C=e.const_set,R=e.defs,q=e.gvars,M=e.rb_lt,w=e.def,E=e.to_ary,N=e.send,V=e.neqeq,j=e.rb_plus,A=e.eqeq,U=e.rb_ge,L=e.rb_gt,d=e.rb_minus,W=e.rb_le,H=e.rb_times,u=e.assign_ivar_val,$=[],D=e.$r($),t=e.nil,c=e.$$$;return z=$,I=[F($[0],"Racc")].concat(z),y=e.$r(I),B(I[0],y("StandardError"),"ParseError"),_(c("::","ParseError","skip_raise")?"constant":t)||C($[0],"ParseError",c(D("Racc"),"ParseError")),function(h,z){var s,b,a,k,P,y=[F(h,"Racc")].concat(z),g=e.$r(y);return _(g("Racc_No_Extensions","skip_raise")?"constant":t)||C(y[0],"Racc_No_Extensions",!1),s=y,a=[b=B(y[0],null,"Parser")].concat(s),k=e.$r(a),(P=b.$$prototype).yydebug=P.racc_debug_out=P.racc_error_status=P.racc_t=P.racc_vstack=P.racc_val=P.racc_state=P.racc_tstack=t,C(a[0],"Racc_Runtime_Version","1.4.6"),C(a[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),C(a[0],"Racc_Runtime_Core_Version_R","1.4.6"),C(a[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),C(a[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),C(a[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),C(a[0],"Racc_Runtime_Core_Version",k("Racc_Runtime_Core_Version_R")),C(a[0],"Racc_Runtime_Core_Revision",k("Racc_Runtime_Core_Revision_R")),C(a[0],"Racc_Runtime_Type","ruby"),R(k("Parser"),"$racc_runtime_type",function(){return k("Racc_Runtime_Type")}),w(b,"$_racc_setup",function(){var r,x,n=this,f=t,i=t;return null==q.stderr&&(q.stderr=t),_(c(n.$class(),"Racc_debug_parser"))||(n.yydebug=!1),_(null!=(r=n.yydebug)&&r!==t?"instance-variable":t)||(n.yydebug=!1),_(n.yydebug)&&(_(null!=(x=n.racc_debug_out)&&x!==t?"instance-variable":t)||(n.racc_debug_out=q.stderr),n.racc_debug_out=_(f=n.racc_debug_out)?f:q.stderr),i=c(n.$class(),"Racc_arg"),_(M(i.$size(),14))&&i["$[]="](13,!0),i}),w(b,"$_racc_init_sysvars",function(){var r=this;return r.racc_state=[0],r.racc_tstack=[],r.racc_vstack=[],r.racc_t=t,r.racc_val=t,r.racc_read_next=!0,r.racc_user_yyerror=!1,r.racc_error_status=0}),w(b,"$do_parse",function(){return this.$__send__(k("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),w(b,"$next_token",function(){return this.$raise(k("NotImplementedError"),this.$class()+"#next_token is not defined")}),w(b,"$_racc_do_parse_rb",function(r,x){var n,i=this,G=t,Q=t,K=t,$e=t,ce=t,ne=t,ue=t,ae=t;return n=E(r),G=null==n[0]?t:n[0],Q=null==n[1]?t:n[1],K=null==n[2]?t:n[2],$e=null==n[3]?t:n[3],ce=null==n[10]?t:n[10],i.$_racc_init_sysvars(),ne=ue=ae=t,N(i,"catch",["racc_end_parse"],function J(){var se,Y,p=null==J.$$s?this:J.$$s,Z=t;for(null==p.racc_state&&(p.racc_state=t),null==p.racc_read_next&&(p.racc_read_next=t),null==p.racc_t&&(p.racc_t=t),null==p.yydebug&&(p.yydebug=t),null==p.racc_val&&(p.racc_val=t);_(!0);)for(_(ae=$e["$[]"](p.racc_state["$[]"](-1)))?(_(p.racc_read_next)&&V(p.racc_t,0)&&(Y=p.$next_token(),se=E(Y),ne=null==se[0]?t:se[0],p.racc_val=null==se[1]?t:se[1],p.racc_t=_(ne)?_(Z=ce["$[]"](ne))?Z:1:0,_(p.yydebug)&&p.$racc_read_token(p.racc_t,ne,p.racc_val),p.racc_read_next=!1),ae=j(ae,p.racc_t),_(U(ae,0))&&_(ue=G["$[]"](ae))&&A(Q["$[]"](ae),p.racc_state["$[]"](-1))||(ue=K["$[]"](p.racc_state["$[]"](-1)))):ue=K["$[]"](p.racc_state["$[]"](-1));_(ue=p.$_racc_evalact(ue,r)););},{$$s:i})}),w(b,"$yyparse",function(r,x){return this.$__send__(k("Racc_YY_Parse_Method"),r,x,this.$_racc_setup(),!0)}),w(b,"$_racc_yyparse_rb",function(r,x,n,f){var i,Q=this,K=t,$e=t,ie=t,ce=t,ue=t,ae=t,J=t;return i=E(n),K=null==i[0]?t:i[0],$e=null==i[1]?t:i[1],ie=null==i[2]?t:i[2],ce=null==i[3]?t:i[3],ue=null==i[10]?t:i[10],Q.$_racc_init_sysvars(),ae=t,J=t,N(Q,"catch",["racc_end_parse"],function se(){var Y=null==se.$$s?this:se.$$s;for(null==Y.racc_state&&(Y.racc_state=t);!_(J=ce["$[]"](Y.racc_state["$[]"](-1)));)for(;_(ae=Y.$_racc_evalact(ie["$[]"](Y.racc_state["$[]"](-1)),n)););return N(r,"__send__",[x],function p(Z,X){var S=null==p.$$s?this:p.$$s,ee=t,te=t;for(null==S.racc_t&&(S.racc_t=t),null==S.racc_state&&(S.racc_state=t),null==S.racc_read_next&&(S.racc_read_next=t),null==Z&&(Z=t),null==X&&(X=t),S.racc_t=_(Z)?_(ee=ue["$[]"](Z))?ee:1:0,S.racc_val=X,S.racc_read_next=!1,J=j(J,S.racc_t),_(U(J,0))&&_(ae=K["$[]"](J))&&A($e["$[]"](J),S.racc_state["$[]"](-1))||(ae=ie["$[]"](S.racc_state["$[]"](-1)));_(ae=S.$_racc_evalact(ae,n)););for(;_(_(ee=_(te=(J=ce["$[]"](S.racc_state["$[]"](-1)))["$!"]())?te:S.racc_read_next["$!"]())?ee:S.racc_t["$=="](0));)for(_(J)&&_(J=j(J,S.racc_t))&&_(U(J,0))&&_(ae=K["$[]"](J))&&A($e["$[]"](J),S.racc_state["$[]"](-1))||(ae=ie["$[]"](S.racc_state["$[]"](-1)));_(ae=S.$_racc_evalact(ae,n)););},{$$s:Y})},{$$s:Q})}),w(b,"$_racc_evalact",function(r,x){var n,ie,i=this,G=t,Q=t,$e=t,ce=t,ne=t,ue=t;if(G=null==(n=E(x))[0]?t:n[0],Q=null==n[1]?t:n[1],$e=null==n[3]?t:n[3],ie=null==n[11]?t:n[11],ce=null==n[12]?t:n[12],_(L(r,0))&&_(M(r,ie)))_(L(i.racc_error_status,0))&&(A(i.racc_t,1)||(i.racc_error_status=d(i.racc_error_status,1))),i.racc_vstack.$push(i.racc_val),i.racc_state.$push(r),i.racc_read_next=!0,_(i.yydebug)&&(i.racc_tstack.$push(i.racc_t),i.$racc_shift(i.racc_t,i.racc_tstack,i.racc_vstack));else if(_(M(r,0))&&_(L(r,ce["$-@"]()))){if(ne=N(i,"catch",["racc_jump"],function ae(){var J=null==ae.$$s?this:ae.$$s;return null==J.racc_state&&(J.racc_state=t),J.racc_state.$push(J.$_racc_do_reduce(x,r)),!1},{$$s:i}),_(ne))switch(ne.valueOf()){case 1:return i.racc_user_yyerror=!0,ce["$-@"]();case 2:return ie;default:i.$raise("[Racc Bug] unknown jump code")}}else if(A(r,ie))_(i.yydebug)&&i.$racc_accept(),i.$throw("racc_end_parse",i.racc_vstack["$[]"](0));else{if(A(r,ce["$-@"]())){switch(i.racc_error_status.valueOf()){case 0:_(x["$[]"](21))||i.$on_error(i.racc_t,i.racc_val,i.racc_vstack);break;case 3:A(i.racc_t,0)&&i.$throw("racc_end_parse",t),i.racc_read_next=!0}for(i.racc_user_yyerror=!1,i.racc_error_status=3;_(!0)&&!(_(ue=$e["$[]"](i.racc_state["$[]"](-1)))&&(ue=j(ue,1),_(U(ue,0))&&_(r=G["$[]"](ue))&&A(Q["$[]"](ue),i.racc_state["$[]"](-1))));)_(W(i.racc_state.$size(),1))&&i.$throw("racc_end_parse",t),i.racc_state.$pop(),i.racc_vstack.$pop(),_(i.yydebug)&&(i.racc_tstack.$pop(),i.$racc_e_pop(i.racc_state,i.racc_tstack,i.racc_vstack));return r}i.$raise("[Racc Bug] unknown action "+r.$inspect())}return _(i.yydebug)&&i.$racc_next_state(i.racc_state["$[]"](-1),i.racc_state),t}),w(b,"$_racc_do_reduce",function(r,x){var n,ce,ue,Z,X,S,re,i=this,Q=t,K=t,$e=t,ie=t,ne=t,ae=t,J=t,se=t,Y=t,p=t,ee=t,te=t,O=t;return Q=null==(n=E(r))[4]?t:n[4],K=null==n[5]?t:n[5],$e=null==n[6]?t:n[6],ie=null==n[7]?t:n[7],ce=null==n[8]?t:n[8],ne=null==n[9]?t:n[9],ue=null==n[13]?t:n[13],ae=i.racc_state,J=i.racc_vstack,se=i.racc_tstack,Y=H(x,-3),p=ne["$[]"](Y),Z=ne["$[]"](j(Y,1)),X=ne["$[]"](j(Y,2)),S=[],_(i.yydebug)&&(ee=se["$[]"](p["$-@"](),p)),te=J["$[]"](p["$-@"](),p),_(i.yydebug)&&se["$[]="](p["$-@"](),p,S),J["$[]="](p["$-@"](),p,S),ae["$[]="](p["$-@"](),p,S),_(ue)?J.$push(i.$__send__(X,te,J,te["$[]"](0))):J.$push(i.$__send__(X,te,J)),se.$push(Z),_(i.yydebug)&&i.$racc_reduce(ee,Z,se,J),re=d(Z,ce),_(Y=ie["$[]"](re))&&(Y=j(Y,ae["$[]"](-1)),_(U(Y,0))&&_(O=Q["$[]"](Y))&&A(K["$[]"](Y),re))?O:$e["$[]"](re)}),w(b,"$on_error",function(r,x,n){var i,f=this;return f.$raise(k("ParseError"),f.$sprintf("\nparse error on value %s (%s)",x.$inspect(),_(i=f.$token_to_str(r))?i:"?"))}),w(b,"$yyerror",function(){return this.$throw("racc_jump",1)}),w(b,"$yyaccept",function(){return this.$throw("racc_jump",2)}),w(b,"$yyerrok",u("racc_error_status",0)),w(b,"$racc_read_token",function(r,x,n){var f=this;return f.racc_debug_out.$print("read    "),f.racc_debug_out.$print(x.$inspect(),"(",f.$racc_token2str(r),") "),f.racc_debug_out.$puts(n.$inspect()),f.racc_debug_out.$puts()}),w(b,"$racc_shift",function(r,x,n){var f=this;return f.racc_debug_out.$puts("shift   "+f.$racc_token2str(r)),f.$racc_print_stacks(x,n),f.racc_debug_out.$puts()}),w(b,"$racc_reduce",function(r,x,n,f){var i=this,G=t;return(G=i.racc_debug_out).$print("reduce "),_(r["$empty?"]())?G.$print(" <none>"):N(r,"each",[],function Q(K){return null==K&&(K=t),G.$print(" ",(null==Q.$$s?this:Q.$$s).$racc_token2str(K))},{$$s:i}),G.$puts(" --\x3e "+i.$racc_token2str(x)),i.$racc_print_stacks(n,f),i.racc_debug_out.$puts()}),w(b,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),w(b,"$racc_e_pop",function(r,x,n){var f=this;return f.racc_debug_out.$puts("error recovering mode: pop token"),f.$racc_print_states(r),f.$racc_print_stacks(x,n),f.racc_debug_out.$puts()}),w(b,"$racc_next_state",function(r,x){var n=this;return n.racc_debug_out.$puts("goto    "+r),n.$racc_print_states(x),n.racc_debug_out.$puts()}),w(b,"$racc_print_stacks",function(r,x){var f=t;return(f=this.racc_debug_out).$print("        ["),N(r,"each_index",[],function i(G){return null==G&&(G=t),f.$print(" (",(null==i.$$s?this:i.$$s).$racc_token2str(r["$[]"](G))," ",x["$[]"](G).$inspect(),")")},{$$s:this}),f.$puts(" ]")}),w(b,"$racc_print_states",function(r){var n=t;return(n=this.racc_debug_out).$print("        ["),N(r,"each",[],function(i){return null==i&&(i=t),n.$print(" ",i)}),n.$puts(" ]")}),w(b,"$racc_token2str",function(r){var n;return _(n=c(this.$class(),"Racc_token_to_s_table")["$[]"](r))?n:this.$raise("[Racc Bug] can't convert token "+r+" to string")}),w(b,"$token_to_str",function(r){return c(this.$class(),"Racc_token_to_s_table")["$[]"](r)})}($[0],$)},Opal.modules["bcdice/arithmetic/node"]=function(e){var u,t,T,s,b,y,g,h,$,F=e.module,B=e.klass,_=e.def,C=e.thrower,R=e.return_ivar,q=e.send2,M=e.find_super,w=e.eqeq,E=e.const_set,N=e.eqeqeq,V=e.rb_divide,j=e.truthy,A=e.assign_ivar,U=e.alias,L=[],d=e.nil,W=e.$$$;return u=L,t=$=[F(L[0],"BCDice")].concat(u),T=h=[F($[0],"Arithmetic")].concat(t),y=[F(h[0],"Node")].concat(T),g=e.$r(y),(b=(s=B(y[0],null,"BinaryOp")).$$prototype).lhs=b.rhs=b.op=d,_(s,"$initialize",function(k,P,o){var r=this;return r.lhs=k,r.op=P,r.rhs=o}),_(s,"$eval",function(k){try{C("eval_return");var x,o=this,r=d;return r=o.lhs.$eval(k),x=o.rhs.$eval(k),r.$send(o.op,x)}catch(n){if(n===e.t_eval_return)return n.$v;throw n}}),_(s,"$output",function(){var k=this;return""+k.lhs.$output()+k.op+k.rhs.$output()}),_(s,"$s_exp",function(){var k=this;return"("+k.$op_for_s_exp()+" "+k.lhs.$s_exp()+" "+k.rhs.$s_exp()+")"}),_(s,"$op_for_s_exp",R("op")),function(l,m,s){var b=B(l,m,"DivideBase"),a=[b].concat(s),k=e.$r(a),P=b.$$prototype;P.lhs=P.rhs=P.op=d,_(b,"$initialize",function o(r,x){return o.$$p=null,q(this,M(this,"initialize",o,!1,!0),"initialize",[r,"/",x],null)}),_(b,"$eval",function(r){try{C("eval_return");var f,i,n=this;return f=n.lhs.$eval(r),i=n.rhs.$eval(r),w(i,0)&&n.$raise(k("ZeroDivisionError")),n.$divide_and_round(f,i,r)}catch(G){if(G===e.t_eval_return)return G.$v;throw G}}),_(b,"$output",function o(){var r=o.$$p||d,x=this;return o.$$p=null,""+q(x,M(x,"output",o,!1,!0),"output",[],r)+x.$rounding_method()}),b.$private(),_(b,"$rounding_method",function(){return W(this.$class(),"ROUNDING_METHOD")}),_(b,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(b,"$divide_and_round",function(r,x,n){return this.$raise(k("NotImplementedError"))})}(y[0],g("BinaryOp"),y),function(l,m,s){var b=B(l,m,"DivideWithGameSystemDefault"),a=[b].concat(s),k=e.$r(a);E(a[0],"ROUNDING_METHOD",""),b.$private(),_(b,"$divide_and_round",function(o,r,x){var n,f=d;return N(W(k("RoundType"),"CEIL"),n=x)?V(o.$to_f(),r).$ceil():N(W(k("RoundType"),"ROUND"),n)?(f=V(o.$to_f(),r),j(f["$negative?"]())?f.$abs().$round()["$-@"]():f.$round()):V(o,r).$floor()})}(y[0],g("DivideBase"),y),function(l,m,s){var b=B(l,m,"DivideWithCeil"),a=[b].concat(s);E(a[0],"ROUNDING_METHOD","C"),b.$private(),_(b,"$divide_and_round",function(P,o,r){return V(P.$to_f(),o).$ceil()})}(y[0],g("DivideBase"),y),function(l,m,s){var b=B(l,m,"DivideWithRound"),a=[b].concat(s);E(a[0],"ROUNDING_METHOD","R"),b.$private(),_(b,"$divide_and_round",function(P,o,r){var x=d;return x=V(P.$to_f(),o),j(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()})}(y[0],g("DivideBase"),y),function(l,m,s){var b=B(l,m,"DivideWithFloor"),a=[b].concat(s);E(a[0],"ROUNDING_METHOD","F"),b.$private(),_(b,"$divide_and_round",function(P,o,r){return V(P,o).$floor()})}(y[0],g("DivideBase"),y),function(l,m){var s=B(l,null,"Negative");s.$$prototype.body=d,_(s,"$initialize",A("body")),_(s,"$eval",function(k){try{return C("eval_return"),this.body.$eval(k)["$-@"]()}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),_(s,"$output",function(){return"-"+this.body.$output()}),_(s,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(y[0]),function(l,m){var s=B(l,null,"Parenthesis");s.$$prototype.expr=d,_(s,"$initialize",A("expr")),_(s,"$eval",function(k){try{return C("eval_return"),this.expr.$eval(k)}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),_(s,"$output",function(){return"("+this.expr.$output()+")"}),_(s,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(y[0]),function(l,m){var s=B(l,null,"Number");return s.$$prototype.value=d,_(s,"$initialize",A("value")),_(s,"$eval",R("value")),_(s,"$output",function(){return this.value.$to_s()}),U(s,"s_exp","output")}(y[0])},Opal.modules.strscan=function(e){var A,U,L,d,W,B=e.def,_=e.truthy,C=e.eqeqeq,R=e.Opal,q=e.return_ivar,M=e.send,w=e.alias,E=[],N=e.nil;return A=E,L=[U=(0,e.klass)(E[0],null,"StringScanner")].concat(A),d=e.$r(L),(W=U.$$prototype).pos=W.string=W.working=W.matched=W.prev_pos=W.match=N,U.$attr_reader("pos","matched"),B(U,"$initialize",function(u){var v=this;return v.string=u,v.pos=0,v.matched=N,v.working=u,v.match=[]}),U.$attr_reader("string"),B(U,"$beginning_of_line?",function(){var u=this;return 0===u.pos||"\n"===u.string.charAt(u.pos-1)}),B(U,"$scan",function(u){var v=this,$=(u=v.$anchor(u)).exec(v.working);return null==$?v.matched=N:(v.prev_pos=v.pos,v.pos+=$[0].length,v.working=v.working.substring($[0].length),v.matched=$[0],v.match=$,$[0])}),B(U,"$scan_until",function(u){var v=this;u=v.$anchor(u);for(var $=v.working,D=0;$.length!=D;++D){var t=u.exec($.substr(D));if(null!==t){var c=D+t[0].length,h=$.substr(0,c);return v.matched=t[0],v.match=t,v.prev_pos=v.pos+D,v.pos+=c,v.working=$.substr(c),h}}return v.matched=N}),B(U,"$[]",function(u){var $;if(_(this.match["$empty?"]()))return N;C(d("Symbol"),$=u)?u=u.$to_s():C(d("String"),$)||(u=R["$coerce_to!"](u,d("Integer"),"to_int"));var D=this.match;return u<0&&(u+=D.length),u<0||u>=D.length||null==D[u]?N:D[u]}),B(U,"$check",function(u){var v=this,$=(u=v.$anchor(u)).exec(v.working);return v.matched=null==$?N:$[0]}),B(U,"$check_until",function(u){var v=this,$=v.prev_pos,D=v.pos,t=v.working,c=v.$scan_until(u);return v.prev_pos=$,v.pos=D,v.working=t,c}),B(U,"$peek",function(u){return this.working.substring(0,u)}),B(U,"$eos?",function(){return 0===this.working.length}),B(U,"$exist?",function(u){var $=u.exec(this.working);return null==$?N:0==$.index?0:$.index+1}),B(U,"$skip",function(u){var v=this,$=(u=v.$anchor(u)).exec(v.working);if(null==$)return v.match=[],v.matched=N;var D=$[0],t=D.length;return v.matched=D,v.match=$,v.prev_pos=v.pos,v.pos+=t,v.working=v.working.substring(t),t}),B(U,"$skip_until",function(u){var $=this.$scan_until(u);return $===N?N:(this.matched=$.substr(-1),$.length)}),B(U,"$get_byte",function(){var u=this,v=N;return u.pos<u.string.length?(u.prev_pos=u.pos,u.pos+=1,v=u.matched=u.working.substring(0,1),u.working=u.working.substring(1)):u.matched=N,v}),B(U,"$match?",function(u){var v=this,$=(u=v.$anchor(u)).exec(v.working);return null==$?N:(v.prev_pos=v.pos,$[0].length)}),B(U,"$pos=",function(u){var v=this;return u<0&&(u+=v.string.$length()),v.pos=u,v.working=v.string.slice(u)}),B(U,"$matched_size",function(){return this.matched===N?N:this.matched.length}),B(U,"$post_match",function(){var u=this;return u.matched===N?N:u.string.substr(u.pos)}),B(U,"$pre_match",function(){var u=this;return u.matched===N?N:u.string.substr(0,u.prev_pos)}),B(U,"$reset",function(){var u=this;return u.working=u.string,u.matched=N,u.pos=0}),B(U,"$rest",q("working")),B(U,"$rest?",function(){return 0!==this.working.length}),B(U,"$rest_size",function(){return this.$rest().$size()}),B(U,"$terminate",function(){var u,v=this;return v.match=N,u=[v.string.$length()],M(v,"pos=",u),u[u.length-1]}),B(U,"$unscan",function(){var u=this;return u.pos=u.prev_pos,u.prev_pos=N,u.match=N,u}),w(U,"bol?","beginning_of_line?"),w(U,"getch","get_byte"),U.$private(),B(U,"$anchor",function(u){var v=u.toString().match(/\/([^\/]+)$/);return v=v?v[1]:void 0,new RegExp("^(?:"+u.source+")",v)})},Opal.modules["bcdice/normalize"]=function(e){var w,j,N,F=e.module,B=e.eqeqeq,_=e.def,C=e.eqeq,R=[],q=e.nil;return w=R,N=[F(R[0],"BCDice")].concat(w),(j=F(N[0],"Normalize")).$module_function(),_(j,"$comparison_operator",function(U){var L;return B(/<=|=</,L=U)?"<=":B(/>=|=>/,L)?">=":B(/<>|!=|=!/,L)?"!=":B(/</,L)?"<":B(/>/,L)?">":B(/=/,L)?"==":q}),_(j,"$target_number",function(U){return C(U,"?")?U:U.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var A,W,D,t,c,h,z,u,L,F=e.module,B=e.klass,_=e.const_set,C=e.hash2,R=e.truthy,q=e.send,M=e.def,w=e.thrower,E=e.top,N=[],V=e.nil;return E.$require("strscan"),E.$require("bcdice/normalize"),A=N,W=L=[F(N[0],"BCDice")].concat(A),D=u=[F(L[0],"Command")].concat(W),c=[t=B(u[0],null,"Lexer")].concat(D),h=e.$r(c),(z=t.$$prototype).scanner=z.notations=V,_(c[0],"SYMBOLS",C(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),M(t,"$initialize",function(I,y){var g,l,s;return I=R(s=(g=(l=I)===V||null==l?V:l.$split(" ",2))===V||null==g?V:g.$first())?s:"",this.scanner=h("StringScanner").$new(I),this.notations=q(y,"map",[],function(a){return null==a&&(a=V),R(a["$is_a?"](h("String")))?h("Regexp").$new(a):a})}),M(t,"$next_token",function(){try{var I=w("return"),y=this,g=V,l=V,s=V,b=V;return R(y.scanner["$eos?"]())?[!1,"$"]:(q(y.notations,"each",[],function a(k){var o,P=null==a.$$s?this:a.$$s;if(null==P.scanner&&(P.scanner=V),null==k&&(k=V),o=P.scanner.$scan(k),!R(o))return V;I.$throw(["NOTATION",o])},{$$s:y,$$ret:I}),R(g=y.scanner.$scan(/\d+/))?["NUMBER",g.$to_i()]:R(l=y.scanner.$scan(/[<>!=]+/))?(l=h("Normalize").$comparison_operator(l),[R(l)?"CMP_OP":"ILLEGAL",l]):(s=y.scanner.$getch().$upcase(),[R(b=h("SYMBOLS")["$[]"](s))?b:s.$to_sym(),s]))}catch(a){if(a===I)return a.$v;throw a}}),M(t,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var E,A,H,u,v,$,D,L,V,F=e.module,B=e.klass,_=e.def,C=e.return_ivar,R=e.truthy,q=[],M=e.nil;return E=q,A=V=[F(q[0],"BCDice")].concat(E),H=L=[F(V[0],"Command")].concat(A),v=[u=B(L[0],null,"Parsed")].concat(H),$=e.$r(v),(D=u.$$prototype).critical=D.fumble=D.dollar=D.modify_number=D.question_target=D.target_number=D.prefix_number=D.command=D.suffix_number=D.cmp_op=M,u.$attr_accessor("command"),u.$attr_accessor("prefix_number"),u.$attr_accessor("suffix_number"),u.$attr_accessor("critical"),u.$attr_accessor("fumble"),u.$attr_accessor("dollar"),u.$attr_accessor("modify_number"),u.$attr_accessor("cmp_op"),u.$attr_accessor("target_number"),u.$attr_writer("question_target"),_(u,"$initialize",function(){var c=this;return c.prefix_number=M,c.suffix_number=M,c.critical=M,c.fumble=M,c.dollar=M,c.cmp_op=M,c.target_number=M,c.question_target=!1}),_(u,"$question_target?",C("question_target")),_(u,"$to_s",function(c){var h=this,z=M,T=M,I=M,y=M,g=M;switch(null==c&&(c="after_command"),z=R(h.critical)?"@"+h.critical:M,T=R(h.fumble)?"#"+h.fumble:M,I=R(h.dollar)?"$"+h.dollar:M,y=$("Format").$modifier(h.modify_number),g=R(h.question_target)?"?":h.target_number,c.valueOf()){case"after_command":return[h.prefix_number,h.command,h.suffix_number,z,T,I,y,h.cmp_op,g].$join();case"after_modify_number":return[h.prefix_number,h.command,h.suffix_number,y,z,T,I,h.cmp_op,g].$join();case"after_target_number":return[h.prefix_number,h.command,h.suffix_number,y,h.cmp_op,g,z,T,I].$join();default:return M}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var c,I,b,x,n,f,i,G,Q,K,$e,ie,ue,a,o,r,se,g,l,z,F=e.klass,B=e.module,_=e.slice,C=e.extract_kwargs,R=e.ensure_kwargs,q=e.get_kwarg,M=e.send2,w=e.find_super,E=e.def,N=e.send,V=e.eqeq,j=e.thrower,A=e.hash,U=e.const_set,L=e.truthy,d=e.to_ary,W=e.hash2,H=e.top,u=[],v=e.$r(u),$=e.nil,D=e.$$$;return H.$require("racc/parser.rb"),H.$require("bcdice/arithmetic/node"),H.$require("bcdice/command/lexer"),H.$require("bcdice/command/parsed"),F(D(v("BCDice"),"Command"),D(v("Racc"),"Parser"),"Parser"),c=u,I=z=[B(u[0],"BCDice")].concat(c),g=[B(z[0],"Command")].concat(I),l=e.$r(g),b=g,o=[a=F(g[0],D(l("Racc"),"Parser"),"Parser")].concat(b),r=e.$r(o),(se=a.$$prototype).notations=se.lexer=se.modifier=se.suffix_number=se.prefix_number=se.need_suffix_number=se.need_prefix_number=se.critical=se.fumble=se.dollar=se.allowed_cmp_op=se.question_target=$,E(a,"$initialize",function Y(p,Z){var X,S,ee,te,O=this;return Y.$$p=null,X=_(arguments),S=C(X),S=R(S),ee=X,te=q(S,"round_type"),M(O,w(O,"initialize",Y,!1,!0),"initialize",[],null),O.notations=ee,O.round_type=te,O.prefix_number=!1,O.suffix_number=!1,O.need_prefix_number=!1,O.need_suffix_number=!1,O.modifier=!0,O.critical=!1,O.fumble=!1,O.dollar=!1,O.allowed_cmp_op=[$,">=",">","<=","<","==","!="],O.question_target=!1},-2),E(a,"$disable_modifier",function(){return this.modifier=!1,this}),E(a,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),E(a,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),E(a,"$has_prefix_number",function(){var p=this;return p.prefix_number=!0,p.need_prefix_number=!0,p}),E(a,"$has_suffix_number",function(){var p=this;return p.suffix_number=!0,p.need_suffix_number=!0,p}),E(a,"$enable_critical",function(){return this.critical=!0,this}),E(a,"$enable_fumble",function(){return this.fumble=!0,this}),E(a,"$enable_dollar",function(){return this.dollar=!0,this}),E(a,"$restrict_cmp_op_to",function(p){var Z;return Z=_(arguments),this.allowed_cmp_op=Z,this},-1),E(a,"$enable_question_target",function(){return this.question_target=!0,this}),E(a,"$parse",function(p){var Z=this;try{return Z.lexer=r("Lexer").$new(p,Z.notations),Z.$do_parse()}catch(X){if(!e.rescue(X,[r("ParseError"),r("ZeroDivisionError")]))throw X;try{return $}finally{e.pop_exception()}}}),a.$private(),E(a,"$parsed",function(p,Z,X,S){try{return j("eval_return"),N(r("Parsed").$new(),"tap",[],function re(O){var _e,le,de,me,ve,fe,be,oe=null==re.$$s?this:re.$$s;return null==oe.round_type&&(oe.round_type=$),null==O&&(O=$),O["$command="](p["$[]"]("command")),O["$prefix_number="]((_e=p["$[]"]("prefix"))===$||null==_e?$:_e.$eval(oe.round_type)),O["$suffix_number="]((le=p["$[]"]("suffix"))===$||null==le?$:le.$eval(oe.round_type)),O["$critical="]((de=Z["$[]"]("critical"))===$||null==de?$:de.$eval(oe.round_type)),O["$fumble="]((me=Z["$[]"]("fumble"))===$||null==me?$:me.$eval(oe.round_type)),O["$dollar="]((ve=Z["$[]"]("dollar"))===$||null==ve?$:ve.$eval(oe.round_type)),O["$modify_number="](X.$eval(oe.round_type)),O["$cmp_op="](S["$[]"]("cmp_op")),V(S["$[]"]("target"),"?")?(O["$question_target="](!0),N(O,"target_number=",fe=[0]),fe[fe.length-1]):(O["$question_target="](!1),fe=[(be=S["$[]"]("target"),be===$||null==be?$:be.$eval(oe.round_type))],N(O,"target_number=",fe),fe[fe.length-1])},{$$s:this})}catch(re){if(re===e.t_eval_return)return re.$v;throw re}}),E(a,"$next_token",function(){return this.lexer.$next_token()}),x=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),n=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),f=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),i=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),G=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),Q=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),K=[$,6,13,3,9,-1,27,-15,-10,-1,-38],$e=[$,$,$,$,$,$,19,16,15,$,$],ie=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ue=A(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),U(o[0],"Racc_arg",[x,n,i,f,G,Q,$e,K,19,ie,ue,58,35,!0]),L(r("Ractor","skip_raise")?"constant":$)&&r("Ractor").$make_shareable(r("Racc_arg")),U(o[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),L(r("Ractor","skip_raise")?"constant":$)&&r("Ractor").$make_shareable(r("Racc_token_to_s_table")),U(o[0],"Racc_debug_parser",!1),E(a,"$_reduce_1",function(p,Z,X){var S;return L(this.modifier)||this.$raise(r("ParseError")),S=d(p),this.$parsed(null==S[0]?$:S[0],null==S[1]?$:S[1],null==S[2]?$:S[2],null==S[3]?$:S[3])}),E(a,"$_reduce_2",function(p,Z,X){var S;return L(this.modifier)||this.$raise(r("ParseError")),S=d(p),this.$parsed(null==S[0]?$:S[0],null==S[2]?$:S[2],null==S[1]?$:S[1],null==S[3]?$:S[3])}),E(a,"$_reduce_3",function(p,Z,X){var S,_e;return _e=null==(S=d(p))[2]?$:S[2],this.$parsed(null==S[0]?$:S[0],null==S[1]?$:S[1],D(D(r("Arithmetic"),"Node"),"Number").$new(0),_e)}),E(a,"$_reduce_4",function(p,Z,X){var S=this;return L(S.prefix_number)&&L(S.suffix_number)||S.$raise(r("ParseError")),W(["command","prefix","suffix"],{command:p["$[]"](1),prefix:p["$[]"](0),suffix:p["$[]"](2)})}),E(a,"$_reduce_5",function(p,Z,X){var S=this;return L(S.prefix_number)||S.$raise(r("ParseError")),L(S.need_suffix_number)&&S.$raise(r("ParseError")),W(["command","prefix"],{command:p["$[]"](1),prefix:p["$[]"](0)})}),E(a,"$_reduce_6",function(p,Z,X){var S=this;return L(S.suffix_number)||S.$raise(r("ParseError")),L(S.need_prefix_number)&&S.$raise(r("ParseError")),W(["command","suffix"],{command:p["$[]"](0),suffix:p["$[]"](1)})}),E(a,"$_reduce_7",function(p,Z,X){var S=this;return(L(S.need_prefix_number)||L(S.need_suffix_number))&&S.$raise(r("ParseError")),W(["command"],{command:p["$[]"](0)})}),E(a,"$_reduce_8",function(p,Z,X){return W([],{})}),E(a,"$_reduce_9",function(p,Z,X){var S,_e,re=$;return re=null==(S=d(p))[0]?$:S[0],_e=null==S[2]?$:S[2],L(this.critical)&&L(re["$[]"]("critical")["$nil?"]())||this.$raise(r("ParseError")),re["$[]="]("critical",_e),re}),E(a,"$_reduce_10",function(p,Z,X){var S,_e,re=$;return re=null==(S=d(p))[0]?$:S[0],_e=null==S[2]?$:S[2],L(this.fumble)&&L(re["$[]"]("fumble")["$nil?"]())||this.$raise(r("ParseError")),re["$[]="]("fumble",_e),re}),E(a,"$_reduce_11",function(p,Z,X){var S,_e,re=$;return re=null==(S=d(p))[0]?$:S[0],_e=null==S[2]?$:S[2],L(this.dollar)&&L(re["$[]"]("dollar")["$nil?"]())||this.$raise(r("ParseError")),re["$[]="]("dollar",_e),re}),E(a,"$_reduce_12",function(p,Z,X){return p["$[]"](1)}),E(a,"$_reduce_13",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"Negative").$new(p["$[]"](1))}),E(a,"$_reduce_14",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(p["$[]"](0),"+",p["$[]"](2))}),E(a,"$_reduce_15",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(p["$[]"](0),"-",p["$[]"](2))}),E(a,"$_reduce_16",function(p,Z,X){return L(this.allowed_cmp_op["$include?"]($))||this.$raise(r("ParseError")),W([],{})}),E(a,"$_reduce_17",function(p,Z,X){var S,re,O;return O=null==(S=d(p))[1]?$:S[1],L(this.allowed_cmp_op["$include?"](re=null==S[0]?$:S[0]))||this.$raise(r("ParseError")),W(["cmp_op","target"],{cmp_op:re,target:O})}),E(a,"$_reduce_18",function(p,Z,X){var ee,S=this;return ee=p["$[]"](0),L(S.question_target)||S.$raise(r("ParseError")),L(S.allowed_cmp_op["$include?"](ee))||S.$raise(r("ParseError")),W(["cmp_op","target"],{cmp_op:ee,target:"?"})}),E(a,"$_reduce_19",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(p["$[]"](0),"+",p["$[]"](2))}),E(a,"$_reduce_20",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(p["$[]"](0),"-",p["$[]"](2))}),E(a,"$_reduce_22",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(p["$[]"](0),"*",p["$[]"](2))}),E(a,"$_reduce_23",function(p,Z,X){return p["$[]"](3).$new(p["$[]"](0),p["$[]"](2))}),E(a,"$_reduce_25",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),E(a,"$_reduce_26",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithCeil")}),E(a,"$_reduce_27",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithCeil")}),E(a,"$_reduce_28",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithRound")}),E(a,"$_reduce_29",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithFloor")}),E(a,"$_reduce_30",function(p,Z,X){return p["$[]"](1)}),E(a,"$_reduce_31",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"Negative").$new(p["$[]"](1))}),E(a,"$_reduce_33",function(p,Z,X){return p["$[]"](1)}),E(a,"$_reduce_34",function(p,Z,X){return D(D(r("Arithmetic"),"Node"),"Number").$new(p["$[]"](0))}),E(a,"$_reduce_none",function(p,Z,X){return p["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var N,U,H,u,v,$,d,j,F=e.module,B=e.send,_=e.eqeqeq,C=e.truthy,R=e.def,q=e.return_val,M=[],w=e.nil;return N=M,U=j=[F(M[0],"BCDice")].concat(N),H=d=[F(j[0],"Deprecated")].concat(U),v=[u=F(d[0],"Checker")].concat(H),$=e.$r(v),u.$private(),R(u,"$check_result_legacy",function(t,c,h,z){var g,T=this,I=w,y=w,l=w,m=w;return I=B(c,"map",[],"sides".$to_proc()),g=(y=B(c,"map",[],"value".$to_proc())).$sum(),l=_([100],m=I)?T.$check_1D100(t,g,h,z):_([20],m)?T.$check_1D20(t,g,h,z):_([6,6],m)?T.$check_2D6(t,g,y,h,z):w,(C(l["$nil?"]())||C(l["$empty?"]()))&&(l=_([10],m=I.$uniq())?T.$check_nD10(t,g,y,h,z):_([6],m)?T.$check_nD6(t,g,y,h,z):w,C(l["$nil?"]())||C(l["$empty?"]()))?w:$("Result").$new(l.$delete_prefix(" \uff1e "))}),R(u,"$check_1D100",q(w)),R(u,"$check_1D20",q(w)),R(u,"$check_nD10",q(w)),R(u,"$check_2D6",q(w)),R(u,"$check_nD6",q(w))},Opal.modules["bcdice/base"]=function(e){var v,T,m,P,r,x,s,b,a,k,y,F=e.module,B=e.klass,_=e.slice,C=e.rb_plus,R=e.truthy,q=e.def,M=e.regexp,w=e.send,E=e.thrower,N=e.return_ivar,V=e.assign_ivar_val,j=e.eqeqeq,A=e.eqeq,U=e.return_val,L=e.range,d=e.rb_minus,W=e.rb_divide,H=e.rb_times,u=e.rb_ge,$=e.top,D=[],t=e.$r(D),c=e.nil,h=e.$$$;return $.$require("i18n"),$.$require("i18n/backend/fallbacks"),$.$require("bcdice/randomizer"),$.$require("bcdice/dice_table"),$.$require("bcdice/enum"),$.$require("bcdice/translate"),$.$require("bcdice/result"),$.$require("bcdice/command/parser"),$.$require("bcdice/deprecated/checker"),T=D,m=y=[F(D[0],"BCDice")].concat(T),b=[s=B(y[0],null,"Base")].concat(m),a=e.$r(b),(k=s.$$prototype).raw_input=k.randomizer=k.enabled_upcase_input=k.debug=c,r=[P=e.get_singleton_class(s)].concat(b),x=e.$r(r),P.$attr_reader("prefixes"),q(P,"$register_prefix",function(f){var G,K,Q=this;return null==Q.prefixes&&(Q.prefixes=c),G=_(arguments),Q.prefixes=C(R(K=Q.prefixes)?K:[],G.$flatten())},-1),q(P,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),q(P,"$prefixes_pattern",function(){var f=this,i=c;return null==f.prefixes_pattern&&(f.prefixes_pattern=c),null==f.prefixes&&(f.prefixes=c),f.prefixes_pattern=R(i=f.prefixes_pattern)?i:c,R(f.prefixes_pattern)?f.prefixes_pattern:(f.prefixes=R(i=f.prefixes)?i:[],f.prefixes.$freeze(),f.prefixes_pattern=(R(f.prefixes["$empty?"]())?/(?!)/:M(["^(S)?(",f.prefixes.$join("|"),")"],"i")).$freeze())}),q(P,"$command_pattern",function(){var f=this,i=c,G=c;return null==f.command_pattern&&(f.command_pattern=c),null==f.prefixes&&(f.prefixes=c),f.command_pattern=R(i=f.command_pattern)?i:c,R(f.command_pattern)?f.command_pattern:(f.prefixes=R(i=f.prefixes)?i:[],f.prefixes.$freeze(),G=C(w(h(x("CommonCommand"),"COMMANDS"),"map",[],function(K){return null==K&&(K=c),h(K,"PREFIX_PATTERN").$source()}),f.prefixes),f.command_pattern=M(["^S?(",G.$join("|"),")"],"i").$freeze())}),q(P,"$eval",function(f){try{return E("eval_return"),this.$new(f).$eval()}catch(Q){if(Q===e.t_eval_return)return Q.$v;throw Q}}),s.$include(a("Translate")),s.$include(h(a("Deprecated"),"Checker")),q(s,"$initialize",function(o){var r=this;return r.raw_input=o,r.sort_add_dice=!1,r.sort_barabara_dice=!1,r.d66_sort_type=h(a("D66SortType"),"NO_SORT"),r.enabled_d9=!1,r.round_type=h(a("RoundType"),"FLOOR"),r.sides_implicit_d=6,r.upper_dice_reroll_threshold=c,r.reroll_dice_reroll_threshold=c,r.default_cmp_op=c,r.default_target_number=c,r.enabled_upcase_input=!0,r.locale="ja_jp",r.randomizer=h(a("BCDice"),"Randomizer").$new(),r.debug=!1}),s.$attr_accessor("randomizer"),s.$attr_reader("d66_sort_type"),s.$attr_reader("round_type"),s.$attr_reader("sides_implicit_d"),s.$attr_reader("upper_dice_reroll_threshold"),s.$attr_reader("reroll_dice_reroll_threshold"),s.$attr_reader("default_cmp_op"),s.$attr_reader("default_target_number"),q(s,"$sort_add_dice?",N("sort_add_dice")),q(s,"$sort_barabara_dice?",N("sort_barabara_dice")),q(s,"$enabled_d9?",N("enabled_d9")),q(s,"$enable_debug",V("debug",!0)),q(s,"$eval",function(){var r,n,o=this,x=c;return r=h(a("BCDice"),"Preprocessor").$process(o.raw_input,o),x=R(n=o.$dice_command(r))?n:o.$eval_common_command(o.raw_input),R(x)?(x["$rands="](o.randomizer.$rand_results()),x["$detailed_rands="](o.randomizer.$detailed_rand_results()),x):c}),q(s,"$change_text",function(o){return o}),q(s,"$check_result",function(o,r,x,n){var f=this,i=c,G=c,Q=c,K=c,$e=c;return i=f.$check_result_legacy(o,r,x,n),R(i)?i:(G=w(r,"map",[],"sides".$to_proc()),K=(Q=w(r,"map",[],"value".$to_proc())).$sum(),i=j([100],$e=G)?f.$result_1d100(o,K,x,n):j([20],$e)?f.$result_1d20(o,K,x,n):j([6,6],$e)?f.$result_2d6(o,K,Q,x,n):c,A(i,a("Result").$nothing())?c:R(i)?i:(i=j([10],$e=G.$uniq())?f.$result_nd10(o,K,Q,x,n):j([6],$e)?f.$result_nd6(o,K,Q,x,n):c,A(i,a("Result").$nothing())?c:R(i)?i:f.$result_ndx(o,x,n)))}),q(s,"$grich_text",U(c)),s.$private(),q(s,"$eval_common_command",function(o){try{E("eval_return");var x=E("return");return o=this.$change_text(o),w(h(a("CommonCommand"),"COMMANDS"),"each",[],function f(i){var Q,G=null==f.$$s?this:f.$$s;if(null==G.randomizer&&(G.randomizer=c),null==i&&(i=c),Q=i.$eval(o,G,G.randomizer),!R(Q))return c;x.$throw(Q)},{$$s:this,$$ret:x}),c}catch(f){if(f===e.t_eval_return||f===x)return f.$v;throw f}}),q(s,"$dice_command",function(o){var r=this,x=c,n=c,f=c,i=c;return R(r.enabled_upcase_input)&&(o=o.$upcase()),x=r.$class().$prefixes_pattern().$match(o),R(x)?(n=x["$[]"](1)["$nil?"]()["$!"](),R(n)&&(o=o["$[]"](L(1,-1,!1))),f=r.$eval_game_system_specific_command(o),R(f["$is_a?"](a("Result")))?(f["$secret="](R(i=f["$secret?"]())?i:n),f):R(f["$nil?"]())||R(f["$empty?"]())||A(f,"1")?c:w(a("Result").$new(),"tap",[],function(Q){var K;return null==Q&&(Q=c),Q["$text="](f.$to_s()),w(Q,"secret=",K=[n]),K[K.length-1]})):c}),q(s,"$eval_game_system_specific_command",U(c)),q(s,"$result_ndx",function(o,r,x){return R(x["$is_a?"](a("String")))?c:R(o.$send(r,x))?a("Result").$success(this.$translate("success")):a("Result").$failure(this.$translate("failure"))}),q(s,"$result_1d100",U(c)),q(s,"$result_1d20",U(c)),q(s,"$result_nd10",U(c)),q(s,"$result_2d6",U(c)),q(s,"$result_nd6",U(c)),q(s,"$get_table_by_2d6",function(o){return this.$get_table_by_nD6(o,2)}),q(s,"$get_table_by_1d6",function(o){return this.$get_table_by_nD6(o,1)}),q(s,"$get_table_by_nD6",function(o,r){return this.$get_table_by_nDx(o,r,6)}),q(s,"$get_table_by_nDx",function(o,r,x){var f,i=c;return f=this.randomizer.$roll_sum(r,x),i=this.$get_table_value(o["$[]"](d(f,r))),R(i["$nil?"]())?["1",0]:[i,f]}),q(s,"$get_table_by_1d3",function(o){var n,f,r=this,i=c;return r.$debug("get_table_by_1d3"),n=r.randomizer.$roll_sum(1,6),r.$debug("num",n),f=W(d(n,1),2).$to_i(),r.$debug("index",f),i=o["$[]"](f),R(i["$nil?"]())?["1",0]:[i,n]}),q(s,"$get_table_by_d66_swap",function(o){var x;return x=this.randomizer.$roll_d66(h(a("D66SortType"),"ASC")),[this.$get_table_by_number(x,o),x]}),q(s,"$get_table_by_d66",function(o){var x,n,f,G,i=c;return x=this.randomizer.$roll_once(6),n=this.randomizer.$roll_once(6),f=C(H(d(x,1),6),d(n,1)),i=o["$[]"](f),G=""+x+n,R(i["$nil?"]())?["1",G]:[i,G]}),q(s,"$get_table_by_number",function(o,r,x){try{var n=E("return");return null==x&&(x="1"),w(r,"each",[],function i(G){var K,Q=null==i.$$s?this:i.$$s;if(null==G&&(G=c),K=G["$[]"](0),!R(u(K,o)))return c;n.$throw(Q.$get_table_value(G["$[]"](1)))},{$$s:this,$$ret:n}),this.$get_table_value(x)}catch(i){if(i===n)return i.$v;throw i}},-3),q(s,"$get_table_value",function(o){return R(o["$is_a?"](a("Proc")))?o.$call():o}),q(s,"$roll_tables",function(o,r){var n=c;return n=r["$[]"](o),R(n)?n.$roll(this.randomizer).$to_s():c}),q(s,"$debug",function(o,r){var n,f=this,i=c,G=c;return n=_(arguments,1),R(f.debug)?(i=R(o["$is_a?"](a("String")))?o:o.$inspect(),R(n["$empty?"]())?f.$warn(i):(G=w(n,"map",[],function(K){return null==K&&(K=c),R(K["$is_a?"](a("String")))?'"'+K+'"':K.$inspect()}),f.$warn(i+": "+G.$join(", ")))):c},-2),h(h(t("I18n"),"Backend"),"Simple").$include(h(h(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),t("I18n")["$default_locale="]("ja_jp"),v=[["ja_jp"]],w(t("I18n").$fallbacks(),"defaults=",v),v[v.length-1]},Opal.queue(function(e){var u,t,y,g,l,m,h,z,$,F=e.module,B=e.klass,_=e.const_set,C=e.hash2,R=e.truthy,q=e.rb_lt,M=e.rb_gt,w=e.send,E=e.rb_plus,N=e.rb_ge,V=e.rb_minus,j=e.def,A=e.rb_le,L=[],d=e.nil,W=e.$$$;return e.top.$require("bcdice/base"),u=L,t=$=[F(L[0],"BCDice")].concat(u),h=[F($[0],"GameSystem")].concat(t),z=e.$r(h),y=h,l=[g=B(h[0],z("Base"),"Ventangle")].concat(y),m=e.$r(l),g.$$prototype.randomizer=d,_(l[0],"ID","Ventangle"),_(l[0],"NAME","Ventangle"),_(l[0],"SORT_KEY","\u3046\u3048\u3093\u305f\u3093\u304f\u308b"),_(l[0],"HELP_MESSAGE","\u57fa\u672c\u66f8\u5f0f VTn@s#f$g>=T n=\u30c0\u30a4\u30b9\u6570\uff08\u7701\u7565\u66422\uff09 s=\u30b9\u30da\u30b7\u30e3\u30eb\u5024\uff08\u7701\u7565\u664212\uff09 f=\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\uff08\u7701\u7565\u66422\uff09 g=\u30ec\u30d9\u30eb\u30ae\u30e3\u30c3\u30d7\u5224\u5b9a\u5024\uff08\u7701\u7565\u53ef\uff09 T=\u76ee\u6a19\u5024\uff08\u7701\u7565\u53ef\uff09\n\n\u4f8b\uff1a\nVT        \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b9\u30da\u30b7\u30e3\u30eb\u5024\u30fb\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u5224\u5b9a\u3092\u884c\u3046\nVT@10#3   \u30b9\u30da\u30b7\u30e3\u30eb\u502410\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50243\u306e\u5224\u5b9a\u3092\u884c\u3046\nVT3@10#3  \u30b9\u30da\u30b7\u30e3\u30eb\u502410\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50243\u306e\u5224\u5b9a\u3092\u3001\u30a2\u30c9\u30d0\u30f3\u30c6\u30fc\u30b8\u30921\u70b9\u6d88\u8cbb\u3057\u3066\u30c0\u30a4\u30b93\u3064\u3067\u884c\u3046\n\nVT>=5         \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30b9\u30da\u30b7\u30e3\u30eb\u5024\u30fb\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u3067\u76ee\u6a19\u50245\u306e\u5224\u5b9a\u3092\u884c\u3046\nVT@10#3>=5    \u30b9\u30da\u30b7\u30e3\u30eb\u502410\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50243\u3067\u76ee\u6a19\u50245\u306e\u5224\u5b9a\u3092\u884c\u3046\nVT@10#3$5>=5  \u30b9\u30da\u30b7\u30e3\u30eb\u502410\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50243\u3067\u76ee\u6a19\u50245\u306e\u5224\u5b9a\u3092\u884c\u3046\u3002\u3053\u306e\u969b\u9054\u6210\u5024\u304c\u76ee\u6a19\u5024\u3088\u308a5\u4ee5\u4e0a\u5927\u304d\u3044\u5834\u5408\u3001\u30ae\u30e3\u30c3\u30d7\u30dc\u30fc\u30ca\u30b9\u3092\u8868\u793a\u3059\u308b\nVT3@10#3>=5   \u30b9\u30da\u30b7\u30e3\u30eb\u502410\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50243\u3067\u76ee\u6a19\u50245\u306e\u5224\u5b9a\u3092\u3001\u30a2\u30c9\u30d0\u30f3\u30c6\u30fc\u30b8\u30921\u70b9\u6d88\u8cbb\u3057\u3066\u30c0\u30a4\u30b93\u3064\u3067\u884c\u3046\nVT3@10#3$4>=5 \u30b9\u30da\u30b7\u30e3\u30eb\u502410\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50243\u3067\u76ee\u6a19\u50245\u306e\u5224\u5b9a\u3092\u3001\u30a2\u30c9\u30d0\u30f3\u30c6\u30fc\u30b8\u30921\u70b9\u6d88\u8cbb\u3057\u3066\u30c0\u30a4\u30b93\u3064\u3067\u884c\u3046\u3002\u3053\u306e\u969b\u9054\u6210\u5024\u304c\u76ee\u6a19\u5024\u3088\u308a4\u4ee5\u4e0a\u5927\u304d\u3044\u5834\u5408\u3001\u30ae\u30e3\u30c3\u30d7\u30dc\u30fc\u30ca\u30b9\u3092\u8868\u793a\u3059\u308b\n"),_(l[0],"DEFAULT_SPECIAL_VALUE",12),_(l[0],"DEFAULT_FUMBLE_VALUE",2),_(l[0],"DEFAULT_DICE_NUM",2),g.$register_prefix("VT"),j(g,"$eval_game_system_specific_command",function(a){var k=this,o=d,r=d,x=d,n=d,f=d,i=d,G=d,Q=d,K=d,$e=d,ie=d,ce=d,ne=d,ue=d;return k.$debug("eval_game_system_specific_command Begin"),o=W(m("Command"),"Parser").$new("VT",C(["round_type"],{round_type:k.$round_type()})).$enable_critical().$enable_fumble().$enable_dollar().$enable_suffix_number().$restrict_cmp_op_to(d,">=").$parse(a),!R(o)||(r=R(x=o.$suffix_number())?x:m("DEFAULT_DICE_NUM"),R(q(r,m("DEFAULT_DICE_NUM"))))?d:(n=k.randomizer.$roll_barabara(r,6),R(M(r,2))?(f=0,i=w(w(w(w(n.$map(),"with_index",[],function(J,se){return null==J&&(J=d),null==se&&(se=d),C(["index","value"],{index:se,value:J})}),"sort_by",[],function(J){return null==J&&(J=d),[J["$[]"]("value"),f=E(f,1)]}).$reverse().$take(2),"sort_by",[],function(J){return null==J&&(J=d),J["$[]"]("index")}),"map",[],function(J){return null==J&&(J=d),J["$[]"]("value")})):i=n,G=i.$sum(),Q=E(G,o.$modify_number()),K=k.$compare(G,Q,o),$e=R(M(r,2))?i.$to_s():d,ie=R(M(o.$modify_number(),0))?""+G+m("Format").$modifier(o.$modify_number()):d,ce=R(o.$target_number())&&R(o.$dollar())&&R(K["$success?"]())&&R(N(ne=V(Q,o.$target_number()),o.$dollar()))?"\u30ae\u30e3\u30c3\u30d7\u30dc\u30fc\u30ca\u30b9("+ne+")":d,ue=[o.$to_s(),n.$to_s(),$e,ie,Q.$to_s(),K.$text(),ce].$compact(),K["$text="](ue.$join(" \uff1e ")),K)}),j(g,"$compare",function(a,k,P){var o,x,r=d;return o=R(r=P.$critical())?r:m("DEFAULT_SPECIAL_VALUE"),x=R(r=P.$fumble())?r:m("DEFAULT_FUMBLE_VALUE"),R(A(a,x))?m("Result").$fumble("\u30d5\u30a1\u30f3\u30d6\u30eb"):R(N(a,o))?m("Result").$critical("\u30b9\u30da\u30b7\u30e3\u30eb"):R(P.$target_number())?R(k.$send(P.$cmp_op(),P.$target_number()))?m("Result").$success("\u6210\u529f"):m("Result").$failure("\u5931\u6557"):m("Result").$new(d)})})}}]);