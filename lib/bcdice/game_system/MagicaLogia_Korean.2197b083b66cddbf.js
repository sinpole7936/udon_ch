(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3154],{117:(he,Te,ge)=>{ge(5151),Opal.modules["i18n/backend/fallbacks"]=function(e){var K,s,t,o,a,f,W=e.module,B=e.class_variable_set,_=e.truthy,I=e.class_variable_get,C=e.def,k=e.send,F=e.send2,p=e.find_super,w=e.hash2,z=e.find_block_super,U=e.neqeq,H=e.thrower,L=e.return_val,N=[],P=e.nil,S=e.$$$;return K=N,f=[a=W(N[0],"I18n")].concat(K),B(f[0],"@@fallbacks",P),s=e.get_singleton_class(a),t=[s].concat(f),o=e.$r(t),C(s,"$fallbacks",function(){var D=P;return B(t[1],"@@fallbacks",_(null!=t[1].$$cvars["@@fallbacks"]?"class variable":P)&&_(D=I(t[1],"@@fallbacks",!1))?D:S(S(o("I18n"),"Locale"),"Fallbacks").$new()),_(D=o("Thread").$current()["$[]"]("i18n_fallbacks"))?D:I(t[1],"@@fallbacks",!1)}),C(s,"$fallbacks=",function(A){var D;return B(t[1],"@@fallbacks",_(A["$is_a?"](o("Array")))?S(S(o("I18n"),"Locale"),"Fallbacks").$new(A):A),D=["i18n_fallbacks",I(t[1],"@@fallbacks",!1)],k(o("Thread").$current(),"[]=",D),D[D.length-1]}),function(s,R){var A,D,E,y,o=[W(s,"Backend")].concat(R);return A=o,E=[D=W(o[0],"Fallbacks")].concat(A),y=e.$r(E),C(D,"$translate",function T(d,g,c){try{var v=H("return"),l=T.$$p||P,x=this,q=P,m=P;return T.$$p=null,null==c&&(c=y("EMPTY_HASH")),_(c.$fetch("fallback",!0))?_(c["$[]"]("fallback_in_progress"))?F(x,p(x,"translate",T,!1,!0),"translate",[d,g,c],l):(_(c["$[]"]("default"))&&(q=x["$extract_non_symbol_default!"](c)),m=c.$merge(w(["fallback_in_progress"],{fallback_in_progress:!0})),k(y("I18n").$fallbacks()["$[]"](d),"each",[],function r(u){var i=null==r.$$s?this:r.$$s;null==u&&(u=P);try{return k(i,"catch",["exception"],function $(){var n=null==$.$$s?this:$.$$s,j=P;if(j=F(n,z(n,"translate",$.$$def||r.$$def||T,!1,!1),"translate",[u,g,m],null),_(j["$nil?"]()))return P;U(d.$to_s(),u.$to_s())&&n.$on_fallback(d,u,g,c),v.$throw(j)},{$$s:i,$$ret:v})}catch($){if(!e.rescue($,[S(y("I18n"),"InvalidLocale")]))throw $;try{return P}finally{e.pop_exception()}}},{$$s:x}),_(c["$key?"]("default"))&&_(c["$[]"]("default")["$nil?"]())?P:_(q)?F(x,p(x,"translate",T,!1,!0),"translate",[d,P,c.$merge(w(["default"],{default:q}))],null):x.$throw("exception",S(y("I18n"),"MissingTranslation").$new(d,g,c))):F(x,p(x,"translate",T,!1,!0),"translate",[d,g,c],l)}catch(r){if(r===v)return r.$v;throw r}},-3),C(D,"$extract_non_symbol_default!",function(d){var c,g=P;return g=[d["$[]"]("default")].$flatten(),c=k(g,"detect",[],function(l){return null==l&&(l=P),l["$is_a?"](y("Symbol"))["$!"]()}),_(c)&&d["$[]="]("default",g["$[]"](0,g.$index(c))),c}),C(D,"$exists?",function T(d,g,c){try{var v=H("return"),l=T.$$p||P,x=this;return T.$$p=null,null==c&&(c=y("EMPTY_HASH")),_(c.$fetch("fallback",!0))?(k(y("I18n").$fallbacks()["$[]"](d),"each",[],function q(m){var r=null==q.$$s?this:q.$$s;null==m&&(m=P);try{if(!_(F(r,z(r,"exists?",q.$$def||T,!1,!1),"exists?",[m,g],null)))return P;v.$throw(!0)}catch(u){if(!e.rescue(u,[S(y("I18n"),"InvalidLocale")]))throw u;try{return P}finally{e.pop_exception()}}},{$$s:x,$$ret:v}),!1):F(x,p(x,"exists?",T,!1,!0),"exists?",[d,g,c],l)}catch(q){if(q===v)return q.$v;throw q}},-3),D.$private(),C(D,"$on_fallback",L(P))}(f[0],f)},Opal.modules["bcdice/randomizer"]=function(e){var a,b,A,D,E,y,s,R,B=e.klass,_=e.const_set,I=e.def,C=e.truthy,k=e.rb_gt,F=e.rb_plus,p=e.rb_le,w=e.send,z=e.rb_minus,U=e.eqeq,H=e.rb_times,L=e.eqeqeq,N=e.rb_ge,P=[],S=e.nil,Y=e.$$$;return a=P,s=[(0,e.module)(P[0],"BCDice")].concat(a),R=e.$r(s),b=s,D=[A=B(s[0],null,"Randomizer")].concat(b),E=e.$r(D),(y=A.$$prototype).rand_results=y.detailed_rand_results=S,_(D[0],"UPPER_LIMIT_DICE_TIMES",200),_(D[0],"UPPER_LIMIT_DICE_SIDES",1e4),_(D[0],"UPPER_LIMIT_RANDS",1e4),I(A,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),A.$attr_reader("rand_results"),A.$attr_reader("detailed_rand_results"),_(D[0],"DetailedRandResult",E("Struct").$new("kind","sides","value")),I(A,"$roll_barabara",function(d,g){var c=this;return C(k(F(c.rand_results.$size(),d),E("UPPER_LIMIT_RANDS")))&&c.$raise(E("TooManyRandsError")),C(p(d,0))||C(k(d,E("UPPER_LIMIT_DICE_TIMES")))?[]:w(E("Array"),"new",[d],function v(){return(null==v.$$s?this:v.$$s).$roll_once(g)},{$$s:c})}),I(A,"$roll_sum",function(d,g){return this.$roll_barabara(d,g).$sum()}),I(A,"$roll_once",function(d){var c=S;return C(p(d,0))||C(k(d,E("UPPER_LIMIT_DICE_SIDES")))?0:(c=this.$rand_inner(d),this.$push_to_detail("normal",d,c),c)}),I(A,"$roll_index",function(d){return z(this.$roll_once(d),1)}),I(A,"$roll_tens_d10",function(){var c,g=S;return g=this.$rand_inner(10),U(g,10)&&(g=0),c=H(g,10),this.$push_to_detail("tens_d10",10,c),c}),I(A,"$roll_d9",function(){var g;return g=z(this.$rand_inner(10),1),this.$push_to_detail("d9",10,g),g}),I(A,"$roll_d66",function(d){var v,c=S;return c=w(E("Array"),"new",[2],function l(){return(null==l.$$s?this:l.$$s).$roll_once(6)},{$$s:this}),L(Y(E("D66SortType"),"ASC"),v=d)?c["$sort!"]():L(Y(E("D66SortType"),"DESC"),v)&&c["$sort!"]()["$reverse!"](),F(H(c["$[]"](0),10),c["$[]"](1))}),A.$private(),I(A,"$rand_inner",function(d){var c,g=this;return C(N(g.rand_results.$size(),E("UPPER_LIMIT_RANDS")))&&g.$raise(E("TooManyRandsError")),c=g.$random(d),g.rand_results["$<<"]([c,d]),c}),I(A,"$random",function(d){return F(E("Kernel").$rand(d),1)}),I(A,"$push_to_detail",function(d,g,c){var l;return l=E("DetailedRandResult").$new(d,g,c),this.detailed_rand_results.$push(l)}),B(s[0],R("StandardError"),"TooManyRandsError"),S},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var w,L,K,a,f,s,R,P,U,W=e.module,B=e.klass,_=e.def,I=e.truthy,C=e.return_val,k=[],F=e.nil;return w=k,L=U=[W(k[0],"BCDice")].concat(w),K=P=[W(U[0],"DiceTable")].concat(L),f=[a=B(P[0],null,"RollResult")].concat(K),s=e.$r(f),(R=a.$$prototype).table_name=R.value=R.body=F,_(a,"$initialize",function(o,b,A){var D=this;return D.table_name=o,D.value=b,D.body=A}),a.$attr_reader("table_name"),a.$attr_reader("value"),a.$attr_reader("body"),_(a,"$to_s",function(){var o=this;return o.table_name+"("+o.value+") \uff1e "+o.body}),_(a,"$last_body",function(){var o=this;return I(o.body["$is_a?"](s("RollResult")))?o.body.$last_body():o.body}),_(a,"$empty?",C(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var w,L,K,a,f,s,R,P,U,W=e.module,B=e.klass,_=e.truthy,I=e.def,C=e.rb_minus,k=[],F=e.nil;return w=k,L=U=[W(k[0],"BCDice")].concat(w),K=P=[W(U[0],"DiceTable")].concat(L),f=[a=B(P[0],null,"ChainTable")].concat(K),s=e.$r(f),(R=a.$$prototype).times=R.sides=R.items=R.name=F,I(a,"$initialize",function(o,b,A){var D=this,E=F;return D.name=o,D.items=A.$freeze(),E=/(\d+)D(\d+)/i.$match(b),_(E)||D.$raise(s("ArgumentError"),"Unexpected table type: "+b),D.times=E["$[]"](1).$to_i(),D.sides=E["$[]"](2).$to_i()}),I(a,"$roll",function(o){var A,D,b=this,E=F;return A=o.$roll_sum(b.times,b.sides),D=C(A,b.times),E=b.items["$[]"](D),_(E["$respond_to?"]("roll"))&&(E=E.$roll(o)),s("RollResult").$new(b.name,A,E)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var H,S,s,R,t,o,b,K,N,W=e.module,B=e.klass,_=e.hash2,I=e.defs,C=e.def,k=e.rb_plus,F=e.rb_times,p=e.rb_minus,w=[],z=e.nil;return H=w,S=N=[W(w[0],"BCDice")].concat(H),s=K=[W(N[0],"DiceTable")].concat(S),t=[R=B(K[0],null,"D66GridTable")].concat(s),o=e.$r(t),(b=R.$$prototype).name=b.items=z,I(R,"$from_i18n",function(D,E){var T=z;return T=o("I18n").$t(D,_(["locale","raise"],{locale:E,raise:!0})),this.$new(T["$[]"]("name"),T["$[]"]("items"))}),C(R,"$initialize",function(D,E){return this.name=D,this.items=E.$freeze()}),C(R,"$roll",function(D){var y,T,d,g,c;return y=D.$roll_once(6),T=D.$roll_once(6),d=k(F(y,10),T),g=p(y,1),c=p(T,1),o("RollResult").$new(this.name,d,this.items["$[]"](g)["$[]"](c))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var z,N,f,s,R,t,S,Y,H,W=e.module,B=e.klass,_=e.hash2,I=e.defs,C=e.def,F=[],p=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),z=F,N=H=[W(F[0],"BCDice")].concat(z),S=[W(H[0],"DiceTable")].concat(N),Y=e.$r(S),f=S,R=[s=B(S[0],Y("D66GridTable"),"D66HalfGridTable")].concat(f),t=e.$r(R),I(s,"$from_i18n",function(b,A){var E=p;return E=t("I18n").$t(b,_(["locale","raise"],{locale:A,raise:!0})),this.$new(E["$[]"]("name"),E["$[]"]("items_1_2_3"),E["$[]"]("items_4_5_6"))}),C(s,"$initialize",function(b,A,D){return this.name=b,this.items=[A,A,A,D,D,D].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var z,N,f,s,R,t,S,Y,H,W=e.module,B=e.klass,_=e.hash2,I=e.defs,C=e.def,F=[],p=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),z=F,N=H=[W(F[0],"BCDice")].concat(z),S=[W(H[0],"DiceTable")].concat(N),Y=e.$r(S),f=S,R=[s=B(S[0],Y("D66GridTable"),"D66OneThirdTable")].concat(f),t=e.$r(R),I(s,"$from_i18n",function(b,A){var E=p;return E=t("I18n").$t(b,_(["locale","raise"],{locale:A,raise:!0})),this.$new(E["$[]"]("name"),E["$[]"]("items_1_2"),E["$[]"]("items_3_4"),E["$[]"]("items_5_6"))}),C(s,"$initialize",function(b,A,D,E){return this.name=b,this.items=[A,A,D,D,E,E].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var N,K,t,o,b,A,D,f,S,W=e.module,B=e.klass,_=e.hash2,I=e.defs,C=e.def,k=e.eqeqeq,F=e.rb_plus,p=e.rb_times,w=e.truthy,z=[],U=e.nil,H=e.$$$;return N=z,K=S=[W(z[0],"BCDice")].concat(N),t=f=[W(S[0],"DiceTable")].concat(K),b=[o=B(f[0],null,"D66Table")].concat(t),A=e.$r(b),(D=o.$$prototype).sort_type=D.items=D.name=U,I(o,"$from_i18n",function(y,T){var c,g=U;return g=A("I18n").$t(y,_(["locale"],{locale:T})),c=A("D66SortType").$const_get(g["$[]"]("d66_sort_type")),this.$new(g["$[]"]("name"),c,g["$[]"]("items"))}),C(o,"$initialize",function(y,T,d){var g=this;return g.name=y,g.sort_type=T,g.items=d.$freeze()}),C(o,"$roll",function(y){var T=this,d=U,g=U,c=U,v=U;return d=y.$roll_barabara(2,6),k(H(A("D66SortType"),"ASC"),g=T.sort_type)?d["$sort!"]():k(H(A("D66SortType"),"DESC"),g)&&d["$sort!"]()["$reverse!"](),c=F(p(d["$[]"](0),10),d["$[]"](1)),v=w(g=T.items["$[]"](c))?g:T.items["$[]"](c.$to_s()),w(v["$respond_to?"]("roll"))&&(v=v.$roll(y)),A("RollResult").$new(T.name,c,v)}),C(o,"$choice",function(y){return A("RollResult").$new(this.name,y,this.items["$[]"](y))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var P,a,s,R,Y,W=e.module,B=e.klass,_=e.hash2,I=e.send,C=e.to_ary,k=e.rb_plus,F=e.rb_times,p=e.send2,w=e.find_super,z=e.def,H=[],L=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),P=H,a=Y=[W(H[0],"BCDice")].concat(P),s=[W(Y[0],"DiceTable")].concat(a),R=e.$r(s),z(B(s[0],R("D66Table"),"D66LeftRangeTable"),"$initialize",function A(D,E,y){var g;return A.$$p=null,g=_([],{}),I(y,"each",[],function(v){var l,m;return null==v&&(v=L),l=C(v),m=null==l[1]?L:l[1],I(null==l[0]?L:l[0],"each",[],function(u){return null==u&&(u=L),I(m,"each_with_index",[],function($,n){var j,X;return null==$&&($=L),null==n&&(n=L),X=k(F(u,10),k(n,1)),I(g,"[]=",j=[X,$]),j[j.length-1]})})}),p(this,w(this,"initialize",A,!1,!0),"initialize",[D,E,g],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var L,Y,R,t,o,b,A,a,P,W=e.module,B=e.klass,_=e.hash2,I=e.defs,C=e.def,k=e.truthy,F=e.rb_minus,p=e.rb_plus,w=e.rb_times,z=[],U=e.nil;return L=z,Y=P=[W(z[0],"BCDice")].concat(L),R=a=[W(P[0],"DiceTable")].concat(Y),o=[t=B(a[0],null,"D66ParityTable")].concat(R),b=e.$r(o),(A=t.$$prototype).odd=A.even=A.name=U,I(t,"$from_i18n",function(E,y){var d=U;return d=b("I18n").$t(E,_(["locale","raise"],{locale:y,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("odd"),d["$[]"]("even"))}),C(t,"$initialize",function(E,y,T){var d=this;return d.name=E,d.odd=y.$freeze(),d.even=T.$freeze()}),C(t,"$roll",function(E){var d,c,v,y=this,T=U;return T=E.$roll_once(6),d=E.$roll_once(6),c=(k(T["$odd?"]())?y.odd:y.even)["$[]"](F(d,1)),v=p(w(T,10),d),b("RollResult").$new(y.name,v,c)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var z,N,a,f,s,R,t,S,H,W=e.module,B=e.klass,_=e.def,I=e.rb_plus,C=e.rb_times,k=e.send,F=[],p=e.nil;return z=F,N=H=[W(F[0],"BCDice")].concat(z),a=S=[W(H[0],"DiceTable")].concat(N),s=[f=B(S[0],null,"D66RangeTable")].concat(a),R=e.$r(s),(t=f.$$prototype).items=t.name=p,_(f,"$initialize",function(b,A){return this.name=b,this.items=A.$freeze()}),_(f,"$roll",function(b){var D,E,y,T=p;return D=b.$roll_once(6),E=b.$roll_once(6),y=I(C(D,10),E),T=k(this.items,"find",[],function(g){return null==g&&(g=p),g["$[]"](0)["$include?"](y)}),R("RollResult").$new(this.name,y,T["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var P,a,o,y,d,g,b,A,D,E,s,Y,W=e.module,B=e.klass,_=e.const_set,I=e.send,C=e.hash2,k=e.def,F=e.eqeqeq,p=e.truthy,w=e.to_a,z=e.rb_times,U=e.rb_plus,H=[],L=e.nil;return P=H,a=Y=[W(H[0],"BCDice")].concat(P),o=s=[W(Y[0],"DiceTable")].concat(a),A=[b=B(s[0],null,"RangeTable")].concat(o),D=e.$r(A),(E=b.$$prototype).name=E.items=E.num_of_dice=E.num_of_sides=E.formatter=L,_(A[0],"RollResult",I(D("Struct"),"new",["sum","values","content","formatted"],function y(){return(null==y.$$s?this:y.$$s).$alias_method("to_s","formatted")},{$$s:b})),_(A[0],"Item",D("Struct").$new("range","content")),_(A[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),_(A[0],"DEFAULT_FORMATTER",I(b,"lambda",[],function(T,d){return null==T&&(T=L),null==d&&(d=L),T.$name()+"("+d.$sum()+") \uff1e "+d.$content()})),b.$attr_reader("name"),b.$attr_reader("num_of_dice"),b.$attr_reader("num_of_sides"),d=[y=e.get_singleton_class(b)].concat(A),g=e.$r(d),k(y,"$from_i18n",function(v,l){var m,q=L;return q=g("I18n").$t(v,C(["locale"],{locale:l})),m=I(q["$[]"]("items"),"map",[],function r(u){return null==u&&(u=L),[(null==r.$$s?this:r.$$s).$conv_string_range(u["$[]"](0)),u["$[]"](1)]},{$$s:this}),this.$new(q["$[]"]("name"),q["$[]"]("type"),m)}),k(y,"$conv_string_range",function(v){var x,l=this;return null==l.name&&(l.name=L),F(g("Integer"),x=v)?v:F(g("String"),x)?p(v["$include?"](".."))?I(g("Range"),"new",w(I(v.$split("..",2),"map",[],function q(m){return null==m&&(m=L),(null==q.$$s?this:q.$$s).$Integer(m)},{$$s:l}))):l.$Integer(v):l.$raise(g("TypeError"),l.name+": "+v+" ("+v.$class()+") must be a String or an Integer")}),k(b,"$initialize",function y(T,d,g){var l,c=y.$$p||L,v=this,x=L;return y.$$p=null,v.name=T.$freeze(),v.formatter=p(l=c)?l:D("DEFAULT_FORMATTER"),x=D("DICE_ROLL_METHOD_RE").$match(d),p(x)||v.$raise(D("ArgumentError"),v.name+": invalid dice roll method: "+d),v.num_of_dice=x["$[]"](1).$to_i(),v.num_of_sides=x["$[]"](2).$to_i(),v.$store(g)}),k(b,"$fetch",function(T){var g,d=this;return g=I(d.items,"find",[],function(v){return null==v&&(v=L),v.$range()["$include?"](T)}),p(g)||d.$raise(D("RangeError"),d.name+": value is out of range: "+T),g}),k(b,"$roll",function(T){var c,d=this,g=L,v=L;return c=(g=T.$roll_barabara(d.num_of_dice,d.num_of_sides)).$sum(),(v=D("RollResult").$new(c,g,d.$fetch(c).$content()))["$formatted="](d.formatter["$[]"](d,v)),v}),b.$private(),k(b,"$store",function(T){var g,c,d=this;return g=I(T,"map",[],function v(l,x){return null==l&&(l=L),null==x&&(x=L),[(null==v.$$s?this:v.$$s).$coerce_to_int_range(l),x]},{$$s:d}),c=I(g,"sort_by",[],function(l,x){return null==l&&(l=L),null==x&&(x=L),l.$min()}),d.$assert_min_sum_is_covered(c),d.$assert_max_sum_is_covered(c),d.$assert_no_gap_or_overlap_in_ranges(c),d.items=I(c,"map",[],function(l,x){return null==l&&(l=L),null==x&&(x=L),D("Item").$new(l,x.$freeze()).$freeze()}).$freeze(),d}),k(b,"$coerce_to_int_range",function(T){var g;return F(D("Integer"),g=T)?D("Range").$new(T,T):F(D("Range"),g)&&p(T.$begin()["$is_a?"](D("Integer")))&&p(T.$end()["$is_a?"](D("Integer")))?T:this.$raise(D("TypeError"),this.name+": "+T+" ("+T.$class()+") must be an Integer or a Range with Integers ")}),k(b,"$assert_min_sum_is_covered",function(T){var g,d=this,c=L;return g=d.num_of_dice,c=T.$first()["$[]"](0),p(c["$include?"](g))||d.$raise(D("RangeError"),d.name+": min value ("+g+") is not covered: "+c),d}),k(b,"$assert_max_sum_is_covered",function(T){var g,d=this,c=L;return g=z(d.num_of_dice,d.num_of_sides),c=T.$last()["$[]"](0),p(c["$include?"](g))||d.$raise(D("RangeError"),d.name+": max value ("+g+") is not covered: "+c),d}),k(b,"$assert_no_gap_or_overlap_in_ranges",function(T){return I(T,"each_cons",[2],function g(c,v){var m,r,l=null==g.$$s?this:g.$$s,x=L,q=L;return null==l.name&&(l.name=L),null==c&&(c=L),null==v&&(v=L),x=c["$[]"](0),q=v["$[]"](0),m=x.$max(),r=U(m,1),p(q["$include?"](m))&&l.$raise(D("RangeError"),l.name+": Range overlap: "+x+" and "+q),p(q["$include?"](r))?L:l.$raise(D("RangeError"),l.name+": Range gap: "+x+" and "+q)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var U,P,f,b,A,D,E,R,Y,L,W=e.module,B=e.klass,_=e.send,I=e.def,C=e.rb_minus,k=e.return_ivar,F=[],p=e.nil,w=e.$$$;return U=F,P=L=[W(F[0],"BCDice")].concat(U),f=Y=[W(L[0],"DiceTable")].concat(P),b=R=[B(Y[0],null,"SaiFicSkillTable")].concat(f),D=[A=B(R[0],null,"Category")].concat(b),E=e.$r(D),I(A,"$initialize",function(T,d,g,c){var v=this;return v.name=T,v.skills=_(d.$map(),"with_index",[2],function(x,q){return null==x&&(x=p),null==q&&(q=p),w(E("SaiFicSkillTable"),"Skill").$new(T,x,g,q,c)}),v.dice=g}),I(A,"$roll",function(T){return this.$skills()["$[]"](C(T.$roll_sum(2,6),2))}),I(A,"$to_s",k("name")),A.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var p,H,Y,R,t,a,N,z,W=e.module,B=e.klass,_=e.def,I=e.hash2,C=[],k=e.nil;return p=C,H=z=[W(C[0],"BCDice")].concat(p),Y=N=[W(z[0],"DiceTable")].concat(H),a=[B(N[0],null,"SaiFicSkillTable")].concat(Y),(t=(R=B(a[0],null,"Skill")).$$prototype).s_format=t.category_dice=t.row_dice=t.category_name=t.name=k,_(R,"$initialize",function(b,A,D,E,y){var T=this;return T.category_name=b,T.name=A,T.category_dice=D,T.row_dice=E,T.s_format=y}),_(R,"$to_s",function(){var b=this;return b.$format(b.s_format,I(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))}),R.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var a,t,E,y,T,d,g,b,s,W=e.module,B=e.klass,_=e.ensure_kwargs,I=e.hash2,C=e.send,F=e.defs,p=e.const_set,w=e.to_ary,z=e.def,U=e.truthy,H=e.rb_minus,L=e.rb_plus,N=e.top,P=[],S=e.nil,Y=e.$$$;return N.$require("bcdice/dice_table/sai_fic_skill_table/category"),N.$require("bcdice/dice_table/sai_fic_skill_table/skill"),a=P,t=s=[W(P[0],"BCDice")].concat(a),E=b=[W(s[0],"DiceTable")].concat(t),T=[y=B(b[0],null,"SaiFicSkillTable")].concat(E),d=e.$r(T),(g=y.$$prototype).rtt=g.rtt_format=g.rct=g.rct_format=g.rttn=g.rttn_format=g.categories=S,F(y,"$from_i18n",function(v,l,x){var q,m,r,n,$=S;return null==(q=(x=_(x)).$$smap.rtt)&&(q=S),null==(m=x.$$smap.rct)&&(m=S),null==(r=x.$$smap.rttn)&&(r=S),n=($=d("I18n").$t("RTT",I(["locale","raise","default"],{locale:l,raise:!1,default:I([],{})})).$merge(d("I18n").$t(v,I(["locale","raise"],{locale:l,raise:!0}))))["$[]"]("items"),$=C($,"select",[],function(X,G){return null==X&&(X=S),null==G&&(G=S),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](X)}),this.$new(n,e.to_hash($).$merge(I(["rtt","rct","rttn"],{rtt:q,rct:m,rttn:r})))},-3),p(T[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),p(T[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),p(T[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),p(T[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),z(y,"$initialize",function(v,l){var x,q,m,r,u,i,$,n=this;return null==(x=(l=_(l)).$$smap.rtt)&&(x=S),null==(q=l.$$smap.rct)&&(q=S),null==(m=l.$$smap.rttn)&&(m=S),null==(r=l.$$smap.rtt_format)&&(r=d("DEFAULT_RTT")),null==(u=l.$$smap.rct_format)&&(u=d("DEFAULT_RCT")),null==(i=l.$$smap.rttn_format)&&(i=d("DEFAULT_RTTN")),null==($=l.$$smap.s_format)&&($=d("DEFAULT_S")),n.categories=C(v.$map(),"with_index",[1],function(X,G){var Z,te,ne;return null==X&&(X=S),null==G&&(G=S),te=null==(Z=w(X))[0]?S:Z[0],ne=null==Z[1]?S:Z[1],Y(d("SaiFicSkillTable"),"Category").$new(te,ne,G,$)},{$$has_top_level_mlhs_arg:!0}),n.rtt=x,n.rct=q,n.rttn=m.$to_a(),n.rtt_format=r,n.rct_format=u,n.rttn_format=i},-2),p(T[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),y.$attr_reader("categories"),z(y,"$roll_command",function(v,l){var q,x=this,m=S,r=S;return U(["RTT",x.rtt]["$include?"](q=l))?x.$format_skill(x.rtt_format,x.$roll_skill(v)):U(["RCT",x.rct]["$include?"](q))?(m=x.$roll_category(v),x.$format(x.rct_format,I(["category_dice","category_name"],{category_dice:m.$dice(),category_name:m.$name()}))):U(r=d("RTTN").$index(q))||U(r=x.rttn.$index(q))?x.$format_skill(x.rttn_format,x.categories["$[]"](r).$roll(v)):S}),z(y,"$roll_category",function(v){return this.categories["$[]"](H(v.$roll_once(6),1))}),z(y,"$roll_skill",function(v){return this.$roll_category(v).$roll(v)}),z(y,"$prefixes",function(){var v=this;return L(["RTT[1-6]?","RCT",v.rtt,v.rct],v.rttn).$compact()}),y.$private(),z(y,"$format_skill",function(v,l){return this.$format(v,I(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:l.$category_dice(),row_dice:l.$row_dice(),category_name:l.$category_name(),skill_name:l.$name(),text:l.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var U,P,f,s,R,t,o,Y,L,W=e.module,B=e.klass,_=e.hash2,I=e.defs,C=e.truthy,k=e.def,F=e.rb_minus,p=[],w=e.nil;return U=p,P=L=[W(p[0],"BCDice")].concat(U),f=Y=[W(L[0],"DiceTable")].concat(P),R=[s=B(Y[0],null,"Table")].concat(f),t=e.$r(R),(o=s.$$prototype).times=o.sides=o.name=o.items=w,I(s,"$from_i18n",function(A,D){var y=w;return y=t("I18n").$t(A,_(["locale"],{locale:D})),this.$new(y["$[]"]("name"),y["$[]"]("type"),y["$[]"]("items"))}),k(s,"$initialize",function(A,D,E){var y=this,T=w;return y.name=A,y.items=E.$freeze(),T=/(\d+)D(\d+)/i.$match(D),C(T)||y.$raise(t("ArgumentError"),"Unexpected table type: "+D),y.times=T["$[]"](1).$to_i(),y.sides=T["$[]"](2).$to_i()}),k(s,"$roll",function(A){var E,D=this;return E=A.$roll_sum(D.times,D.sides),D.$choice(E)}),k(s,"$choice",function(A){var E,D=this;return E=F(A,D.times),t("RollResult").$new(D.name,A,D.items["$[]"](E))})},Opal.modules["bcdice/dice_table"]=function(e){var W=e.top;return W.$require("bcdice/dice_table/roll_result"),W.$require("bcdice/dice_table/chain_table"),W.$require("bcdice/dice_table/d66_grid_table"),W.$require("bcdice/dice_table/d66_half_grid_table"),W.$require("bcdice/dice_table/d66_one_third_table"),W.$require("bcdice/dice_table/d66_left_range_table"),W.$require("bcdice/dice_table/d66_parity_table"),W.$require("bcdice/dice_table/d66_range_table"),W.$require("bcdice/dice_table/d66_table"),W.$require("bcdice/dice_table/range_table"),W.$require("bcdice/dice_table/sai_fic_skill_table"),W.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var k,z,H,p,W=e.module,B=e.const_set,_=[];return k=_,z=p=[W(_[0],"BCDice")].concat(k),H=[W(p[0],"D66SortType")].concat(z),B(H[0],"NO_SORT","no_sort"),B(H[0],"ASC","asc"),B(H[0],"DESC","desc"),function(w,z){var H=[W(w,"RoundType")].concat(z);return B(H[0],"CEIL","ceil"),B(H[0],"FLOOR","floor"),B(H[0],"ROUND","round")}(p[0],p)},Opal.modules["bcdice/translate"]=function(e){var z,N,P,S,Y,H,W=e.module,B=e.ensure_kwargs,_=e.kwrestargs,C=e.hash2,k=e.def,F=[],p=e.nil;return z=F,N=H=[W(F[0],"BCDice")].concat(z),S=[P=W(H[0],"Translate")].concat(N),Y=e.$r(S),k(P,"$translate",function(a,f){var s,R=this;return null==R.locale&&(R.locale=p),f=B(f),s=_(f,{}),Y("I18n").$translate(a,C(["locale","raise"],{locale:R.locale,raise:!0}).$merge(e.to_hash(s)))},-2)},Opal.modules["bcdice/result"]=function(e){var P,K,S,z,H,B=e.klass,_=e.send,I=e.def,C=e.return_val,k=e.return_ivar,F=[],p=e.nil;return z=F,P=H=[(0,e.module)(F[0],"BCDice")].concat(z),[S=B(H[0],null,"Result")].concat(P),I(K=e.get_singleton_class(S),"$success",function(s){return _(this.$new(),"tap",[],function(o){var b;return null==o&&(o=p),o["$text="](s),_(o,"success=",b=[!0]),b[b.length-1]})}),I(K,"$failure",function(s){return _(this.$new(),"tap",[],function(o){var b;return null==o&&(o=p),o["$text="](s),_(o,"failure=",b=[!0]),b[b.length-1]})}),I(K,"$critical",function(s){return _(this.$new(),"tap",[],function(o){var b;return null==o&&(o=p),o["$text="](s),o["$critical="](!0),_(o,"success=",b=[!0]),b[b.length-1]})}),I(K,"$fumble",function(s){return _(this.$new(),"tap",[],function(o){var b;return null==o&&(o=p),o["$text="](s),o["$fumble="](!0),_(o,"failure=",b=[!0]),b[b.length-1]})}),I(K,"$nothing",C("nothing")),I(S,"$initialize",function(a){var f=this;return null==a&&(a=p),f.text=a,f.rands=p,f.detailed_rands=p,f.secret=!1,f.success=!1,f.failure=!1,f.critical=!1,f.fumble=!1},-1),S.$attr_accessor("text","rands","detailed_rands"),S.$attr_writer("secret","success","failure","critical","fumble"),I(S,"$secret?",k("secret")),I(S,"$success?",k("success")),I(S,"$failure?",k("failure")),I(S,"$critical?",k("critical")),I(S,"$fumble?",k("fumble")),I(S,"$condition=",function(a){return this.success=a,this.failure=a["$!"]()})},Opal.modules["racc/parser"]=function(e){var A,E,y,W=e.module,B=e.klass,_=e.truthy,I=e.const_set,C=e.defs,k=e.gvars,F=e.rb_lt,p=e.def,w=e.to_ary,z=e.send,U=e.neqeq,H=e.rb_plus,L=e.eqeq,N=e.rb_ge,P=e.rb_gt,S=e.rb_minus,Y=e.rb_le,K=e.rb_times,a=e.assign_ivar_val,s=[],R=e.$r(s),t=e.nil,o=e.$$$;return A=s,E=[W(s[0],"Racc")].concat(A),y=e.$r(E),B(E[0],y("StandardError"),"ParseError"),_(o("::","ParseError","skip_raise")?"constant":t)||I(s[0],"ParseError",o(R("Racc"),"ParseError")),function(b,A){var c,v,l,x,q,y=[W(b,"Racc")].concat(A),T=e.$r(y);return _(T("Racc_No_Extensions","skip_raise")?"constant":t)||I(y[0],"Racc_No_Extensions",!1),c=y,l=[v=B(y[0],null,"Parser")].concat(c),x=e.$r(l),(q=v.$$prototype).yydebug=q.racc_debug_out=q.racc_error_status=q.racc_t=q.racc_vstack=q.racc_val=q.racc_state=q.racc_tstack=t,I(l[0],"Racc_Runtime_Version","1.4.6"),I(l[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),I(l[0],"Racc_Runtime_Core_Version_R","1.4.6"),I(l[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),I(l[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),I(l[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),I(l[0],"Racc_Runtime_Core_Version",x("Racc_Runtime_Core_Version_R")),I(l[0],"Racc_Runtime_Core_Revision",x("Racc_Runtime_Core_Revision_R")),I(l[0],"Racc_Runtime_Type","ruby"),C(x("Parser"),"$racc_runtime_type",function(){return x("Racc_Runtime_Type")}),p(v,"$_racc_setup",function(){var r,u,i=this,$=t,n=t;return null==k.stderr&&(k.stderr=t),_(o(i.$class(),"Racc_debug_parser"))||(i.yydebug=!1),_(null!=(r=i.yydebug)&&r!==t?"instance-variable":t)||(i.yydebug=!1),_(i.yydebug)&&(_(null!=(u=i.racc_debug_out)&&u!==t?"instance-variable":t)||(i.racc_debug_out=k.stderr),i.racc_debug_out=_($=i.racc_debug_out)?$:k.stderr),n=o(i.$class(),"Racc_arg"),_(F(n.$size(),14))&&n["$[]="](13,!0),n}),p(v,"$_racc_init_sysvars",function(){var r=this;return r.racc_state=[0],r.racc_tstack=[],r.racc_vstack=[],r.racc_t=t,r.racc_val=t,r.racc_read_next=!0,r.racc_user_yyerror=!1,r.racc_error_status=0}),p(v,"$do_parse",function(){return this.$__send__(x("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),p(v,"$next_token",function(){return this.$raise(x("NotImplementedError"),this.$class()+"#next_token is not defined")}),p(v,"$_racc_do_parse_rb",function(r,u){var i,n=this,j=t,X=t,G=t,Z=t,te=t,ne=t,se=t,ue=t;return i=w(r),j=null==i[0]?t:i[0],X=null==i[1]?t:i[1],G=null==i[2]?t:i[2],Z=null==i[3]?t:i[3],te=null==i[10]?t:i[10],n.$_racc_init_sysvars(),ne=se=ue=t,z(n,"catch",["racc_end_parse"],function ae(){var ce,V,h=null==ae.$$s?this:ae.$$s,J=t;for(null==h.racc_state&&(h.racc_state=t),null==h.racc_read_next&&(h.racc_read_next=t),null==h.racc_t&&(h.racc_t=t),null==h.yydebug&&(h.yydebug=t),null==h.racc_val&&(h.racc_val=t);_(!0);)for(_(ue=Z["$[]"](h.racc_state["$[]"](-1)))?(_(h.racc_read_next)&&U(h.racc_t,0)&&(V=h.$next_token(),ce=w(V),ne=null==ce[0]?t:ce[0],h.racc_val=null==ce[1]?t:ce[1],h.racc_t=_(ne)?_(J=te["$[]"](ne))?J:1:0,_(h.yydebug)&&h.$racc_read_token(h.racc_t,ne,h.racc_val),h.racc_read_next=!1),ue=H(ue,h.racc_t),_(N(ue,0))&&_(se=j["$[]"](ue))&&L(X["$[]"](ue),h.racc_state["$[]"](-1))||(se=G["$[]"](h.racc_state["$[]"](-1)))):se=G["$[]"](h.racc_state["$[]"](-1));_(se=h.$_racc_evalact(se,r)););},{$$s:n})}),p(v,"$yyparse",function(r,u){return this.$__send__(x("Racc_YY_Parse_Method"),r,u,this.$_racc_setup(),!0)}),p(v,"$_racc_yyparse_rb",function(r,u,i,$){var n,X=this,G=t,Z=t,Q=t,te=t,se=t,ue=t,ae=t;return n=w(i),G=null==n[0]?t:n[0],Z=null==n[1]?t:n[1],Q=null==n[2]?t:n[2],te=null==n[3]?t:n[3],se=null==n[10]?t:n[10],X.$_racc_init_sysvars(),ue=t,ae=t,z(X,"catch",["racc_end_parse"],function ce(){var V=null==ce.$$s?this:ce.$$s;for(null==V.racc_state&&(V.racc_state=t);!_(ae=te["$[]"](V.racc_state["$[]"](-1)));)for(;_(ue=V.$_racc_evalact(Q["$[]"](V.racc_state["$[]"](-1)),i)););return z(r,"__send__",[u],function h(J,O){var M=null==h.$$s?this:h.$$s,re=t,$e=t;for(null==M.racc_t&&(M.racc_t=t),null==M.racc_state&&(M.racc_state=t),null==M.racc_read_next&&(M.racc_read_next=t),null==J&&(J=t),null==O&&(O=t),M.racc_t=_(J)?_(re=se["$[]"](J))?re:1:0,M.racc_val=O,M.racc_read_next=!1,ae=H(ae,M.racc_t),_(N(ae,0))&&_(ue=G["$[]"](ae))&&L(Z["$[]"](ae),M.racc_state["$[]"](-1))||(ue=Q["$[]"](M.racc_state["$[]"](-1)));_(ue=M.$_racc_evalact(ue,i)););for(;_(_(re=_($e=(ae=te["$[]"](M.racc_state["$[]"](-1)))["$!"]())?$e:M.racc_read_next["$!"]())?re:M.racc_t["$=="](0));)for(_(ae)&&_(ae=H(ae,M.racc_t))&&_(N(ae,0))&&_(ue=G["$[]"](ae))&&L(Z["$[]"](ae),M.racc_state["$[]"](-1))||(ue=Q["$[]"](M.racc_state["$[]"](-1)));_(ue=M.$_racc_evalact(ue,i)););},{$$s:V})},{$$s:X})}),p(v,"$_racc_evalact",function(r,u){var i,Q,n=this,j=t,X=t,Z=t,te=t,ne=t,se=t;if(j=null==(i=w(u))[0]?t:i[0],X=null==i[1]?t:i[1],Z=null==i[3]?t:i[3],Q=null==i[11]?t:i[11],te=null==i[12]?t:i[12],_(P(r,0))&&_(F(r,Q)))_(P(n.racc_error_status,0))&&(L(n.racc_t,1)||(n.racc_error_status=S(n.racc_error_status,1))),n.racc_vstack.$push(n.racc_val),n.racc_state.$push(r),n.racc_read_next=!0,_(n.yydebug)&&(n.racc_tstack.$push(n.racc_t),n.$racc_shift(n.racc_t,n.racc_tstack,n.racc_vstack));else if(_(F(r,0))&&_(P(r,te["$-@"]()))){if(ne=z(n,"catch",["racc_jump"],function ue(){var ae=null==ue.$$s?this:ue.$$s;return null==ae.racc_state&&(ae.racc_state=t),ae.racc_state.$push(ae.$_racc_do_reduce(u,r)),!1},{$$s:n}),_(ne))switch(ne.valueOf()){case 1:return n.racc_user_yyerror=!0,te["$-@"]();case 2:return Q;default:n.$raise("[Racc Bug] unknown jump code")}}else if(L(r,Q))_(n.yydebug)&&n.$racc_accept(),n.$throw("racc_end_parse",n.racc_vstack["$[]"](0));else{if(L(r,te["$-@"]())){switch(n.racc_error_status.valueOf()){case 0:_(u["$[]"](21))||n.$on_error(n.racc_t,n.racc_val,n.racc_vstack);break;case 3:L(n.racc_t,0)&&n.$throw("racc_end_parse",t),n.racc_read_next=!0}for(n.racc_user_yyerror=!1,n.racc_error_status=3;_(!0)&&!(_(se=Z["$[]"](n.racc_state["$[]"](-1)))&&(se=H(se,1),_(N(se,0))&&_(r=j["$[]"](se))&&L(X["$[]"](se),n.racc_state["$[]"](-1))));)_(Y(n.racc_state.$size(),1))&&n.$throw("racc_end_parse",t),n.racc_state.$pop(),n.racc_vstack.$pop(),_(n.yydebug)&&(n.racc_tstack.$pop(),n.$racc_e_pop(n.racc_state,n.racc_tstack,n.racc_vstack));return r}n.$raise("[Racc Bug] unknown action "+r.$inspect())}return _(n.yydebug)&&n.$racc_next_state(n.racc_state["$[]"](-1),n.racc_state),t}),p(v,"$_racc_do_reduce",function(r,u){var i,te,se,J,O,M,ie,n=this,X=t,G=t,Z=t,Q=t,ne=t,ue=t,ae=t,ce=t,V=t,h=t,re=t,$e=t,ee=t;return X=null==(i=w(r))[4]?t:i[4],G=null==i[5]?t:i[5],Z=null==i[6]?t:i[6],Q=null==i[7]?t:i[7],te=null==i[8]?t:i[8],ne=null==i[9]?t:i[9],se=null==i[13]?t:i[13],ue=n.racc_state,ae=n.racc_vstack,ce=n.racc_tstack,V=K(u,-3),h=ne["$[]"](V),J=ne["$[]"](H(V,1)),O=ne["$[]"](H(V,2)),M=[],_(n.yydebug)&&(re=ce["$[]"](h["$-@"](),h)),$e=ae["$[]"](h["$-@"](),h),_(n.yydebug)&&ce["$[]="](h["$-@"](),h,M),ae["$[]="](h["$-@"](),h,M),ue["$[]="](h["$-@"](),h,M),_(se)?ae.$push(n.$__send__(O,$e,ae,$e["$[]"](0))):ae.$push(n.$__send__(O,$e,ae)),ce.$push(J),_(n.yydebug)&&n.$racc_reduce(re,J,ce,ae),ie=S(J,te),_(V=Q["$[]"](ie))&&(V=H(V,ue["$[]"](-1)),_(N(V,0))&&_(ee=X["$[]"](V))&&L(G["$[]"](V),ie))?ee:Z["$[]"](ie)}),p(v,"$on_error",function(r,u,i){var n,$=this;return $.$raise(x("ParseError"),$.$sprintf("\nparse error on value %s (%s)",u.$inspect(),_(n=$.$token_to_str(r))?n:"?"))}),p(v,"$yyerror",function(){return this.$throw("racc_jump",1)}),p(v,"$yyaccept",function(){return this.$throw("racc_jump",2)}),p(v,"$yyerrok",a("racc_error_status",0)),p(v,"$racc_read_token",function(r,u,i){var $=this;return $.racc_debug_out.$print("read    "),$.racc_debug_out.$print(u.$inspect(),"(",$.$racc_token2str(r),") "),$.racc_debug_out.$puts(i.$inspect()),$.racc_debug_out.$puts()}),p(v,"$racc_shift",function(r,u,i){var $=this;return $.racc_debug_out.$puts("shift   "+$.$racc_token2str(r)),$.$racc_print_stacks(u,i),$.racc_debug_out.$puts()}),p(v,"$racc_reduce",function(r,u,i,$){var n=this,j=t;return(j=n.racc_debug_out).$print("reduce "),_(r["$empty?"]())?j.$print(" <none>"):z(r,"each",[],function X(G){return null==G&&(G=t),j.$print(" ",(null==X.$$s?this:X.$$s).$racc_token2str(G))},{$$s:n}),j.$puts(" --\x3e "+n.$racc_token2str(u)),n.$racc_print_stacks(i,$),n.racc_debug_out.$puts()}),p(v,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),p(v,"$racc_e_pop",function(r,u,i){var $=this;return $.racc_debug_out.$puts("error recovering mode: pop token"),$.$racc_print_states(r),$.$racc_print_stacks(u,i),$.racc_debug_out.$puts()}),p(v,"$racc_next_state",function(r,u){var i=this;return i.racc_debug_out.$puts("goto    "+r),i.$racc_print_states(u),i.racc_debug_out.$puts()}),p(v,"$racc_print_stacks",function(r,u){var $=t;return($=this.racc_debug_out).$print("        ["),z(r,"each_index",[],function n(j){return null==j&&(j=t),$.$print(" (",(null==n.$$s?this:n.$$s).$racc_token2str(r["$[]"](j))," ",u["$[]"](j).$inspect(),")")},{$$s:this}),$.$puts(" ]")}),p(v,"$racc_print_states",function(r){var i=t;return(i=this.racc_debug_out).$print("        ["),z(r,"each",[],function(n){return null==n&&(n=t),i.$print(" ",n)}),i.$puts(" ]")}),p(v,"$racc_token2str",function(r){var i;return _(i=o(this.$class(),"Racc_token_to_s_table")["$[]"](r))?i:this.$raise("[Racc Bug] can't convert token "+r+" to string")}),p(v,"$token_to_str",function(r){return o(this.$class(),"Racc_token_to_s_table")["$[]"](r)})}(s[0],s)},Opal.modules["bcdice/arithmetic/node"]=function(e){var a,t,D,c,v,y,T,b,s,W=e.module,B=e.klass,_=e.def,I=e.thrower,C=e.return_ivar,k=e.send2,F=e.find_super,p=e.eqeq,w=e.const_set,z=e.eqeqeq,U=e.rb_divide,H=e.truthy,L=e.assign_ivar,N=e.alias,P=[],S=e.nil,Y=e.$$$;return a=P,t=s=[W(P[0],"BCDice")].concat(a),D=b=[W(s[0],"Arithmetic")].concat(t),y=[W(b[0],"Node")].concat(D),T=e.$r(y),(v=(c=B(y[0],null,"BinaryOp")).$$prototype).lhs=v.rhs=v.op=S,_(c,"$initialize",function(x,q,m){var r=this;return r.lhs=x,r.op=q,r.rhs=m}),_(c,"$eval",function(x){try{I("eval_return");var u,m=this,r=S;return r=m.lhs.$eval(x),u=m.rhs.$eval(x),r.$send(m.op,u)}catch(i){if(i===e.t_eval_return)return i.$v;throw i}}),_(c,"$output",function(){var x=this;return""+x.lhs.$output()+x.op+x.rhs.$output()}),_(c,"$s_exp",function(){var x=this;return"("+x.$op_for_s_exp()+" "+x.lhs.$s_exp()+" "+x.rhs.$s_exp()+")"}),_(c,"$op_for_s_exp",C("op")),function(d,g,c){var v=B(d,g,"DivideBase"),l=[v].concat(c),x=e.$r(l),q=v.$$prototype;q.lhs=q.rhs=q.op=S,_(v,"$initialize",function m(r,u){return m.$$p=null,k(this,F(this,"initialize",m,!1,!0),"initialize",[r,"/",u],null)}),_(v,"$eval",function(r){try{I("eval_return");var $,n,i=this;return $=i.lhs.$eval(r),n=i.rhs.$eval(r),p(n,0)&&i.$raise(x("ZeroDivisionError")),i.$divide_and_round($,n,r)}catch(j){if(j===e.t_eval_return)return j.$v;throw j}}),_(v,"$output",function m(){var r=m.$$p||S,u=this;return m.$$p=null,""+k(u,F(u,"output",m,!1,!0),"output",[],r)+u.$rounding_method()}),v.$private(),_(v,"$rounding_method",function(){return Y(this.$class(),"ROUNDING_METHOD")}),_(v,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(v,"$divide_and_round",function(r,u,i){return this.$raise(x("NotImplementedError"))})}(y[0],T("BinaryOp"),y),function(d,g,c){var v=B(d,g,"DivideWithGameSystemDefault"),l=[v].concat(c),x=e.$r(l);w(l[0],"ROUNDING_METHOD",""),v.$private(),_(v,"$divide_and_round",function(m,r,u){var i,$=S;return z(Y(x("RoundType"),"CEIL"),i=u)?U(m.$to_f(),r).$ceil():z(Y(x("RoundType"),"ROUND"),i)?($=U(m.$to_f(),r),H($["$negative?"]())?$.$abs().$round()["$-@"]():$.$round()):U(m,r).$floor()})}(y[0],T("DivideBase"),y),function(d,g,c){var v=B(d,g,"DivideWithCeil"),l=[v].concat(c);w(l[0],"ROUNDING_METHOD","C"),v.$private(),_(v,"$divide_and_round",function(q,m,r){return U(q.$to_f(),m).$ceil()})}(y[0],T("DivideBase"),y),function(d,g,c){var v=B(d,g,"DivideWithRound"),l=[v].concat(c);w(l[0],"ROUNDING_METHOD","R"),v.$private(),_(v,"$divide_and_round",function(q,m,r){var u=S;return u=U(q.$to_f(),m),H(u["$negative?"]())?u.$abs().$round()["$-@"]():u.$round()})}(y[0],T("DivideBase"),y),function(d,g,c){var v=B(d,g,"DivideWithFloor"),l=[v].concat(c);w(l[0],"ROUNDING_METHOD","F"),v.$private(),_(v,"$divide_and_round",function(q,m,r){return U(q,m).$floor()})}(y[0],T("DivideBase"),y),function(d,g){var c=B(d,null,"Negative");c.$$prototype.body=S,_(c,"$initialize",L("body")),_(c,"$eval",function(x){try{return I("eval_return"),this.body.$eval(x)["$-@"]()}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),_(c,"$output",function(){return"-"+this.body.$output()}),_(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(y[0]),function(d,g){var c=B(d,null,"Parenthesis");c.$$prototype.expr=S,_(c,"$initialize",L("expr")),_(c,"$eval",function(x){try{return I("eval_return"),this.expr.$eval(x)}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),_(c,"$output",function(){return"("+this.expr.$output()+")"}),_(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(y[0]),function(d,g){var c=B(d,null,"Number");return c.$$prototype.value=S,_(c,"$initialize",L("value")),_(c,"$eval",C("value")),_(c,"$output",function(){return this.value.$to_s()}),N(c,"s_exp","output")}(y[0])},Opal.modules.strscan=function(e){var L,N,P,S,Y,B=e.def,_=e.truthy,I=e.eqeqeq,C=e.Opal,k=e.return_ivar,F=e.send,p=e.alias,w=[],z=e.nil;return L=w,P=[N=(0,e.klass)(w[0],null,"StringScanner")].concat(L),S=e.$r(P),(Y=N.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=z,N.$attr_reader("pos","matched"),B(N,"$initialize",function(a){var f=this;return f.string=a,f.pos=0,f.matched=z,f.working=a,f.match=[]}),N.$attr_reader("string"),B(N,"$beginning_of_line?",function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)}),B(N,"$scan",function(a){var f=this,s=(a=f.$anchor(a)).exec(f.working);return null==s?f.matched=z:(f.prev_pos=f.pos,f.pos+=s[0].length,f.working=f.working.substring(s[0].length),f.matched=s[0],f.match=s,s[0])}),B(N,"$scan_until",function(a){var f=this;a=f.$anchor(a);for(var s=f.working,R=0;s.length!=R;++R){var t=a.exec(s.substr(R));if(null!==t){var o=R+t[0].length,b=s.substr(0,o);return f.matched=t[0],f.match=t,f.prev_pos=f.pos+R,f.pos+=o,f.working=s.substr(o),b}}return f.matched=z}),B(N,"$[]",function(a){var s;if(_(this.match["$empty?"]()))return z;I(S("Symbol"),s=a)?a=a.$to_s():I(S("String"),s)||(a=C["$coerce_to!"](a,S("Integer"),"to_int"));var R=this.match;return a<0&&(a+=R.length),a<0||a>=R.length||null==R[a]?z:R[a]}),B(N,"$check",function(a){var f=this,s=(a=f.$anchor(a)).exec(f.working);return f.matched=null==s?z:s[0]}),B(N,"$check_until",function(a){var f=this,s=f.prev_pos,R=f.pos,t=f.working,o=f.$scan_until(a);return f.prev_pos=s,f.pos=R,f.working=t,o}),B(N,"$peek",function(a){return this.working.substring(0,a)}),B(N,"$eos?",function(){return 0===this.working.length}),B(N,"$exist?",function(a){var s=a.exec(this.working);return null==s?z:0==s.index?0:s.index+1}),B(N,"$skip",function(a){var f=this,s=(a=f.$anchor(a)).exec(f.working);if(null==s)return f.match=[],f.matched=z;var R=s[0],t=R.length;return f.matched=R,f.match=s,f.prev_pos=f.pos,f.pos+=t,f.working=f.working.substring(t),t}),B(N,"$skip_until",function(a){var s=this.$scan_until(a);return s===z?z:(this.matched=s.substr(-1),s.length)}),B(N,"$get_byte",function(){var a=this,f=z;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,f=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=z,f}),B(N,"$match?",function(a){var f=this,s=(a=f.$anchor(a)).exec(f.working);return null==s?z:(f.prev_pos=f.pos,s[0].length)}),B(N,"$pos=",function(a){var f=this;return a<0&&(a+=f.string.$length()),f.pos=a,f.working=f.string.slice(a)}),B(N,"$matched_size",function(){return this.matched===z?z:this.matched.length}),B(N,"$post_match",function(){var a=this;return a.matched===z?z:a.string.substr(a.pos)}),B(N,"$pre_match",function(){var a=this;return a.matched===z?z:a.string.substr(0,a.prev_pos)}),B(N,"$reset",function(){var a=this;return a.working=a.string,a.matched=z,a.pos=0}),B(N,"$rest",k("working")),B(N,"$rest?",function(){return 0!==this.working.length}),B(N,"$rest_size",function(){return this.$rest().$size()}),B(N,"$terminate",function(){var a,f=this;return f.match=z,a=[f.string.$length()],F(f,"pos=",a),a[a.length-1]}),B(N,"$unscan",function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=z,a.match=z,a}),p(N,"bol?","beginning_of_line?"),p(N,"getch","get_byte"),N.$private(),B(N,"$anchor",function(a){var f=a.toString().match(/\/([^\/]+)$/);return f=f?f[1]:void 0,new RegExp("^(?:"+a.source+")",f)})},Opal.modules["bcdice/normalize"]=function(e){var p,H,z,W=e.module,B=e.eqeqeq,_=e.def,I=e.eqeq,C=[],k=e.nil;return p=C,z=[W(C[0],"BCDice")].concat(p),(H=W(z[0],"Normalize")).$module_function(),_(H,"$comparison_operator",function(N){var P;return B(/<=|=</,P=N)?"<=":B(/>=|=>/,P)?">=":B(/<>|!=|=!/,P)?"!=":B(/</,P)?"<":B(/>/,P)?">":B(/=/,P)?"==":k}),_(H,"$target_number",function(N){return I(N,"?")?N:N.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var L,Y,R,t,o,b,A,a,P,W=e.module,B=e.klass,_=e.const_set,I=e.hash2,C=e.truthy,k=e.send,F=e.def,p=e.thrower,w=e.top,z=[],U=e.nil;return w.$require("strscan"),w.$require("bcdice/normalize"),L=z,Y=P=[W(z[0],"BCDice")].concat(L),R=a=[W(P[0],"Command")].concat(Y),o=[t=B(a[0],null,"Lexer")].concat(R),b=e.$r(o),(A=t.$$prototype).scanner=A.notations=U,_(o[0],"SYMBOLS",I(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),F(t,"$initialize",function(E,y){var T,d,c;return E=C(c=(T=(d=E)===U||null==d?U:d.$split(" ",2))===U||null==T?U:T.$first())?c:"",this.scanner=b("StringScanner").$new(E),this.notations=k(y,"map",[],function(l){return null==l&&(l=U),C(l["$is_a?"](b("String")))?b("Regexp").$new(l):l})}),F(t,"$next_token",function(){try{var E=p("return"),y=this,T=U,d=U,c=U,v=U;return C(y.scanner["$eos?"]())?[!1,"$"]:(k(y.notations,"each",[],function l(x){var m,q=null==l.$$s?this:l.$$s;if(null==q.scanner&&(q.scanner=U),null==x&&(x=U),m=q.scanner.$scan(x),!C(m))return U;E.$throw(["NOTATION",m])},{$$s:y,$$ret:E}),C(T=y.scanner.$scan(/\d+/))?["NUMBER",T.$to_i()]:C(d=y.scanner.$scan(/[<>!=]+/))?(d=b("Normalize").$comparison_operator(d),[C(d)?"CMP_OP":"ILLEGAL",d]):(c=y.scanner.$getch().$upcase(),[C(v=b("SYMBOLS")["$[]"](c))?v:c.$to_sym(),c]))}catch(l){if(l===E)return l.$v;throw l}}),F(t,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var w,L,K,a,f,s,R,P,U,W=e.module,B=e.klass,_=e.def,I=e.return_ivar,C=e.truthy,k=[],F=e.nil;return w=k,L=U=[W(k[0],"BCDice")].concat(w),K=P=[W(U[0],"Command")].concat(L),f=[a=B(P[0],null,"Parsed")].concat(K),s=e.$r(f),(R=a.$$prototype).critical=R.fumble=R.dollar=R.modify_number=R.question_target=R.target_number=R.prefix_number=R.command=R.suffix_number=R.cmp_op=F,a.$attr_accessor("command"),a.$attr_accessor("prefix_number"),a.$attr_accessor("suffix_number"),a.$attr_accessor("critical"),a.$attr_accessor("fumble"),a.$attr_accessor("dollar"),a.$attr_accessor("modify_number"),a.$attr_accessor("cmp_op"),a.$attr_accessor("target_number"),a.$attr_writer("question_target"),_(a,"$initialize",function(){var o=this;return o.prefix_number=F,o.suffix_number=F,o.critical=F,o.fumble=F,o.dollar=F,o.cmp_op=F,o.target_number=F,o.question_target=!1}),_(a,"$question_target?",I("question_target")),_(a,"$to_s",function(o){var b=this,A=F,D=F,E=F,y=F,T=F;switch(null==o&&(o="after_command"),A=C(b.critical)?"@"+b.critical:F,D=C(b.fumble)?"#"+b.fumble:F,E=C(b.dollar)?"$"+b.dollar:F,y=s("Format").$modifier(b.modify_number),T=C(b.question_target)?"?":b.target_number,o.valueOf()){case"after_command":return[b.prefix_number,b.command,b.suffix_number,A,D,E,y,b.cmp_op,T].$join();case"after_modify_number":return[b.prefix_number,b.command,b.suffix_number,y,A,D,E,b.cmp_op,T].$join();case"after_target_number":return[b.prefix_number,b.command,b.suffix_number,y,b.cmp_op,T,A,D,E].$join();default:return F}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var o,E,v,u,i,$,n,j,X,G,Z,Q,se,l,m,r,ce,T,d,A,W=e.klass,B=e.module,_=e.slice,I=e.extract_kwargs,C=e.ensure_kwargs,k=e.get_kwarg,F=e.send2,p=e.find_super,w=e.def,z=e.send,U=e.eqeq,H=e.thrower,L=e.hash,N=e.const_set,P=e.truthy,S=e.to_ary,Y=e.hash2,K=e.top,a=[],f=e.$r(a),s=e.nil,R=e.$$$;return K.$require("racc/parser.rb"),K.$require("bcdice/arithmetic/node"),K.$require("bcdice/command/lexer"),K.$require("bcdice/command/parsed"),W(R(f("BCDice"),"Command"),R(f("Racc"),"Parser"),"Parser"),o=a,E=A=[B(a[0],"BCDice")].concat(o),T=[B(A[0],"Command")].concat(E),d=e.$r(T),v=T,m=[l=W(T[0],R(d("Racc"),"Parser"),"Parser")].concat(v),r=e.$r(m),(ce=l.$$prototype).notations=ce.lexer=ce.modifier=ce.suffix_number=ce.prefix_number=ce.need_suffix_number=ce.need_prefix_number=ce.critical=ce.fumble=ce.dollar=ce.allowed_cmp_op=ce.question_target=s,w(l,"$initialize",function V(h,J){var O,M,re,$e,ee=this;return V.$$p=null,O=_(arguments),M=I(O),M=C(M),re=O,$e=k(M,"round_type"),F(ee,p(ee,"initialize",V,!1,!0),"initialize",[],null),ee.notations=re,ee.round_type=$e,ee.prefix_number=!1,ee.suffix_number=!1,ee.need_prefix_number=!1,ee.need_suffix_number=!1,ee.modifier=!0,ee.critical=!1,ee.fumble=!1,ee.dollar=!1,ee.allowed_cmp_op=[s,">=",">","<=","<","==","!="],ee.question_target=!1},-2),w(l,"$disable_modifier",function(){return this.modifier=!1,this}),w(l,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),w(l,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),w(l,"$has_prefix_number",function(){var h=this;return h.prefix_number=!0,h.need_prefix_number=!0,h}),w(l,"$has_suffix_number",function(){var h=this;return h.suffix_number=!0,h.need_suffix_number=!0,h}),w(l,"$enable_critical",function(){return this.critical=!0,this}),w(l,"$enable_fumble",function(){return this.fumble=!0,this}),w(l,"$enable_dollar",function(){return this.dollar=!0,this}),w(l,"$restrict_cmp_op_to",function(h){var J;return J=_(arguments),this.allowed_cmp_op=J,this},-1),w(l,"$enable_question_target",function(){return this.question_target=!0,this}),w(l,"$parse",function(h){var J=this;try{return J.lexer=r("Lexer").$new(h,J.notations),J.$do_parse()}catch(O){if(!e.rescue(O,[r("ParseError"),r("ZeroDivisionError")]))throw O;try{return s}finally{e.pop_exception()}}}),l.$private(),w(l,"$parsed",function(h,J,O,M){try{return H("eval_return"),z(r("Parsed").$new(),"tap",[],function ie(ee){var le,_e,de,me,ve,fe,be,oe=null==ie.$$s?this:ie.$$s;return null==oe.round_type&&(oe.round_type=s),null==ee&&(ee=s),ee["$command="](h["$[]"]("command")),ee["$prefix_number="]((le=h["$[]"]("prefix"))===s||null==le?s:le.$eval(oe.round_type)),ee["$suffix_number="]((_e=h["$[]"]("suffix"))===s||null==_e?s:_e.$eval(oe.round_type)),ee["$critical="]((de=J["$[]"]("critical"))===s||null==de?s:de.$eval(oe.round_type)),ee["$fumble="]((me=J["$[]"]("fumble"))===s||null==me?s:me.$eval(oe.round_type)),ee["$dollar="]((ve=J["$[]"]("dollar"))===s||null==ve?s:ve.$eval(oe.round_type)),ee["$modify_number="](O.$eval(oe.round_type)),ee["$cmp_op="](M["$[]"]("cmp_op")),U(M["$[]"]("target"),"?")?(ee["$question_target="](!0),z(ee,"target_number=",fe=[0]),fe[fe.length-1]):(ee["$question_target="](!1),fe=[(be=M["$[]"]("target"),be===s||null==be?s:be.$eval(oe.round_type))],z(ee,"target_number=",fe),fe[fe.length-1])},{$$s:this})}catch(ie){if(ie===e.t_eval_return)return ie.$v;throw ie}}),w(l,"$next_token",function(){return this.lexer.$next_token()}),u=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),i=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),$=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),n=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),j=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),X=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),G=[s,6,13,3,9,-1,27,-15,-10,-1,-38],Z=[s,s,s,s,s,s,19,16,15,s,s],Q=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),se=L(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),N(m[0],"Racc_arg",[u,i,n,$,j,X,Z,G,19,Q,se,58,35,!0]),P(r("Ractor","skip_raise")?"constant":s)&&r("Ractor").$make_shareable(r("Racc_arg")),N(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),P(r("Ractor","skip_raise")?"constant":s)&&r("Ractor").$make_shareable(r("Racc_token_to_s_table")),N(m[0],"Racc_debug_parser",!1),w(l,"$_reduce_1",function(h,J,O){var M;return P(this.modifier)||this.$raise(r("ParseError")),M=S(h),this.$parsed(null==M[0]?s:M[0],null==M[1]?s:M[1],null==M[2]?s:M[2],null==M[3]?s:M[3])}),w(l,"$_reduce_2",function(h,J,O){var M;return P(this.modifier)||this.$raise(r("ParseError")),M=S(h),this.$parsed(null==M[0]?s:M[0],null==M[2]?s:M[2],null==M[1]?s:M[1],null==M[3]?s:M[3])}),w(l,"$_reduce_3",function(h,J,O){var M,le;return le=null==(M=S(h))[2]?s:M[2],this.$parsed(null==M[0]?s:M[0],null==M[1]?s:M[1],R(R(r("Arithmetic"),"Node"),"Number").$new(0),le)}),w(l,"$_reduce_4",function(h,J,O){var M=this;return P(M.prefix_number)&&P(M.suffix_number)||M.$raise(r("ParseError")),Y(["command","prefix","suffix"],{command:h["$[]"](1),prefix:h["$[]"](0),suffix:h["$[]"](2)})}),w(l,"$_reduce_5",function(h,J,O){var M=this;return P(M.prefix_number)||M.$raise(r("ParseError")),P(M.need_suffix_number)&&M.$raise(r("ParseError")),Y(["command","prefix"],{command:h["$[]"](1),prefix:h["$[]"](0)})}),w(l,"$_reduce_6",function(h,J,O){var M=this;return P(M.suffix_number)||M.$raise(r("ParseError")),P(M.need_prefix_number)&&M.$raise(r("ParseError")),Y(["command","suffix"],{command:h["$[]"](0),suffix:h["$[]"](1)})}),w(l,"$_reduce_7",function(h,J,O){var M=this;return(P(M.need_prefix_number)||P(M.need_suffix_number))&&M.$raise(r("ParseError")),Y(["command"],{command:h["$[]"](0)})}),w(l,"$_reduce_8",function(h,J,O){return Y([],{})}),w(l,"$_reduce_9",function(h,J,O){var M,le,ie=s;return ie=null==(M=S(h))[0]?s:M[0],le=null==M[2]?s:M[2],P(this.critical)&&P(ie["$[]"]("critical")["$nil?"]())||this.$raise(r("ParseError")),ie["$[]="]("critical",le),ie}),w(l,"$_reduce_10",function(h,J,O){var M,le,ie=s;return ie=null==(M=S(h))[0]?s:M[0],le=null==M[2]?s:M[2],P(this.fumble)&&P(ie["$[]"]("fumble")["$nil?"]())||this.$raise(r("ParseError")),ie["$[]="]("fumble",le),ie}),w(l,"$_reduce_11",function(h,J,O){var M,le,ie=s;return ie=null==(M=S(h))[0]?s:M[0],le=null==M[2]?s:M[2],P(this.dollar)&&P(ie["$[]"]("dollar")["$nil?"]())||this.$raise(r("ParseError")),ie["$[]="]("dollar",le),ie}),w(l,"$_reduce_12",function(h,J,O){return h["$[]"](1)}),w(l,"$_reduce_13",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"Negative").$new(h["$[]"](1))}),w(l,"$_reduce_14",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"+",h["$[]"](2))}),w(l,"$_reduce_15",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"-",h["$[]"](2))}),w(l,"$_reduce_16",function(h,J,O){return P(this.allowed_cmp_op["$include?"](s))||this.$raise(r("ParseError")),Y([],{})}),w(l,"$_reduce_17",function(h,J,O){var M,ie,ee;return ee=null==(M=S(h))[1]?s:M[1],P(this.allowed_cmp_op["$include?"](ie=null==M[0]?s:M[0]))||this.$raise(r("ParseError")),Y(["cmp_op","target"],{cmp_op:ie,target:ee})}),w(l,"$_reduce_18",function(h,J,O){var re,M=this;return re=h["$[]"](0),P(M.question_target)||M.$raise(r("ParseError")),P(M.allowed_cmp_op["$include?"](re))||M.$raise(r("ParseError")),Y(["cmp_op","target"],{cmp_op:re,target:"?"})}),w(l,"$_reduce_19",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"+",h["$[]"](2))}),w(l,"$_reduce_20",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"-",h["$[]"](2))}),w(l,"$_reduce_22",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"*",h["$[]"](2))}),w(l,"$_reduce_23",function(h,J,O){return h["$[]"](3).$new(h["$[]"](0),h["$[]"](2))}),w(l,"$_reduce_25",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(l,"$_reduce_26",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"DivideWithCeil")}),w(l,"$_reduce_27",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"DivideWithCeil")}),w(l,"$_reduce_28",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"DivideWithRound")}),w(l,"$_reduce_29",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"DivideWithFloor")}),w(l,"$_reduce_30",function(h,J,O){return h["$[]"](1)}),w(l,"$_reduce_31",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"Negative").$new(h["$[]"](1))}),w(l,"$_reduce_33",function(h,J,O){return h["$[]"](1)}),w(l,"$_reduce_34",function(h,J,O){return R(R(r("Arithmetic"),"Node"),"Number").$new(h["$[]"](0))}),w(l,"$_reduce_none",function(h,J,O){return h["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var z,N,K,a,f,s,S,H,W=e.module,B=e.send,_=e.eqeqeq,I=e.truthy,C=e.def,k=e.return_val,F=[],p=e.nil;return z=F,N=H=[W(F[0],"BCDice")].concat(z),K=S=[W(H[0],"Deprecated")].concat(N),f=[a=W(S[0],"Checker")].concat(K),s=e.$r(f),a.$private(),C(a,"$check_result_legacy",function(t,o,b,A){var T,D=this,E=p,y=p,d=p,g=p;return E=B(o,"map",[],"sides".$to_proc()),T=(y=B(o,"map",[],"value".$to_proc())).$sum(),d=_([100],g=E)?D.$check_1D100(t,T,b,A):_([20],g)?D.$check_1D20(t,T,b,A):_([6,6],g)?D.$check_2D6(t,T,y,b,A):p,(I(d["$nil?"]())||I(d["$empty?"]()))&&(d=_([10],g=E.$uniq())?D.$check_nD10(t,T,y,b,A):_([6],g)?D.$check_nD6(t,T,y,b,A):p,I(d["$nil?"]())||I(d["$empty?"]()))?p:s("Result").$new(d.$delete_prefix(" \uff1e "))}),C(a,"$check_1D100",k(p)),C(a,"$check_1D20",k(p)),C(a,"$check_nD10",k(p)),C(a,"$check_2D6",k(p)),C(a,"$check_nD6",k(p))},Opal.modules["bcdice/base"]=function(e){var f,D,g,q,r,u,c,v,l,x,y,W=e.module,B=e.klass,_=e.slice,I=e.rb_plus,C=e.truthy,k=e.def,F=e.regexp,p=e.send,w=e.thrower,z=e.return_ivar,U=e.assign_ivar_val,H=e.eqeqeq,L=e.eqeq,N=e.return_val,P=e.range,S=e.rb_minus,Y=e.rb_divide,K=e.rb_times,a=e.rb_ge,s=e.top,R=[],t=e.$r(R),o=e.nil,b=e.$$$;return s.$require("i18n"),s.$require("i18n/backend/fallbacks"),s.$require("bcdice/randomizer"),s.$require("bcdice/dice_table"),s.$require("bcdice/enum"),s.$require("bcdice/translate"),s.$require("bcdice/result"),s.$require("bcdice/command/parser"),s.$require("bcdice/deprecated/checker"),D=R,g=y=[W(R[0],"BCDice")].concat(D),v=[c=B(y[0],null,"Base")].concat(g),l=e.$r(v),(x=c.$$prototype).raw_input=x.randomizer=x.enabled_upcase_input=x.debug=o,r=[q=e.get_singleton_class(c)].concat(v),u=e.$r(r),q.$attr_reader("prefixes"),k(q,"$register_prefix",function($){var j,G,X=this;return null==X.prefixes&&(X.prefixes=o),j=_(arguments),X.prefixes=I(C(G=X.prefixes)?G:[],j.$flatten())},-1),k(q,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),k(q,"$prefixes_pattern",function(){var $=this,n=o;return null==$.prefixes_pattern&&($.prefixes_pattern=o),null==$.prefixes&&($.prefixes=o),$.prefixes_pattern=C(n=$.prefixes_pattern)?n:o,C($.prefixes_pattern)?$.prefixes_pattern:($.prefixes=C(n=$.prefixes)?n:[],$.prefixes.$freeze(),$.prefixes_pattern=(C($.prefixes["$empty?"]())?/(?!)/:F(["^(S)?(",$.prefixes.$join("|"),")"],"i")).$freeze())}),k(q,"$command_pattern",function(){var $=this,n=o,j=o;return null==$.command_pattern&&($.command_pattern=o),null==$.prefixes&&($.prefixes=o),$.command_pattern=C(n=$.command_pattern)?n:o,C($.command_pattern)?$.command_pattern:($.prefixes=C(n=$.prefixes)?n:[],$.prefixes.$freeze(),j=I(p(b(u("CommonCommand"),"COMMANDS"),"map",[],function(G){return null==G&&(G=o),b(G,"PREFIX_PATTERN").$source()}),$.prefixes),$.command_pattern=F(["^S?(",j.$join("|"),")"],"i").$freeze())}),k(q,"$eval",function($){try{return w("eval_return"),this.$new($).$eval()}catch(X){if(X===e.t_eval_return)return X.$v;throw X}}),c.$include(l("Translate")),c.$include(b(l("Deprecated"),"Checker")),k(c,"$initialize",function(m){var r=this;return r.raw_input=m,r.sort_add_dice=!1,r.sort_barabara_dice=!1,r.d66_sort_type=b(l("D66SortType"),"NO_SORT"),r.enabled_d9=!1,r.round_type=b(l("RoundType"),"FLOOR"),r.sides_implicit_d=6,r.upper_dice_reroll_threshold=o,r.reroll_dice_reroll_threshold=o,r.default_cmp_op=o,r.default_target_number=o,r.enabled_upcase_input=!0,r.locale="ja_jp",r.randomizer=b(l("BCDice"),"Randomizer").$new(),r.debug=!1}),c.$attr_accessor("randomizer"),c.$attr_reader("d66_sort_type"),c.$attr_reader("round_type"),c.$attr_reader("sides_implicit_d"),c.$attr_reader("upper_dice_reroll_threshold"),c.$attr_reader("reroll_dice_reroll_threshold"),c.$attr_reader("default_cmp_op"),c.$attr_reader("default_target_number"),k(c,"$sort_add_dice?",z("sort_add_dice")),k(c,"$sort_barabara_dice?",z("sort_barabara_dice")),k(c,"$enabled_d9?",z("enabled_d9")),k(c,"$enable_debug",U("debug",!0)),k(c,"$eval",function(){var r,i,m=this,u=o;return r=b(l("BCDice"),"Preprocessor").$process(m.raw_input,m),u=C(i=m.$dice_command(r))?i:m.$eval_common_command(m.raw_input),C(u)?(u["$rands="](m.randomizer.$rand_results()),u["$detailed_rands="](m.randomizer.$detailed_rand_results()),u):o}),k(c,"$change_text",function(m){return m}),k(c,"$check_result",function(m,r,u,i){var $=this,n=o,j=o,X=o,G=o,Z=o;return n=$.$check_result_legacy(m,r,u,i),C(n)?n:(j=p(r,"map",[],"sides".$to_proc()),G=(X=p(r,"map",[],"value".$to_proc())).$sum(),n=H([100],Z=j)?$.$result_1d100(m,G,u,i):H([20],Z)?$.$result_1d20(m,G,u,i):H([6,6],Z)?$.$result_2d6(m,G,X,u,i):o,L(n,l("Result").$nothing())?o:C(n)?n:(n=H([10],Z=j.$uniq())?$.$result_nd10(m,G,X,u,i):H([6],Z)?$.$result_nd6(m,G,X,u,i):o,L(n,l("Result").$nothing())?o:C(n)?n:$.$result_ndx(m,u,i)))}),k(c,"$grich_text",N(o)),c.$private(),k(c,"$eval_common_command",function(m){try{w("eval_return");var u=w("return");return m=this.$change_text(m),p(b(l("CommonCommand"),"COMMANDS"),"each",[],function $(n){var X,j=null==$.$$s?this:$.$$s;if(null==j.randomizer&&(j.randomizer=o),null==n&&(n=o),X=n.$eval(m,j,j.randomizer),!C(X))return o;u.$throw(X)},{$$s:this,$$ret:u}),o}catch($){if($===e.t_eval_return||$===u)return $.$v;throw $}}),k(c,"$dice_command",function(m){var r=this,u=o,i=o,$=o,n=o;return C(r.enabled_upcase_input)&&(m=m.$upcase()),u=r.$class().$prefixes_pattern().$match(m),C(u)?(i=u["$[]"](1)["$nil?"]()["$!"](),C(i)&&(m=m["$[]"](P(1,-1,!1))),$=r.$eval_game_system_specific_command(m),C($["$is_a?"](l("Result")))?($["$secret="](C(n=$["$secret?"]())?n:i),$):C($["$nil?"]())||C($["$empty?"]())||L($,"1")?o:p(l("Result").$new(),"tap",[],function(X){var G;return null==X&&(X=o),X["$text="]($.$to_s()),p(X,"secret=",G=[i]),G[G.length-1]})):o}),k(c,"$eval_game_system_specific_command",N(o)),k(c,"$result_ndx",function(m,r,u){return C(u["$is_a?"](l("String")))?o:C(m.$send(r,u))?l("Result").$success(this.$translate("success")):l("Result").$failure(this.$translate("failure"))}),k(c,"$result_1d100",N(o)),k(c,"$result_1d20",N(o)),k(c,"$result_nd10",N(o)),k(c,"$result_2d6",N(o)),k(c,"$result_nd6",N(o)),k(c,"$get_table_by_2d6",function(m){return this.$get_table_by_nD6(m,2)}),k(c,"$get_table_by_1d6",function(m){return this.$get_table_by_nD6(m,1)}),k(c,"$get_table_by_nD6",function(m,r){return this.$get_table_by_nDx(m,r,6)}),k(c,"$get_table_by_nDx",function(m,r,u){var $,n=o;return $=this.randomizer.$roll_sum(r,u),n=this.$get_table_value(m["$[]"](S($,r))),C(n["$nil?"]())?["1",0]:[n,$]}),k(c,"$get_table_by_1d3",function(m){var i,$,r=this,n=o;return r.$debug("get_table_by_1d3"),i=r.randomizer.$roll_sum(1,6),r.$debug("num",i),$=Y(S(i,1),2).$to_i(),r.$debug("index",$),n=m["$[]"]($),C(n["$nil?"]())?["1",0]:[n,i]}),k(c,"$get_table_by_d66_swap",function(m){var u;return u=this.randomizer.$roll_d66(b(l("D66SortType"),"ASC")),[this.$get_table_by_number(u,m),u]}),k(c,"$get_table_by_d66",function(m){var u,i,$,j,n=o;return u=this.randomizer.$roll_once(6),i=this.randomizer.$roll_once(6),$=I(K(S(u,1),6),S(i,1)),n=m["$[]"]($),j=""+u+i,C(n["$nil?"]())?["1",j]:[n,j]}),k(c,"$get_table_by_number",function(m,r,u){try{var i=w("return");return null==u&&(u="1"),p(r,"each",[],function n(j){var G,X=null==n.$$s?this:n.$$s;if(null==j&&(j=o),G=j["$[]"](0),!C(a(G,m)))return o;i.$throw(X.$get_table_value(j["$[]"](1)))},{$$s:this,$$ret:i}),this.$get_table_value(u)}catch(n){if(n===i)return n.$v;throw n}},-3),k(c,"$get_table_value",function(m){return C(m["$is_a?"](l("Proc")))?m.$call():m}),k(c,"$roll_tables",function(m,r){var i=o;return i=r["$[]"](m),C(i)?i.$roll(this.randomizer).$to_s():o}),k(c,"$debug",function(m,r){var i,$=this,n=o,j=o;return i=_(arguments,1),C($.debug)?(n=C(m["$is_a?"](l("String")))?m:m.$inspect(),C(i["$empty?"]())?$.$warn(n):(j=p(i,"map",[],function(G){return null==G&&(G=o),C(G["$is_a?"](l("String")))?'"'+G+'"':G.$inspect()}),$.$warn(n+": "+j.$join(", ")))):o},-2),b(b(t("I18n"),"Backend"),"Simple").$include(b(b(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),t("I18n")["$default_locale="]("ja_jp"),f=[["ja_jp"]],p(t("I18n").$fallbacks(),"defaults=",f),f[f.length-1]},Opal.modules["bcdice/game_system/MagicaLogia"]=function(e){var R,A,T,d,g,r,u,i,$,n,c,v,l,E,y,o,W=e.module,B=e.klass,_=e.const_set,I=e.send2,C=e.find_super,k=e.def,F=e.eqeq,p=e.truthy,w=e.rb_le,z=e.rb_ge,U=e.rb_plus,H=e.rb_minus,L=e.hash2,N=e.defs,P=e.send,S=e.to_ary,K=[],a=e.nil,f=e.$$$;return e.top.$require("bcdice/base"),R=K,A=o=[W(K[0],"BCDice")].concat(R),E=[W(o[0],"GameSystem")].concat(A),y=e.$r(E),T=E[0],d=y("Base"),g=E,v=[c=B(T,d,"MagicaLogia")].concat(g),l=e.$r(v),c.$$prototype.randomizer=a,_(v[0],"ID","MagicaLogia"),_(v[0],"NAME","\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"),_(v[0],"SORT_KEY","\u307e\u304d\u304b\u308d\u304d\u3042"),_(v[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u30b9\u30da\u30b7\u30e3\u30eb\uff0f\u30d5\u30a1\u30f3\u30d6\u30eb\uff0f\u6210\u529f\uff0f\u5931\u6557\u3092\u5224\u5b9a\n\u30fb\u5404\u7a2e\u8868\n\u7d4c\u6b74\u8868\u3000BGT/\u521d\u671f\u30a2\u30f3\u30ab\u30fc\u8868\u3000DAT/\u904b\u547d\u5c5e\u6027\u8868\u3000FAT\n\u9858\u3044\u8868\u3000WIT/\u30d7\u30e9\u30a4\u30ba\u8868\u3000PT\n\u6642\u306e\u6d41\u308c\u8868\u3000TPT/\u5927\u5224\u6642\u306e\u6d41\u308c\u8868\u3000TPTB\n\u4e8b\u4ef6\u8868\u3000AT\n\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000FT\uff0f\u5909\u8abf\u8868\u3000WT\n\u904b\u547d\u5909\u8ee2\u8868\u3000FCT\n\u3000\u5178\u578b\u7684\u707d\u5384 TCT\uff0f\u7269\u7406\u7684\u707d\u5384 PCT\uff0f\u7cbe\u795e\u7684\u707d\u5384 MCT\uff0f\u72c2\u6c17\u7684\u707d\u5384 ICT\n\u3000\u793e\u4f1a\u7684\u707d\u5384 SCT\uff0f\u8d85\u5e38\u7684\u707d\u5384 XCT\uff0f\u4e0d\u601d\u8b70\u7cfb\u707d\u5384 WCT\uff0f\u30b3\u30df\u30ab\u30eb\u7cfb\u707d\u5384 CCT\n\u3000\u9b54\u6cd5\u4f7f\u3044\u306e\u707d\u5384 MGCT\n\u30b7\u30fc\u30f3\u8868\u3000ST\uff0f\u5927\u5224\u30b7\u30fc\u30f3\u8868\u3000STB\n\u3000\u6975\u9650\u74b0\u5883 XEST\uff0f\u5185\u9762\u4e16\u754c IWST\uff0f\u9b54\u6cd5\u90fd\u5e02 MCST\n\u3000\u6b7b\u5f8c\u4e16\u754c WDST\uff0f\u8ff7\u5bae\u4e16\u754c LWST\n\u3000\u9b54\u6cd5\u66f8\u67b6 MBST\uff0f\u9b54\u6cd5\u5b66\u9662 MAST\uff0f\u30af\u30ec\u30c9\u306e\u5854 TCST\n\u3000\u4e26\u884c\u4e16\u754c PWST\uff0f\u7d42\u672b\u3000\u3000 PAST\uff0f\u7570\u4e16\u754c\u9152\u5834 GBST\n\u3000\u307b\u3057\u304b\u3052 SLST\uff0f\u65e7\u56f3\u66f8\u9928 OLST\n\u4e16\u754c\u6cd5\u5247\u8ffd\u52a0\u8868 WLAT/\u3055\u307e\u3088\u3046\u602a\u7269\u8868 WMT\n\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868\u3000RCT\n\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868\u3000RTT\n\u3000\u661f\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTS, RTT1\n\u3000\u7363\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTB, RTT2\n\u3000\u529b\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTF, RTT3\n\u3000\u6b4c\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTP, RTT4\n\u3000\u5922\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTD, RTT5\n\u3000\u95c7\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTN, RTT6\n\u30d6\u30e9\u30f3\u30af\u79d8\u5bc6\u8868\u3000BST/\n\u3000\u5bbf\u6575\u8868\u3000MIT/\u8b00\u7565\u8868\u3000MOT/\u56e0\u7e01\u8868\u3000MAT\n\u3000\u5947\u4eba\u8868\u3000MUT/\u529b\u5834\u8868\u3000MFT/\u540c\u76df\u8868\u3000MLT\n\u843d\u82b1\u8868\u3000FFT\n\u305d\u306e\u5f8c\u8868 FLT\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n"),k(c,"$initialize",function q(m){var u=this;return q.$$p=null,I(u,C(u,"initialize",q,!1,!0),"initialize",[m],null),u.sort_add_dice=!0,u.sort_barabara_dice=!0,u.d66_sort_type=f(l("D66SortType"),"ASC")}),k(c,"$result_2d6",function(m,r,u,i,$){var n=this,j=a;return F($,"?")||!F(i,">=")?a:((j=p(w(r,2))?l("Result").$fumble(n.$translate("fumble")):p(z(r,12))?l("Result").$critical(n.$translate("MagicaLogia.special")):p(z(m,$))?l("Result").$success(n.$translate("success")):l("Result").$failure(n.$translate("failure")))["$text="](U(j.$text(),n.$gain_magic_element(u["$[]"](0),u["$[]"](1)))),j)}),k(c,"$eval_game_system_specific_command",function(m){var u,r=this;return p(u=f(r.$class(),"SKILL_TABLE").$roll_command(r.randomizer,m))?u:r.$roll_tables(m,f(r.$class(),"TABLES"))}),c.$private(),k(c,"$gain_magic_element",function(m,r){var u=this,i=a;return F(m,r)?(i=u.$translate("MagicaLogia.elements.items")["$[]"](H(m,1)),U(" \uff1e ",u.$format(u.$translate("MagicaLogia.elements.format"),L(["text"],{text:i})))):""}),r=v,i=[u=B(v[0],null,"SkillExpandTable")].concat(r),$=e.$r(i),(n=u.$$prototype).times=n.sides=n.items=n.name=n.skill_table=a,N(u,"$from_i18n",function(X,G,Z){var te=a;return te=$("I18n").$t(X,L(["locale","raise"],{locale:G,raise:!1})),this.$new(te["$[]"]("name"),te["$[]"]("type"),te["$[]"]("items"),Z)}),k(u,"$initialize",function(X,G,Z,Q){var te=this,ne=a;return te.name=X,te.items=Z.$freeze(),te.skill_table=Q,ne=/(\d+)D(\d+)/i.$match(G),p(ne)||te.$raise($("ArgumentError"),"Unexpected table type: "+G),te.times=ne["$[]"](1).$to_i(),te.sides=ne["$[]"](2).$to_i()}),k(u,"$roll",function(X){var Z,Q,G=this;return Z=X.$roll_sum(G.times,G.sides),Q=G.$expand(G.items["$[]"](H(Z,G.times)),X),f($("DiceTable"),"RollResult").$new(G.name,Z,Q)}),u.$private(),k(u,"$expand",function(X,G){return P(X,"gsub",[/%{([a-z]+)}/],function Q(){var se,te=null==Q.$$s?this:Q.$$s;return se=$("Regexp").$last_match()["$[]"](1).$to_sym(),te.$roll_skill(se,G)},{$$s:this})}),_(i[0],"CATEGORIES",["star","beast","force","poem","dream","night"].$freeze()),k(u,"$roll_skill",function(X,G){var Z=this,Q=a;return F(X,"skill")?Z.skill_table.$roll_skill(G):F(X,"element")?Z.skill_table.$roll_category(G):(Q=$("CATEGORIES").$index(X),p(Q)||Z.$raise($("ArgumentError")),Z.skill_table.$categories()["$[]"](Q).$roll(G).$name())}),function(q,m,r){var u=B(q,null,"FallenAfterTable"),i=[u].concat(r),$=e.$r(i),n=u.$$prototype;n.lower=n.higher=n.name=a,N(u,"$from_i18n",function(X,G){var Q=a;return Q=$("I18n").$t(X,L(["locale","raise"],{locale:G,raise:!0})),this.$new(Q["$[]"]("name"),Q["$[]"]("items_lower"),Q["$[]"]("items_higher"))}),k(u,"$initialize",function(X,G,Z){var Q=this;return Q.name=X,Q.lower=G,Q.higher=Z}),k(u,"$roll",function(X){var G,Z,te,ne,Q=this,se=a;return Z=X.$roll_barabara(2,6),ne=null==(G=S(Z))[1]?a:G[1],se=p(w(te=null==G[0]?a:G[0],3))?Q.lower:Q.higher,Q.name+"("+te+","+ne+") \uff1e "+se["$[]"](H(ne,1))})}(v[0],0,v),function(q,m){var r=[q].concat(m),u=e.$r(r);q.$private(),k(q,"$translate_skill_table",function($){return f(u("DiceTable"),"SaiFicSkillTable").$from_i18n("MagicaLogia.skill_table",$,L(["rttn"],{rttn:["RTS","RTB","RTF","RTP","RTD","RTN"]}))}),k(q,"$translate_tables",function($,n){var j,X,G,Z,Q,te;return j=u("SkillExpandTable").$from_i18n("MagicaLogia.inveterate_enemy_table",$,n),X=f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.conspiracy_table",$),G=f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.fate_table",$),Z=f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.cueball_table",$),Q=f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.force_field_table",$),te=u("SkillExpandTable").$from_i18n("MagicaLogia.alliance_table",$,n),L(["TPT","ST","FT","WT","FCT","AT","BGT","DAT","FAT","WIT","TCT","PCT","MCT","ICT","SCT","XCT","WCT","CCT","MIT","MOT","MAT","MUT","MFT","MLT","BST","PT","XEST","IWST","MCST","WDST","LWST","STB","MGCT","MBST","MAST","TCST","PWST","PAST","GBST","SLST","WLAT","WMT","FFT","OLST","TPTB","FLT"],{TPT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPT",$,n),ST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.ST",$,n),FT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FT",$),WT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WT",$,n),FCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FCT",$),AT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.AT",$,n),BGT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.BGT",$),DAT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.DAT",$),FAT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FAT",$),WIT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WIT",$),TCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.TCT",$),PCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PCT",$),MCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MCT",$),ICT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.ICT",$),SCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.SCT",$),XCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.XCT",$),WCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WCT",$),CCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.CCT",$),MIT:j,MOT:X,MAT:G,MUT:Z,MFT:Q,MLT:te,BST:f(u("DiceTable"),"ChainTable").$new(u("I18n").$translate("MagicaLogia.tables.BST.name",L(["raise","locale"],{raise:!0,locale:$})),"1D6",[j,X,G,Z,Q,te]),PT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PT",$),XEST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.XEST",$,n),IWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.IWST",$,n),MCST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MCST",$,n),WDST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WDST",$,n),LWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.LWST",$,n),STB:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.STB",$,n),MGCT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MGCT",$),MBST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MBST",$,n),MAST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MAST",$,n),TCST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TCST",$,n),PWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.PWST",$,n),PAST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.PAST",$,n),GBST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.GBST",$,n),SLST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.SLST",$,n),WLAT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WLAT",$),WMT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WMT",$,n),FFT:f(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FFT",$),OLST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.OLST",$,n),TPTB:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPTB",$,n),FLT:u("FallenAfterTable").$from_i18n("MagicaLogia.tables.FLT",$)})})}(e.get_singleton_class(c),v),_(v[0],"SKILL_TABLE",c.$translate_skill_table("ja_jp")),_(v[0],"TABLES",c.$translate_tables("ja_jp",l("SKILL_TABLE"))),c.$register_prefix(l("SKILL_TABLE").$prefixes()),c.$register_prefix(l("TABLES").$keys())},Opal.queue(function(e){var U,P,s,R,t,o,Y,K,L,W=e.module,B=e.klass,_=e.const_set,I=e.send2,C=e.find_super,k=e.def,p=[];return e.top.$require("bcdice/game_system/MagicaLogia"),U=p,P=L=[W(p[0],"BCDice")].concat(U),Y=[W(L[0],"GameSystem")].concat(P),K=e.$r(Y),s=Y,t=[R=B(Y[0],K("MagicaLogia"),"MagicaLogia_Korean")].concat(s),o=e.$r(t),_(t[0],"ID","MagicaLogia:Korean"),_(t[0],"NAME","\ub9c8\uae30\uce74\ub85c\uae30\uc544"),_(t[0],"SORT_KEY","\u56fd\u969b\u5316:Korean:\ub9c8\uae30\uce74\ub85c\uae30\uc544"),_(t[0],"HELP_MESSAGE","\u30fb\ud310\uc815\n\uc2a4\ud398\uc15c\uff0f\ud38c\ube14\uff0f\uc131\uacf5\uff0f\uc2e4\ud328\n\u30fb\uac01\uc885 \ud45c\n\uacbd\ub825 \ud45c BGT/ \ucd08\uae30 \uc575\ucee4 \ud45c DAT/ \uc6b4\uba85 \uc18d\uc131 \ud45c FAT\n\uc18c\uc6d0 \ud45c WIT/ \ud504\ub77c\uc774\uc988 \ud45c PT\n\uc2dc\uac04\uc758 \ud750\ub984 \ud45c(\uad6c\ud310) TPT/ \ub300\ud615\ud310 \uc2dc\uac04\uc758 \ud750\ub984 \ud45c TPTB\n\uc0ac\uac74 \ud45c AT\n\ud38c\ube14 \ud45c FT/ \uc0c1\ud0dc\uc774\uc0c1 \ud45c WT\n\uc6b4\uba85 \ubcc0\uc804 \ud45c FCT\n\u3000\uc804\ud615\uc801 \uc7ac\uc561 TCT\uff0f\ubb3c\ub9ac\uacc4 \uc7ac\uc561 PCT\uff0f\uc815\uc2e0\uacc4 \uc7ac\uc561 MCT\uff0f\uad11\uae30\uacc4 \uc7ac\uc561 ICT\n\u3000\uc0ac\ud68c\uacc4 \uc7ac\uc561 SCT\uff0f\ucd08\uc790\uc5f0\uacc4 \uc7ac\uc561 XCT\uff0f\ubd88\uac00\uc0ac\uc758\uacc4 \uc7ac\uc561 WCT\uff0f\ucf54\ubbf9\uacc4 \uc7ac\uc561 CCT\n\u3000\ub9c8\ubc95\uc0ac \uc7ac\uc561 MGCT\n\uc7a5\uba74\ud45c ST\uff0f\ub300\ud615\ud310 \uc7a5\uba74\ud45c STB\n\u3000\uadf9\ud55c \ud658\uacbd XEST\uff0f\ub0b4\uba74 \uc138\uacc4 IWST\uff0f\ub9c8\ubc95 \ub3c4\uc2dc MCST\n\u3000\uc0ac\ud6c4 \uc138\uacc4 WDST\uff0f\ubbf8\uad81 \uc138\uacc4 LWST\n\u3000\ub9c8\ubc95 \uc11c\uac00 MBST\uff0f\ub9c8\ubc95 \ud559\uc6d0 MAST\uff0f\ud06c\ub808\ub3c4\uc758 \ud0d1 TCST\n\u3000\ubcd1\ud589 \uc138\uacc4 PWST\uff0f\uc885\ub9d0 PAST\uff0f\uc774\uc138\uacc4 \uc220\uc9d1 GBST\n\u3000\ubcc4\ube5b SLST\uff0f\uad6c \ub3c4\uc11c\uad00 OLST\n\uc138\uacc4 \ubc95\uce59 \ucd94\uac00 \ud45c WLAT\uff0f\ub5a0\ub3cc\uc774 \uad34\ubb3c \ud45c WMT\n\ub79c\ub364 \ubd84\uc57c \ud45c RCT\n\ub79c\ub364 \ud2b9\uae30 \ud45c RTT\n\u3000\ubcc4 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTS, RTT1\n\u3000\uc9d0\uc2b9 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTB, RTT2\n\u3000\ud798 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTF, RTT3\n\u3000\ub178\ub798 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTP, RTT4\n\u3000\uafc8 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTD, RTT5\n\u3000\uc5b4\ub460 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTN, RTT6\n\ubc31\uc9c0 \ube44\ubc00 \ud45c\u3000BST/\n\u3000\uc219\uc801\ud45c\u3000MIT/\ubaa8\ub7b5 \ud45c\u3000MOT/\uc778\uc5f0 \ud45c\u3000MAT\n\u3000\uae30\uc778\ud45c\u3000MUT/\uc5ed\uc7a5 \ud45c\u3000MFT/\ub3d9\ub9f9 \ud45c\u3000MLT\n\ub099\ud654 \ud45c\u3000FFT\n\uadf8 \ud6c4\uc758 \uc804\uac1c \ud45c FLT\n\u30fbD66 \ub2e4\uc774\uc2a4 \uc788\uc74c.\n"),R.$register_prefix_from_super_class(),k(R,"$initialize",function b(A){var E=this;return b.$$p=null,I(E,C(E,"initialize",b,!1,!0),"initialize",[A],null),E.locale="ko_kr"}),_(t[0],"SKILL_TABLE",R.$translate_skill_table("ko_kr")),_(t[0],"TABLES",R.$translate_tables("ko_kr",o("SKILL_TABLE")))})}}]);