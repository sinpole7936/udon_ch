(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[4385],{7396:(O,ee,Q)=>{Q(5151),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var k,L,R,K,z,w,G,C,E=e.module,A=e.ensure_kwargs,m=e.truthy,F=e.thrower,I=e.def,h=[],g=e.nil,u=e.$$$;return k=h,L=C=[E(h[0],"BCDice")].concat(k),G=[w=E(C[0],"ArithmeticEvaluator")].concat(L),K=[R=e.get_singleton_class(w)].concat(G),z=e.$r(K),I(R,"$eval",function(S,v){try{F("eval_return");var p,Y=g;return null==(p=(v=A(v)).$$smap.round_type)&&(p=u(z("RoundType"),"FLOOR")),m(S)&&m(Y=z("Arithmetic").$eval(S,p))?Y:0}catch(B){if(B===e.t_eval_return)return B.$v;throw B}},-2)},Opal.modules["bcdice/game_system/Cthulhu"]=function(e){var v,B,Z,i,n,$,l,b,q,N,j,J,V,p,E=e.module,A=e.klass,m=e.const_set,F=e.send2,I=e.find_super,h=e.def,g=e.eqeqeq,u=e.truthy,y=e.rb_le,k=e.rb_gt,D=e.rb_plus,C=e.send,M=e.thrower,L=e.rb_divide,w=e.rb_times,G=e.rb_lt,R=e.rb_ge,H=e.rb_minus,z=[],r=e.nil;return e.top.$require("bcdice/arithmetic_evaluator"),v=z,B=p=[E(z[0],"BCDice")].concat(v),J=[E(p[0],"GameSystem")].concat(B),V=e.$r(J),Z=J,q=[b=A(J[0],V("Base"),"Cthulhu")].concat(Z),N=e.$r(q),(j=b.$$prototype).randomizer=j.locale=j.special_percentage=j.critical_percentage=j.fumble_percentage=r,m(q[0],"ID","Cthulhu"),m(q[0],"NAME","\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"),m(q[0],"SORT_KEY","\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG"),m(q[0],"HELP_MESSAGE","c=\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024 \uff0f f=\u30d5\u30a1\u30f3\u30d6\u30eb\u5024 \uff0f s=\u30b9\u30da\u30b7\u30e3\u30eb\n\n1d100<=n    c\u30fbf\u30fbs\u3059\u3079\u3066\u30aa\u30d5\uff08\u5358\u7d14\u306a\u6570\u5024\u6bd4\u8f03\u5224\u5b9a\u306e\u307f\u884c\u3044\u307e\u3059\uff09\n\n\u30fbcfs\u5224\u5b9a\u4ed8\u304d\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\n\nCC\t 1d100\u30ed\u30fc\u30eb\u3092\u884c\u3046 c=1\u3001f=100\nCCB  \u540c\u4e0a\u3001c=5\u3001f=96\n\n\u4f8b\uff1aCC<=80  \uff08\u6280\u80fd\u502480\u3067\u884c\u70ba\u5224\u5b9a\u30021%\u30eb\u30fc\u30eb\u3067cf\u9069\u7528\uff09\n\u4f8b\uff1aCCB<=55 \uff08\u6280\u80fd\u502455\u3067\u884c\u70ba\u5224\u5b9a\u30025%\u30eb\u30fc\u30eb\u3067cf\u9069\u7528\uff09\n\n\u30fb\u7d44\u307f\u5408\u308f\u305b\u30ed\u30fc\u30eb\u306b\u3064\u3044\u3066\n\nCBR(x,y)\tc=1\u3001f=100\nCBRB(x,y)\tc=5\u3001f=96\n\n\u30fb\u62b5\u6297\u8868\u30ed\u30fc\u30eb\u306b\u3064\u3044\u3066\nRES(x-y)\tc=1\u3001f=100\nRESB(x-y)\tc=5\u3001f=96\n\n\u203b\u6545\u969c\u30ca\u30f3\u30d0\u30fc\u5224\u5b9a\n\n\u30fbCC(x) c=1\u3001f=100\nx=\u6545\u969c\u30ca\u30f3\u30d0\u30fc\u3002\u51fa\u76eex\u4ee5\u4e0a\u304c\u51fa\u305f\u4e0a\u3067\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u304c\u540c\u6642\u306b\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u5171\u306b\u51fa\u529b\u3059\u308b\uff08\u30c6\u30ad\u30b9\u30c8\u300c\u30d5\u30a1\u30f3\u30d6\u30eb\uff06\u6545\u969c\u300d\uff09\n\u30d5\u30a1\u30f3\u30d6\u30eb\u3067\u306a\u3044\u5834\u5408\u3001\u6210\u529f\u30fb\u5931\u6557\u306b\u95a2\u308f\u3089\u305a\u30c6\u30ad\u30b9\u30c8\u300c\u6545\u969c\u300d\u306e\u307f\u3092\u51fa\u529b\u3059\u308b\uff08\u6210\u529f\u30fb\u5931\u6557\u3092\u51fa\u529b\u305b\u305a\u3001\u4e0a\u66f8\u304d\u3057\u305f\u3082\u306e\u3092\u51fa\u529b\u3059\u308b\u5f62\uff09\n\n\u30fbCCB(x) c=5\u3001f=96\n\u540c\u4e0a\n\n"),b.$register_prefix("CCB?","RESB?","CBRB?"),h(b,"$initialize",function d(s){var n=this;return d.$$p=null,F(n,I(n,"initialize",d,!1,!0),"initialize",[s],null),n.special_percentage=20,n.critical_percentage=1,n.fumble_percentage=1}),h(b,"$eval_game_system_specific_command",function(s){var n,i=this;return g(/CCB/i,n=s)?(i.critical_percentage=5,i.fumble_percentage=5,i.$getCheckResult(s)):g(/CC/i,n)?(i.critical_percentage=1,i.fumble_percentage=1,i.$getCheckResult(s)):g(/RESB/i,n)?(i.critical_percentage=5,i.fumble_percentage=5,i.$getRegistResult(s)):g(/CBRB/i,n)?(i.critical_percentage=5,i.fumble_percentage=5,i.$getCombineRoll(s)):g(/RES/i,n)?(i.critical_percentage=1,i.fumble_percentage=1,i.$getRegistResult(s)):g(/CBR/i,n)?(i.critical_percentage=1,i.fumble_percentage=1,i.$getCombineRoll(s)):r}),b.$private(),h(b,"$getCheckResult",function(s){try{M("eval_return");var n=this,$=r,l=r,a=r,t=r,c=r,f=r;return $=/^CCB?(\d+)?(?:<=([+-\/*\d]+))?$/i.$match(s),u($)?(l=$["$[]"](1).$to_i(),a=N("ArithmeticEvaluator").$eval($["$[]"](2)),u(y(a,0))?(t=n.randomizer.$roll_once(100),N("Result").$new("(1D100) \uff1e "+t)):(c="(1D100<="+a+")",u(k(l,0))&&(c=D(c," "+n.$translate("Cthulhu.broken_number")+"["+l+"]")),t=n.randomizer.$roll_once(100),f=n.$compare(t,a,l),C(f.$to_result(),"tap",[],function(_){var x;return null==_&&(_=r),x=[c+" \uff1e "+t+" \uff1e "+f.$text()],C(_,"text=",x),x[x.length-1]}))):r}catch(o){if(o===e.t_eval_return)return o.$v;throw o}}),i=q,$=[n=A(q[0],null,"CompareResult")].concat(i),l=e.$r($),n.$include(l("Translate")),n.$attr_accessor("success","failure","critical","fumble","special","broken"),h(n,"$initialize",function(t){var c=this;return c.locale=t,c.success=!1,c.failure=!1,c.critical=!1,c.fumble=!1,c.special=!1,c.broke=!1}),h(n,"$text",function(){var t=this;return u(t.$critical())&&u(t.$special())?t.$translate("Cthulhu.critical_special"):u(t.$critical())?t.$translate("Cthulhu.critical"):u(t.$special())?t.$translate("Cthulhu.special"):u(t.$success())?t.$translate("success"):u(t.$broken())&&u(t.$fumble())?t.$translate("Cthulhu.fumble")+"/"+t.$translate("Cthulhu.broken"):u(t.$broken())?t.$translate("Cthulhu.broken"):u(t.$fumble())?t.$translate("Cthulhu.fumble"):u(t.$failure())?t.$translate("failure"):r}),h(n,"$to_result",function(){return C(l("Result").$new(),"tap",[],function c(f){var o,_=null==c.$$s?this:c.$$s;return null==f&&(f=r),f["$success="](_.$success()),f["$failure="](_.$failure()),f["$critical="](_.$critical()),o=[_.$fumble()],C(f,"fumble=",o),o[o.length-1]},{$$s:this})}),h(b,"$compare",function(s,i,n){var a,$=this,l=r;return null==n&&(n=0),l=N("CompareResult").$new($.locale),a=L(w(i,$.special_percentage),100).$to_i().$clamp(1,100),u(y(s,i))&&u(G(s,100))?(l["$success="](!0),l["$special="](y(s,a)),l["$critical="](y(s,$.critical_percentage))):(l["$failure="](!0),l["$fumble="](R(s,H(101,$.fumble_percentage)))),u(k(n,0))&&u(R(s,n))&&(l["$broken="](!0),l["$failure="](!0),l["$success="](!1),l["$special="](!1),l["$critical="](!1)),l},-3),h(b,"$getRegistResult",function(s){var i=this,n=r,$=r,l=r,a=r,t=r;return n=/^RESB?(-?\d+)$/i.$match(s),u(n)?($=n["$[]"](1).$to_i(),l=D(w($,5),50),u(G(l,5))?N("Result").$failure("(1d100<="+l+") \uff1e "+i.$translate("Cthulhu.automatic_failure")):u(k(l,95))?N("Result").$success("(1d100<="+l+") \uff1e "+i.$translate("Cthulhu.automatic_success")):(a=i.randomizer.$roll_once(100),t=i.$compare(a,l),C(t.$to_result(),"tap",[],function(f){var o;return null==f&&(f=r),o=["(1d100<="+l+") \uff1e "+a+" \uff1e "+t.$text()],C(f,"text=",o),o[o.length-1]}))):r}),h(b,"$getCombineRoll",function(s){var i=this,n=r,$=r,l=r,a=r,t=r,c=r,f=r;return n=/^CBR(B)?\((\d+),(\d+)\)$/i.$match(s),u(n)?($=n["$[]"](2).$to_i(),l=n["$[]"](3).$to_i(),a=i.randomizer.$roll_once(100),t=i.$compare(a,$),c=i.$compare(a,l),f=u(t.$success())&&u(c.$success())?i.$translate("success"):u(t.$success())||u(c.$success())?i.$translate("Cthulhu.partial_success"):i.$translate("failure"),C(N("Result").$new(),"tap",[],function(_){var x,P=r;return null==_&&(_=r),_["$text="]("(1d100<="+$+","+l+") \uff1e "+a+"["+t.$text()+","+c.$text()+"] \uff1e "+f),_["$critical="](u(P=t.$critical())?P:c.$critical()),_["$fumble="](u(P=t.$fumble())?P:c.$fumble()),x=[u(P=t.$success())?P:c.$success()],C(_,"condition=",x),x[x.length-1]})):r})},Opal.queue(function(e){var D,w,r,S,v,R,H,M,E=e.module,A=e.klass,m=e.const_set,F=e.send2,I=e.find_super,h=e.def,u=[];return e.top.$require("bcdice/game_system/Cthulhu"),D=u,w=M=[E(u[0],"BCDice")].concat(D),R=[E(M[0],"GameSystem")].concat(w),H=e.$r(R),r=R,m((v=[S=A(R[0],H("Cthulhu"),"Cthulhu_English")].concat(r))[0],"ID","Cthulhu:English"),m(v[0],"NAME","Call of Cthulhu"),m(v[0],"SORT_KEY","\u56fd\u969b\u5316:English:Call of Cthulhu"),m(v[0],"HELP_MESSAGE",'c=Critical Rate \uff0f f=Fumble Rate \uff0f s=Special\n\n1d100<=n    c\u30fbf\u30fbs AllOff\uff08Does Simple Numeric Comparison Only\uff09\n\n\u30fbRoll Command that determines cfs\n\nCC\t Does a 1d100 roll c=1\u3001f=100\nCCB  Same as above\u3001c=5\u3001f=96\n\nEx\uff1aCC<=80  \uff08Rolls using 80 as skill value with 1% cf rule applied\uff09\nEx\uff1aCCB<=55 \uff08Rolls using 55 as skill value with 5% cf rule applied\uff09\n\n\u30fbAbout Roll Combination\n\nCBR(x,y)\tc=1\u3001f=100\nCBRB(x,y)\tc=5\u3001f=96\n\n\u30fbAbout Opposed Rolls\nRES(x-y)\tc=1\u3001f=100\nRESB(x-y)\tc=5\u3001f=96\n\n\u203bMalfunction Number Determination\n\n\u30fbCC(x) c=1\u3001f=100\nx=Malfunction Number. Outputs\uff08text "Fumble&Malfunction"\uff09together, when roll result is equal or above x, and fumble happens simultaneously.\nIf not a fumble, outputs text "Malfunction" regardless of success/failure\uff08Outputs the overwritten result, not outputting success/failure\uff09\n\n\u30fbCCB(x) c=5\u3001f=96\nSame as above\n'),S.$register_prefix_from_super_class(),h(S,"$initialize",function T(p){var B=this;return T.$$p=null,F(B,I(B,"initialize",T,!1,!0),"initialize",[p],null),B.locale="en_us"})})}}]);