(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3356],{4079:(W,X,q)=>{q(5151),Opal.queue(function(o){var U,B,V,s,K,l,j,T,H,N,v=o.module,C=o.klass,I=o.const_set,n=o.truthy,x=o.def,w=o.hash,d=o.send,y=o.eqeq,A=o.rb_lt,L=o.rb_ge,p=o.thrower,M=o.hash2,J=o.rb_gt,z=o.rb_minus,G=[],r=o.nil;return U=G,B=N=[v(G[0],"BCDice")].concat(U),T=[v(N[0],"GameSystem")].concat(B),H=o.$r(T),V=T,K=[s=C(T[0],H("Base"),"KyokoShinshoku")].concat(V),l=o.$r(K),(j=s.$$prototype).round_type=j.randomizer=r,I(K[0],"ID","KyokoShinshoku"),I(K[0],"NAME","\u865a\u69cb\u4fb5\u8755TRPG"),I(K[0],"SORT_KEY","\u304d\u3088\u3053\u3046\u3057\u3093\u3057\u3088\u304fTRPG"),I(K[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u3000\u30c0\u30a4\u30b9\u3092\u6307\u5b9a\u6570\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3057\u3066\u3001\u6700\u3082\u9ad8\u3044\u51fa\u76ee\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\u96e3\u6613\u5ea6\u3092\u6307\u5b9a\u3059\u308b\u3068\u6210\u5426\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002\u30aa\u30d7\u30b7\u30e7\u30f3\u3067A\u3001D\u3092\u3064\u3051\u308b\u3068\u3001\uff3b\u6709\u5229\uff3d\uff3b\u4e0d\u5229\uff3d\u306e\u6761\u4ef6\u3067\u632f\u308c\u307e\u3059\uff08A=\uff3b\u6709\u5229\uff3d\u3001D=\uff3b\u4e0d\u5229\uff3d\uff09\u3002\nKS(x,y)\nx\uff1a\u30c0\u30a4\u30b9\u30b5\u30a4\u30ba\u30021=D4\uff08\u80fd\u529b\u50241\u30012\u4ee5\u4e0a\u306e\u51fa\u76ee\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59271\uff09\uff0f2=D4\uff08\u80fd\u529b\u50242\u30013\u4ee5\u4e0a\u306e\u51fa\u76ee\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59272\uff09\uff0f3=D4\uff08\u80fd\u529b\u50243\u3001\u51fa\u76ee4\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59273\uff09\uff0f4=D4\uff0f6=D6\uff0f8=D8\uff0f10=D10\uff0f12=D12\uff0f20=D20\ny\uff1a\u30c0\u30a4\u30b9\u6570\uff08\u7701\u7565\uff1a1\uff09\n\nKS(x,y)>=z\nx\uff1a\u30c0\u30a4\u30b9\u30b5\u30a4\u30ba\u30021=D4\uff08\u80fd\u529b\u50241\u30012\u4ee5\u4e0a\u306e\u51fa\u76ee\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59271\uff09\uff0f2=D4\uff08\u80fd\u529b\u50242\u30013\u4ee5\u4e0a\u306e\u51fa\u76ee\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59272\uff09\uff0f3=D4\uff08\u80fd\u529b\u50243\u3001\u51fa\u76ee4\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59273\uff09\uff0f4=D4\uff0f6=D6\uff0f8=D8\uff0f10=D10\uff0f12=D12\uff0f20=D20\ny\uff1a\u30c0\u30a4\u30b9\u6570\uff08\u7701\u7565\uff1a1\uff09\nz\uff1a\u96e3\u6613\u5ea6\n\nKS(x,y)A>=z\uff08\uff3b\u6709\u5229\uff3d\uff1aKS(x,y)\u306e\u5224\u5b9a\u3092\uff12\u56de\u884c\u3044\u3001\u305d\u308c\u305e\u308c\u306e\u7d50\u679c\u306e\u3088\u308a\u5927\u304d\u3044\u65b9\u304c\u7d50\u679c\u3068\u306a\u308a\u307e\u3059\uff09\nx\uff1a\u30c0\u30a4\u30b9\u30b5\u30a4\u30ba\u30021=D4\uff08\u80fd\u529b\u50241\u30012\u4ee5\u4e0a\u306e\u51fa\u76ee\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59271\uff09\uff0f2=D4\uff08\u80fd\u529b\u50242\u30013\u4ee5\u4e0a\u306e\u51fa\u76ee\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59272\uff09\uff0f3=D4\uff08\u80fd\u529b\u50243\u3001\u51fa\u76ee4\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59273\uff09\uff0f4=D4\uff0f6=D6\uff0f8=D8\uff0f10=D10\uff0f12=D12\uff0f20=D20\ny\uff1a\u30c0\u30a4\u30b9\u6570\uff08\u7701\u7565\uff1a1\uff09\nz\uff1a\u96e3\u6613\u5ea6\n\nKS(x,y)D>=z\uff08\uff3b\u4e0d\u5229\uff3d\uff1aKS(x,y)\u306e\u5224\u5b9a\u3092\uff12\u56de\u884c\u3044\u3001\u305d\u308c\u305e\u308c\u306e\u7d50\u679c\u306e\u3088\u308a\u5c0f\u3055\u3044\u65b9\u304c\u7d50\u679c\u3068\u306a\u308a\u307e\u3059\uff09\nx\uff1a\u30c0\u30a4\u30b9\u30b5\u30a4\u30ba\u30021=D4\uff08\u80fd\u529b\u50241\u30012\u4ee5\u4e0a\u306e\u51fa\u76ee\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59271\uff09\uff0f2=D4\uff08\u80fd\u529b\u50242\u30013\u4ee5\u4e0a\u306e\u51fa\u76ee\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59272\uff09\uff0f3=D4\uff08\u80fd\u529b\u50243\u3001\u51fa\u76ee4\u304c\u51fa\u3066\u3044\u305f\u3068\u3057\u3066\u3082\u6700\u59273\uff09\uff0f4=D4\uff0f6=D6\uff0f8=D8\uff0f10=D10\uff0f12=D12\uff0f20=D20\ny\uff1a\u30c0\u30a4\u30b9\u6570\uff08\u7701\u7565\uff1a1\uff09\nz\uff1a\u96e3\u6613\u5ea6\n\n\u30fb\u89b3\u6e2c\u30ed\u30fc\u30eb\n\u3000\uff3b\u73fe\u5b9f\u4e56\u96e2\uff3d\u306e\u6bb5\u968e\u306b\u5fdc\u3058\u305f\u30c0\u30a4\u30b9\u3092\u6307\u5b9a\u6570\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3057\u3066\u3001\u6700\u3082\u9ad8\u3044\u51fa\u76ee\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\nKR(x)\nx=\uff3b\u73fe\u5b9f\u4e56\u96e2\uff3d\u306e\u6bb5\u968e\uff081=D4\uff0f2=D6\uff0f3=D8\uff0f4=D10\uff0f5=D12\uff0f6=D20\uff09\n\nKR(x,y)\u3000\u89b3\u6e2c\u30ed\u30fc\u30eb\uff08\u30ea\u30a2\u30ea\u30c6\u30a3\u30e9\u30a4\u30f3\u3042\u308a\uff09\nx=\uff3b\u73fe\u5b9f\u4e56\u96e2\uff3d\u306e\u6bb5\u968e\uff081=D4\uff0f2=D6\uff0f3=D8\uff0f4=D10\uff0f5=D12\uff0f6=D20\uff09\ny=\uff3b\u30ea\u30a2\u30ea\u30c6\u30a3\u30e9\u30a4\u30f3\uff3d\u306e\u30ec\u30d9\u30eb\uff083=1\u500b\uff0f2=2\u500b\uff0f1=3\u500b\uff09\n\n\u30fb\u865a\u69cb\u306e\u53ce\u675f\u306e\u4fb5\u8755\u5ea6\u6e1b\u5c11\u30ed\u30fc\u30eb\n\u3000\uff3b\u73fe\u5b9f\u4e56\u96e2\uff3d\u306e\u6bb5\u968e\u306b\u5fdc\u3058\u305f\u30c0\u30a4\u30b9\u3092\u6307\u5b9a\u6570\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3057\u3066\u3001\u305d\u306e\u5408\u8a08\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\nKRS(x,y)\nx=\uff3b\u73fe\u5b9f\u4e56\u96e2\uff3d\u306e\u6bb5\u968e\uff081=D4\uff0f2=D6\uff0f3=D8\uff0f4=D10\uff0f5=D12\uff0f6=D20\uff09\ny=\u30c0\u30a4\u30b9\u306e\u500b\u6570\n"),s.$register_prefix("KS","KR","KRS"),x(s,"$eval_game_system_specific_command",function(u){var $,e,D=this;return n($=n(e=D.$roll_check(u))?e:D.$roll_kansoku(u))?$:D.$roll_shusoku(u)}),s.$private(),I(K[0],"DICE_SIZE_TO_SIDES",w(1,4,2,4,3,4,4,4,6,6,8,8,10,10,12,12,20,20).$freeze()),x(s,"$roll_check",function(u){try{p("eval_return");var $=this,e=r,t=r,_=r,i=r,c=r,a=r,h=r,f=r,k=r,S=r,m=r;return e=/^KS(?:\(([-+\d]+),([-+\d]+)?\)|(\d+))([AD]?)(?:>=([-+\d]+))?$/.$match(u),!n(e)||(t=n(e["$[]"](1))?l("Arithmetic").$eval(e["$[]"](1),$.round_type):l("Arithmetic").$eval(e["$[]"](3),$.round_type).$to_i(),_=n(e["$[]"](2))?l("Arithmetic").$eval(e["$[]"](2),$.round_type):1,i=n(c=e["$[]"](5))?l("Arithmetic").$eval(e["$[]"](5),$.round_type):c,a=e["$[]"](4),h=l("DICE_SIZE_TO_SIDES")["$[]"](t),n(h["$nil?"]())||n(_["$nil?"]()))?r:(f=d(l("Array"),"new",[n(a["$empty?"]())?1:2],function R(){return(null==R.$$s?this:R.$$s).$roll_check_once(_,t,h)},{$$s:$}),k=d(f,"map",[],function(b){return null==b&&(b=r),b["$[]"]("value")}),S=y(a,"A")?k.$max():y(a,"D")?k.$min():k.$first(),(m=y(S,1)?l("Result").$fumble("\u30d5\u30a1\u30f3\u30d6\u30eb"):n(i)&&n(A(S,i))?l("Result").$failure("\u5931\u6557"):n(i)&&y(S,h)?l("Result").$critical("\u30af\u30ea\u30c6\u30a3\u30ab\u30eb"):n(i)&&n(L(S,i))?l("Result").$success("\u6210\u529f"):l("Result").$new())["$text="]([n(i)?"(KS("+t+","+_+")"+a+">="+i+")":"(KS("+t+","+_+")"+a+")",$.$format_rolls(f),S,m.$text()].$compact().$join(" \uff1e ")),m)}catch(R){if(R===o.t_eval_return)return R.$v;throw R}}),x(s,"$roll_check_once",function(u,D,$){var _,t=r;return _=n(A(u,1))?(t=this.randomizer.$roll_barabara(2,$).$sort()).$min().$clamp(1,D):(t=this.randomizer.$roll_barabara(u,$).$sort()).$max().$clamp(1,D),M(["dice_list","value"],{dice_list:t,value:_})}),x(s,"$format_rolls",function(u){return y(u.$length(),1)&&y(u.$first()["$[]"]("dice_list").$length(),1)?r:d(u,"map",[],function($){return null==$&&($=r),y($["$[]"]("dice_list").$length(),1)?$["$[]"]("value").$to_s():$["$[]"]("value")+"["+$["$[]"]("dice_list").$join(",")+"]"}).$join(", ")}),I(K[0],"GENJITU_KAIRI_TO_SIDES",[4,6,8,10,12,20].$freeze()),I(K[0],"REALITY_LINE_TO_TIMES",w(3,1,2,2,1,3).$freeze()),x(s,"$roll_kansoku",function(u){var D,$,t=r,_=r,i=r,c=r,a=r,h=r,f=r,k=r,S=r;return t=/^KR(?:(\d+)|\((\d),(\d)\))$/.$match(u),n(t)&&(_=n(i=(D=t["$[]"](1))===r||null==D?r:D.$to_i())?i:t["$[]"](2).$to_i(),c=($=t["$[]"](3))===r||null==$?r:$.$to_i(),!n(c)||!n(J(c,3))&&!n(A(c,1)))&&(a=l("GENJITU_KAIRI_TO_SIDES")["$[]"](z(_,1)),h=n(i=l("REALITY_LINE_TO_TIMES")["$[]"](c))?i:1,n(a))?(k=(f=this.randomizer.$roll_barabara(h,a).$sort()).$max(),S=n(c)?"KR("+_+","+c+")":"KR("+_+")",y(h,1)?"("+S+") \uff1e "+k:"("+S+") \uff1e "+k+"["+f.$join(",")+"] \uff1e "+k):r}),x(s,"$roll_shusoku",function(u){try{p("eval_return");var e=r,t=r,_=r,i=r,c=r,a=r,h=r;return e=/^KRS(?:\((\d),([-+\d]+)\))$/.$match(u),!n(e)||(t=e["$[]"](1).$to_i(),_=n(i=e["$[]"](2))?l("Arithmetic").$eval(e["$[]"](2),this.round_type):i,c=l("GENJITU_KAIRI_TO_SIDES")["$[]"](z(t,1)),n(c["$nil?"]())||n(_["$nil?"]()))?r:(h=(a=this.randomizer.$roll_barabara(_,c)).$sum(),y(_,1)?"(KRS("+t+","+_+")) \uff1e "+h:"(KRS("+t+","+_+")) \uff1e "+h+"["+a.$join(",")+"] \uff1e "+h)}catch(f){if(f===o.t_eval_return)return f.$v;throw f}})})}}]);