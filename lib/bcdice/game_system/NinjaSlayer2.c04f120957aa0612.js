(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[1959],{5170:(re,$e,j)=>{j(5151),Opal.queue(function(a){var F,O,ee,E,o,r,k,A,Q,W,G=a.module,q=a.klass,f=a.const_set,m=a.eqeqeq,S=a.truthy,T=a.rb_gt,N=a.def,g=a.send,i=a.rb_plus,w=a.thrower,H=a.rb_minus,B=a.eqeq,Y=a.hash2,K=[],e=a.nil,D=a.$$$;return F=K,O=W=[G(K[0],"BCDice")].concat(F),A=[G(W[0],"GameSystem")].concat(O),Q=a.$r(A),ee=A,o=[E=q(A[0],Q("Base"),"NinjaSlayer2")].concat(ee),r=a.$r(o),(k=E.$$prototype).locale=k.randomizer=e,f(o[0],"ID","NinjaSlayer2"),f(o[0],"NAME","\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG 2\u7248"),f(o[0],"SORT_KEY","\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042TRPG2"),f(o[0],"HELP_MESSAGE","- K{x1},{x2},...,{xn}\n\u96e3\u6613\u5ea6K([K]ids)\u306e\u6210\u529f\u5224\u5b9a({x1}B6>=2)\u3092\u3001\u30c0\u30a4\u30b9{x1}\u500b({x2}\uff5e\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u306f\u305d\u308c\u305e\u308c\u500b\u3005\u306b)\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u5148\u982d\u306e\u6587\u5b57\u3092\u5909\u3048\u308b\u3053\u3068\u3067\u3001\u96e3\u6613\u5ea6E([E]asy),N([N]ormal),H([H]ard),U([U]ltra-hard)\u3082\u3057\u304f\u306fUH([U]ltra-[H]ard)\u3067\u3082\u5b9f\u884c\u53ef\u80fd\u3067\u3059\u3002(\u4ee5\u4e0b\u3082\u540c\u69d8)\n\n- K{x1},{x2},...,{xn}[>={y}]\nK{x1}\u306e\u30ed\u30fc\u30eb\u306e\u7d50\u679c\u3092\u4f7f\u3063\u3066\u3001[]\u5185\u3067\u6307\u5b9a\u3055\u308c\u305f\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30c0\u30a4\u30b9\u306e\u500b\u6570\u3092\u8ffd\u52a0\u3067\u51fa\u529b\u3057\u307e\u3059\u3002\n\u5224\u5b9a\u5f0f\u306f\u300c>=\u300d\u306e\u4ed6\u306b\u300c>\u300d\u300c<=\u300d\u300c<\u300d\u300c=\u300d\u300c!=\u300d\u304c\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002\n[=5][=6]\u306e\u3088\u3046\u306b\u8907\u6570\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u308c\u305e\u308c\u3067\u8ffd\u52a0\u5224\u5b9a\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n- K{x1},{x2},...,{xn}[S] or K{x1},{x2},...,{xn}[S{y}]\n- K{x1},{x2},...,{xn}[C] or K{x1},{x2},...,{xn}[C{y}]\n\u3044\u305a\u308c\u3082K{x1},{x2},...,{xn}[>={y}]\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3067\u3059\u3002({y}\u7701\u7565\u6642\u306f\u56fa\u5b9a\u50246\u3067\u51e6\u7406\u3057\u307e\u3059\u3002)\n\u51fa\u529b\u6642\u306e\u30c6\u30ad\u30b9\u30c8\u304c\u3001S\u306e\u5834\u5408\u306f\u300c\u30b5\u30c4\u30d0\u30c4\uff01\u300d\u306b\u3001C\u306e\u5834\u5408\u306f\u300c\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\uff01\u300d\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u3061\u3089\u3082\u8907\u6570\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u308c\u305e\u308c\u3067\u8ffd\u52a0\u5224\u5b9a\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n- SB or SB@{x}\n{x}(1-6/\u7701\u7565\u6642\u306fd6)\u306b\u5bfe\u5fdc\u3057\u305f\u30b5\u30c4\u30d0\u30c4([S]atz-[B]atz)\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u8868\u306e\u5185\u5bb9\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n- WS{x}\n{x}(1-12/\u7701\u7565\u4e0d\u53ef)\u306b\u5bfe\u5fdc\u3059\u308b[W]as[s]hoi!\u5224\u5b9a(2d6<={x})\u3092\u884c\u3044\u307e\u3059\n\n- WSE or WSE@{x}\n{x}(1-6/\u7701\u7565\u6642\u306fd6)\u306b\u5bfe\u5fdc\u3059\u308b\u6b7b\u795e\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u6c7a\u5b9a\u8868([W]as[s]hoi! [E]ntry)\u306e\u5185\u5bb9\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n- NRS_E{x} or NRS_E{x}@{y} or NRS@{y}\n\u30c0\u30a4\u30b9{x}\u500b\u3067\u96e3\u6613\u5ea6[E]asy(>=3)\u306eNRS\u5224\u5b9a({x}\u7701\u7565\u6642\u306f\u30b9\u30ad\u30c3\u30d7)\u3092\u884c\u3044\u3001\u5931\u6557\u3057\u305f\u5834\u5408\u306f{y}(1\uff5e7/\u7701\u7565\u6642\u306f\u96e3\u6613\u5ea6\u306b\u5fdc\u3058\u305f\u30c0\u30a4\u30b9\u76ee)\u306b\u5bfe\u5fdc\u3059\u308bNRS\u767a\u72c2\u8868\u3092\u8fd4\u3057\u307e\u3059\u3002\n\u300c_E\u300d\u90e8\u5206\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u3067\u3001\u96e3\u6613\u5ea6N,H,U,UH\u3067\u3082\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002(K\u306f\u3042\u308a\u307e\u305b\u3093)\n"),N(E,"$eval_game_system_specific_command",function(n){var s=this,$=e,t=e;s.$debug("input: "+n);try{return m(r("RE_JUDGE_DICEROLL"),n)?($=s.$proc_dice_2nd(r("Regexp").$last_match()),S(T($["$[]"](1),0))?r("Result").$success($["$[]"](0)):r("Result").$failure($["$[]"](0))):s.$proc_text(n)}catch(l){if(!a.rescue(l,[r("StandardError")]))throw l;t=l;try{return s.$debug(t.$message()+" \n"+t.$backtrace()),e}finally{a.pop_exception()}}}),E.$private(),N(E,"$s_to_i",function(n,s){return S(n["$nil?"]())?s:n.$to_i()}),N(E,"$check_difficulty",function(n,s,_,$){var c,t=e,l=e;return t=0,l=[],g(n,"each",[],function(h){return null==h&&(h=e),S(h.$send(r("Normalize").$comparison_operator(_),s))?(t=i(t,1),l.$push(h)):e}),c=S(l["$empty?"]())?"":"["+l.$sort().$reverse().$join(",")+"]",[$+":"+t+c,t]}),N(E,"$proc_dice_2nd",function(n){try{w("eval_return");var l,$=e,t=e,c=e;return $="",t=0,l=r("DIFFICULTY_SYMBOL_TO_INTEGER").$fetch(n["$[]"](1)),c=n["$[]"](3),g(n["$[]"](2).$split(","),"each",[],function R(h){var C,u=null==R.$$s?this:R.$$s,z=e,v=e,L=e;return null==u.randomizer&&(u.randomizer=e),null==h&&(h=e),C=h.$to_i()+"B6>="+l,z=D(D(r("BCDice"),"CommonCommand"),"BarabaraDice").$eval(C,u,u.randomizer),$=i($,"("+C+") \uff1e "+z.$last_dice_list().$join(",")+" \uff1e \u6210\u529f\u6570:"+z.$success_num()),v=z.$success_num(),S(c["$nil?"]())||(u.$debug("---- appendix: ["+c+"]"),L=c.$split("]["),g(L,"each",[],function J(y){var I,d=null==J.$$s?this:J.$$s,U=e;return null==y&&(y=e),d.$debug("----- ap_command: "+y),m(r("RE_COUNT_SATZ_BATZ"),I=y)?(U=d.$check_difficulty(z.$last_dice_list(),d.$s_to_i(r("Regexp").$last_match()["$[]"](1),6),">=","\u30b5\u30c4\u30d0\u30c4\uff01"),$=i($,", "+U["$[]"](0)),v=i(v,U["$[]"](1))):m(r("RE_COUNT_CRITICAL"),I)?(U=d.$check_difficulty(z.$last_dice_list(),d.$s_to_i(r("Regexp").$last_match()["$[]"](1),6),">=","\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\uff01"),$=i($,", "+U["$[]"](0)),v=i(v,U["$[]"](1))):m(r("RE_COUNT_JUDGE"),I)?(U=d.$check_difficulty(z.$last_dice_list(),r("Regexp").$last_match()["$[]"](2).$to_i(),r("Regexp").$last_match()["$[]"](1),"\u8ffd\u52a0\u5224\u5b9a"),$=i($,", "+U["$[]"](0)),v=i(v,U["$[]"](1))):e},{$$s:u})),$=i($," \n"),t=i(t,v)},{$$s:this}),[$,t]}catch(R){if(R===a.t_eval_return)return R.$v;throw R}}),N(E,"$proc_satz_batz",function(n){var s=this;return S(T(n,0))?"\u30b5\u30c4\u30d0\u30c4!!("+n+") \uff1e "+s.$translate("NinjaSlayer2.table.SATSUBATSU.items")["$[]"](H(n,1)):D(r("DiceTable"),"Table").$from_i18n("NinjaSlayer2.table.SATSUBATSU",s.locale).$roll(s.randomizer)}),N(E,"$proc_wasshoi",function(n){var _=e,$=e;return $="Wasshoi!\u5224\u5b9a(2D6) \uff1e ("+(_=this.randomizer.$roll_barabara(2,6)).$join("+")+") \uff1e "+_.$sum(),S(T(_.$sum(),n))?($=i($,"(>"+n+") \u5224\u5b9a\u5931\u6557"),r("Result").$success($)):($=i($,"(<="+n+") \u5224\u5b9a\u6210\u529f!! \n\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fc=\u30b5\u30f3\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u3060!!"),r("Result").$failure($))}),N(E,"$proc_wasshoi_entry",function(n){var s=this,_=e,$=e;return _="",S(T(n,0))?_=i(_,"\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fc=\u30b5\u30f3\u306e\u30a8\u30f3\u30c8\u30ea\u30fc!!("+n+") \uff1e "+s.$translate("NinjaSlayer2.table.WASSHOI.items")["$[]"](H(n,1))):($=D(r("DiceTable"),"Table").$from_i18n("NinjaSlayer2.table.WASSHOI",s.locale),_=i(_,$.$roll(s.randomizer).$to_s())),_}),N(E,"$proc_nrs",function(n,s,_){try{w("eval_return");var l,t=this,c=e,R=e,h=e,u=e,x=e;if(l=S(s["$nil?"]())?0:r("DIFFICULTY_SYMBOL_TO_INTEGER").$fetch(s),B(l,0)&&B(_,0))return e;if(c="",S(T(l,0))){if(R=n+"B6>="+l,h=D(D(r("BCDice"),"CommonCommand"),"BarabaraDice").$eval(R,t,t.randomizer),c=i(c,"NRS\u5224\u5b9a("+R+") \uff1e "+h.$last_dice_list().$join(",")+" \uff1e \u6210\u529f\u6570:"+h.$success_num()),S(T(h.$success_num(),0)))return c=i(c," NRS\u514b\u670d!!"),r("Result").$success(c);c=i(c," NRS\u767a\u75c7!! \n")}if(u=0,x=0,B(_,0)){switch(s.valueOf()){case"E":u=3;break;case"N":u=6;break;case"H":case"U":u=6,x=1}_=i(t.randomizer.$roll_once(u),x)}return R="1D"+u+(S(T(x,0))?i("+",x.$to_s()):""),c=i(c,"NRS\u767a\u72c2"+(S(T(u,0))?"("+R+") \uff1e ":"")+"("+_+") \uff1e "+t.$translate("NinjaSlayer2.table.NRS.items")["$[]"](H(_,1))),r("Result").$failure(c)}catch(C){if(C===a.t_eval_return)return C.$v;throw C}}),N(E,"$proc_text",function(n){var _,s=this;return s.$debug("text: "+n),m(r("RE_JUDGE_SATZ_BATZ"),_=n)?s.$proc_satz_batz(r("Regexp").$last_match()["$[]"](1).$to_i()):m(r("RE_JUDGE_WASSHOI"),_)?s.$proc_wasshoi(r("Regexp").$last_match()["$[]"](1).$to_i()):m(r("RE_JUDGE_WASSHOI_ENTRY"),_)?s.$proc_wasshoi_entry(r("Regexp").$last_match()["$[]"](1).$to_i()):m(r("RE_JUDGE_NRS"),_)?s.$proc_nrs(r("Regexp").$last_match()["$[]"](2).$to_i(),r("Regexp").$last_match()["$[]"](1),r("Regexp").$last_match()["$[]"](3).$to_i()):e}),f(o[0],"RE_COUNT_SATZ_BATZ",/S([1-6])?/i.$freeze()),f(o[0],"RE_COUNT_CRITICAL",/C([1-6])?/i.$freeze()),f(o[0],"RE_COUNT_JUDGE",/(=|!=|>=|>|<=|<)([1-6])/.$freeze()),f(o[0],"RE_JUDGE_DICEROLL",/^(UH|[KENHU])([\d,]+)(?:\[((?:(?:S([1-6])?|C([1-6])?|(=|!=|>=|>|<=|<)([1-6]))(?:\]\[)?)+)\])?$/i.$freeze()),f(o[0],"RE_JUDGE_SATZ_BATZ",/^SB(?:@([1-6]))?$/i.$freeze()),f(o[0],"RE_JUDGE_WASSHOI",/^WS([1-9]|10|11|12)$/i.$freeze()),f(o[0],"RE_JUDGE_WASSHOI_ENTRY",/^WSE(?:@([1-6]))?$/i.$freeze()),f(o[0],"RE_JUDGE_NRS",/^NRS(?:_(E|N|H|U|UH)(\d+))?(?:@([1-7]))?$/i.$freeze()),f(o[0],"DIFFICULTY_SYMBOL_TO_INTEGER",Y(["K","E","N","H","U","UH"],{K:2,E:3,N:4,H:5,U:6,UH:6}).$freeze()),E.$register_prefix("UH","[KENHU]","SB","WS","WSE","NRS")})}}]);