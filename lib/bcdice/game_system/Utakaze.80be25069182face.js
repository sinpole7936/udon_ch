(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7738],{733:(Y,F,x)=>{x(5151),Opal.queue(function(_){var I,G,T,f,m,d,v,w,j,U=_.module,y=_.klass,D=_.const_set,i=_.truthy,g=_.def,N=_.hash,k=_.rb_lt,b=_.rb_gt,C=_.to_ary,q=_.eqeq,R=_.rb_ge,K=_.rb_plus,p=_.send,z=_.rb_le,S=_.rb_times,E=[],e=_.nil;return I=E,G=j=[U(E[0],"BCDice")].concat(I),v=[U(j[0],"GameSystem")].concat(G),w=_.$r(v),T=v,m=[f=y(v[0],w("Base"),"Utakaze")].concat(T),d=_.$r(m),f.$$prototype.randomizer=e,D(m[0],"ID","Utakaze"),D(m[0],"NAME","\u30a6\u30bf\u30ab\u30bc"),D(m[0],"SORT_KEY","\u3046\u305f\u304b\u305b"),D(m[0],"HELP_MESSAGE","\u30fb\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\uff08nUK\uff09\n  n\u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3067\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\u3002\u30be\u30ed\u76ee\u306e\u6700\u5927\u500b\u6570\u3092\u6210\u529f\u30ec\u30d9\u30eb\u3068\u3057\u3066\u8868\u793a\u3002n\u3092\u7701\u7565\u3059\u308b\u30682UK\u6271\u3044\u3002\n  \u4f8b\uff093UK \uff1a\u30b5\u30a4\u30b3\u30ed3\u500b\u3067\u884c\u70ba\u5224\u5b9a\n  \u4f8b\uff09UK  \uff1a\u30b5\u30a4\u30b3\u30ed2\u500b\u3067\u884c\u70ba\u5224\u5b9a\n\u30fb\u96e3\u6613\u5ea6\u4ed8\u304d\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\uff08nUK>=t\uff09\n  t\u306b\u96e3\u6613\u5ea6\u3092\u6307\u5b9a\u3057\u305f\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\u3002\n  \u6210\u529f\u30ec\u30d9\u30eb\u3068\u96e3\u6613\u5ea6t\u3092\u6bd4\u3079\u3066\u6210\u5426\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002\n  \u4f8b\uff096UK>=3 \uff1a\u30b5\u30a4\u30b3\u30ed6\u500b\u3067\u884c\u70ba\u5224\u5b9a\u3057\u3066\u3001\u6210\u529f\u30ec\u30d9\u30eb3\u304c\u51fa\u308c\u3070\u6210\u529f\u3002\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\u4ed8\u304d\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\uff08nUK@c or nUKc\uff09\n  c\u306b\u300c\u9f8d\u306e\u30c0\u30a4\u30b9\u76ee\u300d\u3092\u6307\u5b9a\u3057\u305f\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\u3002\n  \u30be\u30ed\u76ee\u3067\u306f\u306a\u304f\u3001c\u3068\u540c\u3058\u5024\u306e\u51fa\u76ee\u6570x2\u304c\u6210\u529f\u30ec\u30d9\u30eb\u3068\u306a\u308a\u307e\u3059\u3002\u96e3\u6613\u5ea6\u306e\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3002\n  \u4f8b\uff093UK@5 \uff1a\u9f8d\u306e\u30c0\u30a4\u30b9\u300c\u6708\u300d\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\u5ba3\u8a00\u3057\u305f\u30b5\u30a4\u30b3\u30ed3\u500b\u306e\u884c\u70ba\u5224\u5b9a\n \u30fb\u5bfe\u6297\u5224\u5b9a\u30ed\u30fc\u30eb(nUR[@c], nUO[@c]) n:\u30c0\u30a4\u30b9\u6570 c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\n \u3000\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u30ed\u30fc\u30eb\u3059\u308b\u304c\u3001\u6700\u671f\u306b\u6210\u529f\u30ec\u30d9\u30eb\u3068\u30bb\u30c3\u30c8\u6570\u304b\u3089\u6c42\u3081\u305f\u30de\u30b8\u30c3\u30af\u30ca\u30f3\u30d0\u30fc\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n \u3000\u30de\u30b8\u30c3\u30af\u30ca\u30f3\u30d0\u30fc\u306e\u5927\u304d\u3044\u3082\u306e\u304c\u6210\u529f\u3001\u540c\u5024\u306f\u5f15\u304d\u5206\u3051\u3002\n \u3000\u30c0\u30a4\u30b9\u306f18\u500b\u307e\u3067\u5bfe\u5fdc\u3002\n"),f.$register_prefix("\\d*U[KRO]"),g(f,"$eval_game_system_specific_command",function(n){var $,s=this;return s.$debug("eval_game_system_specific_command command",n),i($=s.$check_roll(n))?$:s.$opposed_roll(n)}),f.$private(),D(m[0],"DRAGON_DICE_NAME",N(1,"\u98a8",2,"\u96e8",3,"\u96f2",4,"\u5f71",5,"\u6708",6,"\u6b4c").$freeze()),g(f,"$check_roll",function(n){var s=this,$=e,t=e,u=e,r=e,l=e,a=e,o=e,c=e;return $=/^(\d+)?UK(@?(\d))?(>=(\d+))?$/i.$match(n),!i($)||(t=(i(u=$["$[]"](1))?u:2).$to_i(),r=$["$[]"](3).$to_i(),l=$["$[]"](5).$to_i(),t=s.$getValue(t),r=s.$getValue(r),i(k(t,1)))?e:(i(b(r,6))&&(r=6),a=s.randomizer.$roll_barabara(t,6).$sort(),o=s.$get_roll_result(a,r,l),c=[n,"("+t+"D6)","["+a.$join(",")+"]",o.$text()],o["$text="](c.$join(" \uff1e ")),o)}),g(f,"$get_roll_result",function(n,s,$){var t,u,l,a,o,c=e;return u=this.$getSuccessInfo(n,s),l=null==(t=C(u))[0]?e:t[0],a=null==t[1]?e:t[1],o=null==t[2]?e:t[2],c=[],i(this.$isDragonDice(s))&&c.$push("\u9f8d\u306e\u30c0\u30a4\u30b9\u300c"+d("DRAGON_DICE_NAME")["$[]"](s)+"\u300d("+s+")\u3092\u4f7f\u7528"),i(l)?(c.$push("\u6210\u529f\u30ec\u30d9\u30eb:"+a+" ("+o+"\u30bb\u30c3\u30c8)"),q($,0)?d("Result").$success(c.$join(" \uff1e ")):i(R(a,$))?(c.$push("\u6210\u529f"),d("Result").$success(c.$join(" \uff1e "))):(c.$push("\u5931\u6557"),d("Result").$failure(c.$join(" \uff1e ")))):(c.$push("\u5931\u6557"),d("Result").$failure(c.$join(" \uff1e ")))}),g(f,"$opposed_roll",function(n){var s=this,$=e,t=e,u=e,r=e,l=e,a=e,o=e;return $=/^(\d+)?U[R|O](@?(\d))?$/i.$match(n),!i($)||(t=(i(u=$["$[]"](1))?u:2).$to_i(),r=$["$[]"](3).$to_i(),t=s.$getValue(t),r=s.$getValue(r),i(k(t,1))||i(b(t,18)))?e:(i(b(r,6))&&(r=6),l=s.randomizer.$roll_barabara(t,6).$sort(),a=s.$get_opposed_roll_result(l,r),o=[n,"("+t+"D6)","["+l.$join(",")+"]",a.$text()],a["$text="](o.$join(" \uff1e ")),a)}),g(f,"$get_opposed_roll_result",function(n,s){var $,t,r,l,a,u=this,o=e;return t=u.$getSuccessInfo(n,s),r=null==($=C(t))[0]?e:$[0],l=null==$[1]?e:$[1],a=null==$[2]?e:$[2],o=[],i(u.$isDragonDice(s))&&o.$push("\u9f8d\u306e\u30c0\u30a4\u30b9\u300c"+d("DRAGON_DICE_NAME")["$[]"](s)+"\u300d("+s+")\u3092\u4f7f\u7528"),i(r)?(o.$push("\u6210\u529f\u30ec\u30d9\u30eb:"+l+" ("+a+"\u30bb\u30c3\u30c8)"),o.$push(K(K("(",u.$format("%#02d%#1d",l,a)),")")),d("Result").$success(o.$join(" \uff1e "))):(o.$push("(000)"),d("Result").$failure(o.$join(" \uff1e ")))}),g(f,"$getSuccessInfo",function(n,s){var t,l,$=this,u=e,r=e;return $.$debug("checkSuccess diceList, crit",n,s),t=$.$getDiceCountHash(n,s),$.$debug("diceCountHash",t),u=0,r=[],l=i($.$isDragonDice(s))?1:2,p(t,"each",[],function(o,c){return null==o&&(o=e),null==c&&(c=e),i(b(c,u))&&(u=c),i(R(c,l))?r["$<<"](o):e}),$.$debug("successDiceList",r),i(z(r.$size(),0))?[!1,0,0]:(i($.$isDragonDice(s))&&(u=S(u,2)),[!0,u,r.$size()])}),g(f,"$getDiceCountHash",function(n,s){return p(p(p(n,"select",[],function t(u){var l;return null==u&&(u=e),i(l=(null==t.$$s?this:t.$$s).$isNomalDice(s))?l:u["$=="](s)},{$$s:this}),"group_by",[],"itself".$to_proc()),"transform_values",[],"size".$to_proc())}),g(f,"$isNomalDice",function(n){return this.$isDragonDice(n)["$!"]()}),g(f,"$isDragonDice",function(n){return n["$!="](0)}),g(f,"$getValue",function(n){return i(b(n,100))?0:n})})}}]);