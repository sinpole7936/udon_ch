(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[2205],{7408:(ge,ye,he)=>{he(5151),Opal.modules["i18n/backend/fallbacks"]=function(e){var B,i,t,c,a,m,G=e.module,M=e.class_variable_set,_=e.truthy,A=e.class_variable_get,E=e.def,q=e.send,F=e.send2,R=e.find_super,w=e.hash2,N=e.find_block_super,H=e.neqeq,j=e.thrower,z=e.return_val,U=[],L=e.nil,x=e.$$$;return B=U,m=[a=G(U[0],"I18n")].concat(B),M(m[0],"@@fallbacks",L),i=e.get_singleton_class(a),t=[i].concat(m),c=e.$r(t),E(i,"$fallbacks",function(){var T=L;return M(t[1],"@@fallbacks",_(null!=t[1].$$cvars["@@fallbacks"]?"class variable":L)&&_(T=A(t[1],"@@fallbacks",!1))?T:x(x(c("I18n"),"Locale"),"Fallbacks").$new()),_(T=c("Thread").$current()["$[]"]("i18n_fallbacks"))?T:A(t[1],"@@fallbacks",!1)}),E(i,"$fallbacks=",function(C){var T;return M(t[1],"@@fallbacks",_(C["$is_a?"](c("Array")))?x(x(c("I18n"),"Locale"),"Fallbacks").$new(C):C),T=["i18n_fallbacks",A(t[1],"@@fallbacks",!1)],q(c("Thread").$current(),"[]=",T),T[T.length-1]}),function(i,D){var C,T,I,y,c=[G(i,"Backend")].concat(D);return C=c,I=[T=G(c[0],"Fallbacks")].concat(C),y=e.$r(I),E(T,"$translate",function g(o,v,s){try{var f=j("return"),u=g.$$p||L,k=this,P=L,l=L;return g.$$p=null,null==s&&(s=y("EMPTY_HASH")),_(s.$fetch("fallback",!0))?_(s["$[]"]("fallback_in_progress"))?F(k,R(k,"translate",g,!1,!0),"translate",[o,v,s],u):(_(s["$[]"]("default"))&&(P=k["$extract_non_symbol_default!"](s)),l=s.$merge(w(["fallback_in_progress"],{fallback_in_progress:!0})),q(y("I18n").$fallbacks()["$[]"](o),"each",[],function r(p){var n=null==r.$$s?this:r.$$s;null==p&&(p=L);try{return q(n,"catch",["exception"],function d(){var $=null==d.$$s?this:d.$$s,Y=L;if(Y=F($,N($,"translate",d.$$def||r.$$def||g,!1,!1),"translate",[p,v,l],null),_(Y["$nil?"]()))return L;H(o.$to_s(),p.$to_s())&&$.$on_fallback(o,p,v,s),f.$throw(Y)},{$$s:n,$$ret:f})}catch(d){if(!e.rescue(d,[x(y("I18n"),"InvalidLocale")]))throw d;try{return L}finally{e.pop_exception()}}},{$$s:k}),_(s["$key?"]("default"))&&_(s["$[]"]("default")["$nil?"]())?L:_(P)?F(k,R(k,"translate",g,!1,!0),"translate",[o,L,s.$merge(w(["default"],{default:P}))],null):k.$throw("exception",x(y("I18n"),"MissingTranslation").$new(o,v,s))):F(k,R(k,"translate",g,!1,!0),"translate",[o,v,s],u)}catch(r){if(r===f)return r.$v;throw r}},-3),E(T,"$extract_non_symbol_default!",function(o){var s,v=L;return v=[o["$[]"]("default")].$flatten(),s=q(v,"detect",[],function(u){return null==u&&(u=L),u["$is_a?"](y("Symbol"))["$!"]()}),_(s)&&o["$[]="]("default",v["$[]"](0,v.$index(s))),s}),E(T,"$exists?",function g(o,v,s){try{var f=j("return"),u=g.$$p||L,k=this;return g.$$p=null,null==s&&(s=y("EMPTY_HASH")),_(s.$fetch("fallback",!0))?(q(y("I18n").$fallbacks()["$[]"](o),"each",[],function P(l){var r=null==P.$$s?this:P.$$s;null==l&&(l=L);try{if(!_(F(r,N(r,"exists?",P.$$def||g,!1,!1),"exists?",[l,v],null)))return L;f.$throw(!0)}catch(p){if(!e.rescue(p,[x(y("I18n"),"InvalidLocale")]))throw p;try{return L}finally{e.pop_exception()}}},{$$s:k,$$ret:f}),!1):F(k,R(k,"exists?",g,!1,!0),"exists?",[o,v,s],u)}catch(P){if(P===f)return P.$v;throw P}},-3),T.$private(),E(T,"$on_fallback",z(L))}(m[0],m)},Opal.modules["bcdice/randomizer"]=function(e){var a,b,C,T,I,y,i,D,M=e.klass,_=e.const_set,A=e.def,E=e.truthy,q=e.rb_gt,F=e.rb_plus,R=e.rb_le,w=e.send,N=e.rb_minus,H=e.eqeq,j=e.rb_times,z=e.eqeqeq,U=e.rb_ge,L=[],x=e.nil,W=e.$$$;return a=L,i=[(0,e.module)(L[0],"BCDice")].concat(a),D=e.$r(i),b=i,T=[C=M(i[0],null,"Randomizer")].concat(b),I=e.$r(T),(y=C.$$prototype).rand_results=y.detailed_rand_results=x,_(T[0],"UPPER_LIMIT_DICE_TIMES",200),_(T[0],"UPPER_LIMIT_DICE_SIDES",1e4),_(T[0],"UPPER_LIMIT_RANDS",1e4),A(C,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),C.$attr_reader("rand_results"),C.$attr_reader("detailed_rand_results"),_(T[0],"DetailedRandResult",I("Struct").$new("kind","sides","value")),A(C,"$roll_barabara",function(o,v){var s=this;return E(q(F(s.rand_results.$size(),o),I("UPPER_LIMIT_RANDS")))&&s.$raise(I("TooManyRandsError")),E(R(o,0))||E(q(o,I("UPPER_LIMIT_DICE_TIMES")))?[]:w(I("Array"),"new",[o],function f(){return(null==f.$$s?this:f.$$s).$roll_once(v)},{$$s:s})}),A(C,"$roll_sum",function(o,v){return this.$roll_barabara(o,v).$sum()}),A(C,"$roll_once",function(o){var s=x;return E(R(o,0))||E(q(o,I("UPPER_LIMIT_DICE_SIDES")))?0:(s=this.$rand_inner(o),this.$push_to_detail("normal",o,s),s)}),A(C,"$roll_index",function(o){return N(this.$roll_once(o),1)}),A(C,"$roll_tens_d10",function(){var s,v=x;return v=this.$rand_inner(10),H(v,10)&&(v=0),s=j(v,10),this.$push_to_detail("tens_d10",10,s),s}),A(C,"$roll_d9",function(){var v;return v=N(this.$rand_inner(10),1),this.$push_to_detail("d9",10,v),v}),A(C,"$roll_d66",function(o){var f,s=x;return s=w(I("Array"),"new",[2],function u(){return(null==u.$$s?this:u.$$s).$roll_once(6)},{$$s:this}),z(W(I("D66SortType"),"ASC"),f=o)?s["$sort!"]():z(W(I("D66SortType"),"DESC"),f)&&s["$sort!"]()["$reverse!"](),F(j(s["$[]"](0),10),s["$[]"](1))}),C.$private(),A(C,"$rand_inner",function(o){var s,v=this;return E(U(v.rand_results.$size(),I("UPPER_LIMIT_RANDS")))&&v.$raise(I("TooManyRandsError")),s=v.$random(o),v.rand_results["$<<"]([s,o]),s}),A(C,"$random",function(o){return F(I("Kernel").$rand(o),1)}),A(C,"$push_to_detail",function(o,v,s){var u;return u=I("DetailedRandResult").$new(o,v,s),this.detailed_rand_results.$push(u)}),M(i[0],D("StandardError"),"TooManyRandsError"),x},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var w,z,B,a,m,i,D,L,H,G=e.module,M=e.klass,_=e.def,A=e.truthy,E=e.return_val,q=[],F=e.nil;return w=q,z=H=[G(q[0],"BCDice")].concat(w),B=L=[G(H[0],"DiceTable")].concat(z),m=[a=M(L[0],null,"RollResult")].concat(B),i=e.$r(m),(D=a.$$prototype).table_name=D.value=D.body=F,_(a,"$initialize",function(c,b,C){var T=this;return T.table_name=c,T.value=b,T.body=C}),a.$attr_reader("table_name"),a.$attr_reader("value"),a.$attr_reader("body"),_(a,"$to_s",function(){var c=this;return c.table_name+"("+c.value+") \uff1e "+c.body}),_(a,"$last_body",function(){var c=this;return A(c.body["$is_a?"](i("RollResult")))?c.body.$last_body():c.body}),_(a,"$empty?",E(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var w,z,B,a,m,i,D,L,H,G=e.module,M=e.klass,_=e.truthy,A=e.def,E=e.rb_minus,q=[],F=e.nil;return w=q,z=H=[G(q[0],"BCDice")].concat(w),B=L=[G(H[0],"DiceTable")].concat(z),m=[a=M(L[0],null,"ChainTable")].concat(B),i=e.$r(m),(D=a.$$prototype).times=D.sides=D.items=D.name=F,A(a,"$initialize",function(c,b,C){var T=this,I=F;return T.name=c,T.items=C.$freeze(),I=/(\d+)D(\d+)/i.$match(b),_(I)||T.$raise(i("ArgumentError"),"Unexpected table type: "+b),T.times=I["$[]"](1).$to_i(),T.sides=I["$[]"](2).$to_i()}),A(a,"$roll",function(c){var C,T,b=this,I=F;return C=c.$roll_sum(b.times,b.sides),T=E(C,b.times),I=b.items["$[]"](T),_(I["$respond_to?"]("roll"))&&(I=I.$roll(c)),i("RollResult").$new(b.name,C,I)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var j,x,i,D,t,c,b,B,U,G=e.module,M=e.klass,_=e.hash2,A=e.defs,E=e.def,q=e.rb_plus,F=e.rb_times,R=e.rb_minus,w=[],N=e.nil;return j=w,x=U=[G(w[0],"BCDice")].concat(j),i=B=[G(U[0],"DiceTable")].concat(x),t=[D=M(B[0],null,"D66GridTable")].concat(i),c=e.$r(t),(b=D.$$prototype).name=b.items=N,A(D,"$from_i18n",function(T,I){var g=N;return g=c("I18n").$t(T,_(["locale","raise"],{locale:I,raise:!0})),this.$new(g["$[]"]("name"),g["$[]"]("items"))}),E(D,"$initialize",function(T,I){return this.name=T,this.items=I.$freeze()}),E(D,"$roll",function(T){var y,g,o,v,s;return y=T.$roll_once(6),g=T.$roll_once(6),o=q(F(y,10),g),v=R(y,1),s=R(g,1),c("RollResult").$new(this.name,o,this.items["$[]"](v)["$[]"](s))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var N,U,m,i,D,t,x,W,j,G=e.module,M=e.klass,_=e.hash2,A=e.defs,E=e.def,F=[],R=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),N=F,U=j=[G(F[0],"BCDice")].concat(N),x=[G(j[0],"DiceTable")].concat(U),W=e.$r(x),m=x,D=[i=M(x[0],W("D66GridTable"),"D66HalfGridTable")].concat(m),t=e.$r(D),A(i,"$from_i18n",function(b,C){var I=R;return I=t("I18n").$t(b,_(["locale","raise"],{locale:C,raise:!0})),this.$new(I["$[]"]("name"),I["$[]"]("items_1_2_3"),I["$[]"]("items_4_5_6"))}),E(i,"$initialize",function(b,C,T){return this.name=b,this.items=[C,C,C,T,T,T].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var N,U,m,i,D,t,x,W,j,G=e.module,M=e.klass,_=e.hash2,A=e.defs,E=e.def,F=[],R=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),N=F,U=j=[G(F[0],"BCDice")].concat(N),x=[G(j[0],"DiceTable")].concat(U),W=e.$r(x),m=x,D=[i=M(x[0],W("D66GridTable"),"D66OneThirdTable")].concat(m),t=e.$r(D),A(i,"$from_i18n",function(b,C){var I=R;return I=t("I18n").$t(b,_(["locale","raise"],{locale:C,raise:!0})),this.$new(I["$[]"]("name"),I["$[]"]("items_1_2"),I["$[]"]("items_3_4"),I["$[]"]("items_5_6"))}),E(i,"$initialize",function(b,C,T,I){return this.name=b,this.items=[C,C,T,T,I,I].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var U,B,t,c,b,C,T,m,x,G=e.module,M=e.klass,_=e.hash2,A=e.defs,E=e.def,q=e.eqeqeq,F=e.rb_plus,R=e.rb_times,w=e.truthy,N=[],H=e.nil,j=e.$$$;return U=N,B=x=[G(N[0],"BCDice")].concat(U),t=m=[G(x[0],"DiceTable")].concat(B),b=[c=M(m[0],null,"D66Table")].concat(t),C=e.$r(b),(T=c.$$prototype).sort_type=T.items=T.name=H,A(c,"$from_i18n",function(y,g){var s,v=H;return v=C("I18n").$t(y,_(["locale"],{locale:g})),s=C("D66SortType").$const_get(v["$[]"]("d66_sort_type")),this.$new(v["$[]"]("name"),s,v["$[]"]("items"))}),E(c,"$initialize",function(y,g,o){var v=this;return v.name=y,v.sort_type=g,v.items=o.$freeze()}),E(c,"$roll",function(y){var g=this,o=H,v=H,s=H,f=H;return o=y.$roll_barabara(2,6),q(j(C("D66SortType"),"ASC"),v=g.sort_type)?o["$sort!"]():q(j(C("D66SortType"),"DESC"),v)&&o["$sort!"]()["$reverse!"](),s=F(R(o["$[]"](0),10),o["$[]"](1)),f=w(v=g.items["$[]"](s))?v:g.items["$[]"](s.$to_s()),w(f["$respond_to?"]("roll"))&&(f=f.$roll(y)),C("RollResult").$new(g.name,s,f)}),E(c,"$choice",function(y){return C("RollResult").$new(this.name,y,this.items["$[]"](y))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var L,a,i,D,W,G=e.module,M=e.klass,_=e.hash2,A=e.send,E=e.to_ary,q=e.rb_plus,F=e.rb_times,R=e.send2,w=e.find_super,N=e.def,j=[],z=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),L=j,a=W=[G(j[0],"BCDice")].concat(L),i=[G(W[0],"DiceTable")].concat(a),D=e.$r(i),N(M(i[0],D("D66Table"),"D66LeftRangeTable"),"$initialize",function C(T,I,y){var v;return C.$$p=null,v=_([],{}),A(y,"each",[],function(f){var u,l;return null==f&&(f=z),u=E(f),l=null==u[1]?z:u[1],A(null==u[0]?z:u[0],"each",[],function(p){return null==p&&(p=z),A(l,"each_with_index",[],function(d,$){var Y,Q;return null==d&&(d=z),null==$&&($=z),Q=q(F(p,10),q($,1)),A(v,"[]=",Y=[Q,d]),Y[Y.length-1]})})}),R(this,w(this,"initialize",C,!1,!0),"initialize",[T,I,v],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var z,W,D,t,c,b,C,a,L,G=e.module,M=e.klass,_=e.hash2,A=e.defs,E=e.def,q=e.truthy,F=e.rb_minus,R=e.rb_plus,w=e.rb_times,N=[],H=e.nil;return z=N,W=L=[G(N[0],"BCDice")].concat(z),D=a=[G(L[0],"DiceTable")].concat(W),c=[t=M(a[0],null,"D66ParityTable")].concat(D),b=e.$r(c),(C=t.$$prototype).odd=C.even=C.name=H,A(t,"$from_i18n",function(I,y){var o=H;return o=b("I18n").$t(I,_(["locale","raise"],{locale:y,raise:!0})),this.$new(o["$[]"]("name"),o["$[]"]("odd"),o["$[]"]("even"))}),E(t,"$initialize",function(I,y,g){var o=this;return o.name=I,o.odd=y.$freeze(),o.even=g.$freeze()}),E(t,"$roll",function(I){var o,s,f,y=this,g=H;return g=I.$roll_once(6),o=I.$roll_once(6),s=(q(g["$odd?"]())?y.odd:y.even)["$[]"](F(o,1)),f=R(w(g,10),o),b("RollResult").$new(y.name,f,s)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var N,U,a,m,i,D,t,x,j,G=e.module,M=e.klass,_=e.def,A=e.rb_plus,E=e.rb_times,q=e.send,F=[],R=e.nil;return N=F,U=j=[G(F[0],"BCDice")].concat(N),a=x=[G(j[0],"DiceTable")].concat(U),i=[m=M(x[0],null,"D66RangeTable")].concat(a),D=e.$r(i),(t=m.$$prototype).items=t.name=R,_(m,"$initialize",function(b,C){return this.name=b,this.items=C.$freeze()}),_(m,"$roll",function(b){var T,I,y,g=R;return T=b.$roll_once(6),I=b.$roll_once(6),y=A(E(T,10),I),g=q(this.items,"find",[],function(v){return null==v&&(v=R),v["$[]"](0)["$include?"](y)}),D("RollResult").$new(this.name,y,g["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var L,a,c,y,o,v,b,C,T,I,i,W,G=e.module,M=e.klass,_=e.const_set,A=e.send,E=e.hash2,q=e.def,F=e.eqeqeq,R=e.truthy,w=e.to_a,N=e.rb_times,H=e.rb_plus,j=[],z=e.nil;return L=j,a=W=[G(j[0],"BCDice")].concat(L),c=i=[G(W[0],"DiceTable")].concat(a),C=[b=M(i[0],null,"RangeTable")].concat(c),T=e.$r(C),(I=b.$$prototype).name=I.items=I.num_of_dice=I.num_of_sides=I.formatter=z,_(C[0],"RollResult",A(T("Struct"),"new",["sum","values","content","formatted"],function y(){return(null==y.$$s?this:y.$$s).$alias_method("to_s","formatted")},{$$s:b})),_(C[0],"Item",T("Struct").$new("range","content")),_(C[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),_(C[0],"DEFAULT_FORMATTER",A(b,"lambda",[],function(g,o){return null==g&&(g=z),null==o&&(o=z),g.$name()+"("+o.$sum()+") \uff1e "+o.$content()})),b.$attr_reader("name"),b.$attr_reader("num_of_dice"),b.$attr_reader("num_of_sides"),o=[y=e.get_singleton_class(b)].concat(C),v=e.$r(o),q(y,"$from_i18n",function(f,u){var l,P=z;return P=v("I18n").$t(f,E(["locale"],{locale:u})),l=A(P["$[]"]("items"),"map",[],function r(p){return null==p&&(p=z),[(null==r.$$s?this:r.$$s).$conv_string_range(p["$[]"](0)),p["$[]"](1)]},{$$s:this}),this.$new(P["$[]"]("name"),P["$[]"]("type"),l)}),q(y,"$conv_string_range",function(f){var k,u=this;return null==u.name&&(u.name=z),F(v("Integer"),k=f)?f:F(v("String"),k)?R(f["$include?"](".."))?A(v("Range"),"new",w(A(f.$split("..",2),"map",[],function P(l){return null==l&&(l=z),(null==P.$$s?this:P.$$s).$Integer(l)},{$$s:u}))):u.$Integer(f):u.$raise(v("TypeError"),u.name+": "+f+" ("+f.$class()+") must be a String or an Integer")}),q(b,"$initialize",function y(g,o,v){var u,s=y.$$p||z,f=this,k=z;return y.$$p=null,f.name=g.$freeze(),f.formatter=R(u=s)?u:T("DEFAULT_FORMATTER"),k=T("DICE_ROLL_METHOD_RE").$match(o),R(k)||f.$raise(T("ArgumentError"),f.name+": invalid dice roll method: "+o),f.num_of_dice=k["$[]"](1).$to_i(),f.num_of_sides=k["$[]"](2).$to_i(),f.$store(v)}),q(b,"$fetch",function(g){var v,o=this;return v=A(o.items,"find",[],function(f){return null==f&&(f=z),f.$range()["$include?"](g)}),R(v)||o.$raise(T("RangeError"),o.name+": value is out of range: "+g),v}),q(b,"$roll",function(g){var s,o=this,v=z,f=z;return s=(v=g.$roll_barabara(o.num_of_dice,o.num_of_sides)).$sum(),(f=T("RollResult").$new(s,v,o.$fetch(s).$content()))["$formatted="](o.formatter["$[]"](o,f)),f}),b.$private(),q(b,"$store",function(g){var v,s,o=this;return v=A(g,"map",[],function f(u,k){return null==u&&(u=z),null==k&&(k=z),[(null==f.$$s?this:f.$$s).$coerce_to_int_range(u),k]},{$$s:o}),s=A(v,"sort_by",[],function(u,k){return null==u&&(u=z),null==k&&(k=z),u.$min()}),o.$assert_min_sum_is_covered(s),o.$assert_max_sum_is_covered(s),o.$assert_no_gap_or_overlap_in_ranges(s),o.items=A(s,"map",[],function(u,k){return null==u&&(u=z),null==k&&(k=z),T("Item").$new(u,k.$freeze()).$freeze()}).$freeze(),o}),q(b,"$coerce_to_int_range",function(g){var v;return F(T("Integer"),v=g)?T("Range").$new(g,g):F(T("Range"),v)&&R(g.$begin()["$is_a?"](T("Integer")))&&R(g.$end()["$is_a?"](T("Integer")))?g:this.$raise(T("TypeError"),this.name+": "+g+" ("+g.$class()+") must be an Integer or a Range with Integers ")}),q(b,"$assert_min_sum_is_covered",function(g){var v,o=this,s=z;return v=o.num_of_dice,s=g.$first()["$[]"](0),R(s["$include?"](v))||o.$raise(T("RangeError"),o.name+": min value ("+v+") is not covered: "+s),o}),q(b,"$assert_max_sum_is_covered",function(g){var v,o=this,s=z;return v=N(o.num_of_dice,o.num_of_sides),s=g.$last()["$[]"](0),R(s["$include?"](v))||o.$raise(T("RangeError"),o.name+": max value ("+v+") is not covered: "+s),o}),q(b,"$assert_no_gap_or_overlap_in_ranges",function(g){return A(g,"each_cons",[2],function v(s,f){var l,r,u=null==v.$$s?this:v.$$s,k=z,P=z;return null==u.name&&(u.name=z),null==s&&(s=z),null==f&&(f=z),k=s["$[]"](0),P=f["$[]"](0),l=k.$max(),r=H(l,1),R(P["$include?"](l))&&u.$raise(T("RangeError"),u.name+": Range overlap: "+k+" and "+P),R(P["$include?"](r))?z:u.$raise(T("RangeError"),u.name+": Range gap: "+k+" and "+P)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var H,L,m,b,C,T,I,D,W,z,G=e.module,M=e.klass,_=e.send,A=e.def,E=e.rb_minus,q=e.return_ivar,F=[],R=e.nil,w=e.$$$;return H=F,L=z=[G(F[0],"BCDice")].concat(H),m=W=[G(z[0],"DiceTable")].concat(L),b=D=[M(W[0],null,"SaiFicSkillTable")].concat(m),T=[C=M(D[0],null,"Category")].concat(b),I=e.$r(T),A(C,"$initialize",function(g,o,v,s){var f=this;return f.name=g,f.skills=_(o.$map(),"with_index",[2],function(k,P){return null==k&&(k=R),null==P&&(P=R),w(I("SaiFicSkillTable"),"Skill").$new(g,k,v,P,s)}),f.dice=v}),A(C,"$roll",function(g){return this.$skills()["$[]"](E(g.$roll_sum(2,6),2))}),A(C,"$to_s",q("name")),C.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var R,j,W,D,t,a,U,N,G=e.module,M=e.klass,_=e.def,A=e.hash2,E=[],q=e.nil;return R=E,j=N=[G(E[0],"BCDice")].concat(R),W=U=[G(N[0],"DiceTable")].concat(j),a=[M(U[0],null,"SaiFicSkillTable")].concat(W),(t=(D=M(a[0],null,"Skill")).$$prototype).s_format=t.category_dice=t.row_dice=t.category_name=t.name=q,_(D,"$initialize",function(b,C,T,I,y){var g=this;return g.category_name=b,g.name=C,g.category_dice=T,g.row_dice=I,g.s_format=y}),_(D,"$to_s",function(){var b=this;return b.$format(b.s_format,A(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))}),D.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var a,t,I,y,g,o,v,b,i,G=e.module,M=e.klass,_=e.ensure_kwargs,A=e.hash2,E=e.send,F=e.defs,R=e.const_set,w=e.to_ary,N=e.def,H=e.truthy,j=e.rb_minus,z=e.rb_plus,U=e.top,L=[],x=e.nil,W=e.$$$;return U.$require("bcdice/dice_table/sai_fic_skill_table/category"),U.$require("bcdice/dice_table/sai_fic_skill_table/skill"),a=L,t=i=[G(L[0],"BCDice")].concat(a),I=b=[G(i[0],"DiceTable")].concat(t),g=[y=M(b[0],null,"SaiFicSkillTable")].concat(I),o=e.$r(g),(v=y.$$prototype).rtt=v.rtt_format=v.rct=v.rct_format=v.rttn=v.rttn_format=v.categories=x,F(y,"$from_i18n",function(f,u,k){var P,l,r,$,d=x;return null==(P=(k=_(k)).$$smap.rtt)&&(P=x),null==(l=k.$$smap.rct)&&(l=x),null==(r=k.$$smap.rttn)&&(r=x),$=(d=o("I18n").$t("RTT",A(["locale","raise","default"],{locale:u,raise:!1,default:A([],{})})).$merge(o("I18n").$t(f,A(["locale","raise"],{locale:u,raise:!0}))))["$[]"]("items"),d=E(d,"select",[],function(Q,V){return null==Q&&(Q=x),null==V&&(V=x),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Q)}),this.$new($,e.to_hash(d).$merge(A(["rtt","rct","rttn"],{rtt:P,rct:l,rttn:r})))},-3),R(g[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),R(g[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),R(g[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),R(g[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),N(y,"$initialize",function(f,u){var k,P,l,r,p,n,d,$=this;return null==(k=(u=_(u)).$$smap.rtt)&&(k=x),null==(P=u.$$smap.rct)&&(P=x),null==(l=u.$$smap.rttn)&&(l=x),null==(r=u.$$smap.rtt_format)&&(r=o("DEFAULT_RTT")),null==(p=u.$$smap.rct_format)&&(p=o("DEFAULT_RCT")),null==(n=u.$$smap.rttn_format)&&(n=o("DEFAULT_RTTN")),null==(d=u.$$smap.s_format)&&(d=o("DEFAULT_S")),$.categories=E(f.$map(),"with_index",[1],function(Q,V){var ne,ue,ie;return null==Q&&(Q=x),null==V&&(V=x),ue=null==(ne=w(Q))[0]?x:ne[0],ie=null==ne[1]?x:ne[1],W(o("SaiFicSkillTable"),"Category").$new(ue,ie,V,d)},{$$has_top_level_mlhs_arg:!0}),$.rtt=k,$.rct=P,$.rttn=l.$to_a(),$.rtt_format=r,$.rct_format=p,$.rttn_format=n},-2),R(g[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),y.$attr_reader("categories"),N(y,"$roll_command",function(f,u){var P,k=this,l=x,r=x;return H(["RTT",k.rtt]["$include?"](P=u))?k.$format_skill(k.rtt_format,k.$roll_skill(f)):H(["RCT",k.rct]["$include?"](P))?(l=k.$roll_category(f),k.$format(k.rct_format,A(["category_dice","category_name"],{category_dice:l.$dice(),category_name:l.$name()}))):H(r=o("RTTN").$index(P))||H(r=k.rttn.$index(P))?k.$format_skill(k.rttn_format,k.categories["$[]"](r).$roll(f)):x}),N(y,"$roll_category",function(f){return this.categories["$[]"](j(f.$roll_once(6),1))}),N(y,"$roll_skill",function(f){return this.$roll_category(f).$roll(f)}),N(y,"$prefixes",function(){var f=this;return z(["RTT[1-6]?","RCT",f.rtt,f.rct],f.rttn).$compact()}),y.$private(),N(y,"$format_skill",function(f,u){return this.$format(f,A(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:u.$category_dice(),row_dice:u.$row_dice(),category_name:u.$category_name(),skill_name:u.$name(),text:u.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var H,L,m,i,D,t,c,W,z,G=e.module,M=e.klass,_=e.hash2,A=e.defs,E=e.truthy,q=e.def,F=e.rb_minus,R=[],w=e.nil;return H=R,L=z=[G(R[0],"BCDice")].concat(H),m=W=[G(z[0],"DiceTable")].concat(L),D=[i=M(W[0],null,"Table")].concat(m),t=e.$r(D),(c=i.$$prototype).times=c.sides=c.name=c.items=w,A(i,"$from_i18n",function(C,T){var y=w;return y=t("I18n").$t(C,_(["locale"],{locale:T})),this.$new(y["$[]"]("name"),y["$[]"]("type"),y["$[]"]("items"))}),q(i,"$initialize",function(C,T,I){var y=this,g=w;return y.name=C,y.items=I.$freeze(),g=/(\d+)D(\d+)/i.$match(T),E(g)||y.$raise(t("ArgumentError"),"Unexpected table type: "+T),y.times=g["$[]"](1).$to_i(),y.sides=g["$[]"](2).$to_i()}),q(i,"$roll",function(C){var I,T=this;return I=C.$roll_sum(T.times,T.sides),T.$choice(I)}),q(i,"$choice",function(C){var I,T=this;return I=F(C,T.times),t("RollResult").$new(T.name,C,T.items["$[]"](I))})},Opal.modules["bcdice/dice_table"]=function(e){var G=e.top;return G.$require("bcdice/dice_table/roll_result"),G.$require("bcdice/dice_table/chain_table"),G.$require("bcdice/dice_table/d66_grid_table"),G.$require("bcdice/dice_table/d66_half_grid_table"),G.$require("bcdice/dice_table/d66_one_third_table"),G.$require("bcdice/dice_table/d66_left_range_table"),G.$require("bcdice/dice_table/d66_parity_table"),G.$require("bcdice/dice_table/d66_range_table"),G.$require("bcdice/dice_table/d66_table"),G.$require("bcdice/dice_table/range_table"),G.$require("bcdice/dice_table/sai_fic_skill_table"),G.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var q,N,j,R,G=e.module,M=e.const_set,_=[];return q=_,N=R=[G(_[0],"BCDice")].concat(q),j=[G(R[0],"D66SortType")].concat(N),M(j[0],"NO_SORT","no_sort"),M(j[0],"ASC","asc"),M(j[0],"DESC","desc"),function(w,N){var j=[G(w,"RoundType")].concat(N);return M(j[0],"CEIL","ceil"),M(j[0],"FLOOR","floor"),M(j[0],"ROUND","round")}(R[0],R)},Opal.modules["bcdice/translate"]=function(e){var N,U,L,x,W,j,G=e.module,M=e.ensure_kwargs,_=e.kwrestargs,E=e.hash2,q=e.def,F=[],R=e.nil;return N=F,U=j=[G(F[0],"BCDice")].concat(N),x=[L=G(j[0],"Translate")].concat(U),W=e.$r(x),q(L,"$translate",function(a,m){var i,D=this;return null==D.locale&&(D.locale=R),m=M(m),i=_(m,{}),W("I18n").$translate(a,E(["locale","raise"],{locale:D.locale,raise:!0}).$merge(e.to_hash(i)))},-2)},Opal.modules["bcdice/result"]=function(e){var L,B,x,N,j,M=e.klass,_=e.send,A=e.def,E=e.return_val,q=e.return_ivar,F=[],R=e.nil;return N=F,L=j=[(0,e.module)(F[0],"BCDice")].concat(N),[x=M(j[0],null,"Result")].concat(L),A(B=e.get_singleton_class(x),"$success",function(i){return _(this.$new(),"tap",[],function(c){var b;return null==c&&(c=R),c["$text="](i),_(c,"success=",b=[!0]),b[b.length-1]})}),A(B,"$failure",function(i){return _(this.$new(),"tap",[],function(c){var b;return null==c&&(c=R),c["$text="](i),_(c,"failure=",b=[!0]),b[b.length-1]})}),A(B,"$critical",function(i){return _(this.$new(),"tap",[],function(c){var b;return null==c&&(c=R),c["$text="](i),c["$critical="](!0),_(c,"success=",b=[!0]),b[b.length-1]})}),A(B,"$fumble",function(i){return _(this.$new(),"tap",[],function(c){var b;return null==c&&(c=R),c["$text="](i),c["$fumble="](!0),_(c,"failure=",b=[!0]),b[b.length-1]})}),A(B,"$nothing",E("nothing")),A(x,"$initialize",function(a){var m=this;return null==a&&(a=R),m.text=a,m.rands=R,m.detailed_rands=R,m.secret=!1,m.success=!1,m.failure=!1,m.critical=!1,m.fumble=!1},-1),x.$attr_accessor("text","rands","detailed_rands"),x.$attr_writer("secret","success","failure","critical","fumble"),A(x,"$secret?",q("secret")),A(x,"$success?",q("success")),A(x,"$failure?",q("failure")),A(x,"$critical?",q("critical")),A(x,"$fumble?",q("fumble")),A(x,"$condition=",function(a){return this.success=a,this.failure=a["$!"]()})},Opal.modules["racc/parser"]=function(e){var C,I,y,G=e.module,M=e.klass,_=e.truthy,A=e.const_set,E=e.defs,q=e.gvars,F=e.rb_lt,R=e.def,w=e.to_ary,N=e.send,H=e.neqeq,j=e.rb_plus,z=e.eqeq,U=e.rb_ge,L=e.rb_gt,x=e.rb_minus,W=e.rb_le,B=e.rb_times,a=e.assign_ivar_val,i=[],D=e.$r(i),t=e.nil,c=e.$$$;return C=i,I=[G(i[0],"Racc")].concat(C),y=e.$r(I),M(I[0],y("StandardError"),"ParseError"),_(c("::","ParseError","skip_raise")?"constant":t)||A(i[0],"ParseError",c(D("Racc"),"ParseError")),function(b,C){var s,f,u,k,P,y=[G(b,"Racc")].concat(C),g=e.$r(y);return _(g("Racc_No_Extensions","skip_raise")?"constant":t)||A(y[0],"Racc_No_Extensions",!1),s=y,u=[f=M(y[0],null,"Parser")].concat(s),k=e.$r(u),(P=f.$$prototype).yydebug=P.racc_debug_out=P.racc_error_status=P.racc_t=P.racc_vstack=P.racc_val=P.racc_state=P.racc_tstack=t,A(u[0],"Racc_Runtime_Version","1.4.6"),A(u[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),A(u[0],"Racc_Runtime_Core_Version_R","1.4.6"),A(u[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),A(u[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),A(u[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),A(u[0],"Racc_Runtime_Core_Version",k("Racc_Runtime_Core_Version_R")),A(u[0],"Racc_Runtime_Core_Revision",k("Racc_Runtime_Core_Revision_R")),A(u[0],"Racc_Runtime_Type","ruby"),E(k("Parser"),"$racc_runtime_type",function(){return k("Racc_Runtime_Type")}),R(f,"$_racc_setup",function(){var r,p,n=this,d=t,$=t;return null==q.stderr&&(q.stderr=t),_(c(n.$class(),"Racc_debug_parser"))||(n.yydebug=!1),_(null!=(r=n.yydebug)&&r!==t?"instance-variable":t)||(n.yydebug=!1),_(n.yydebug)&&(_(null!=(p=n.racc_debug_out)&&p!==t?"instance-variable":t)||(n.racc_debug_out=q.stderr),n.racc_debug_out=_(d=n.racc_debug_out)?d:q.stderr),$=c(n.$class(),"Racc_arg"),_(F($.$size(),14))&&$["$[]="](13,!0),$}),R(f,"$_racc_init_sysvars",function(){var r=this;return r.racc_state=[0],r.racc_tstack=[],r.racc_vstack=[],r.racc_t=t,r.racc_val=t,r.racc_read_next=!0,r.racc_user_yyerror=!1,r.racc_error_status=0}),R(f,"$do_parse",function(){return this.$__send__(k("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),R(f,"$next_token",function(){return this.$raise(k("NotImplementedError"),this.$class()+"#next_token is not defined")}),R(f,"$_racc_do_parse_rb",function(r,p){var n,$=this,Y=t,Q=t,V=t,ne=t,ue=t,ie=t,ce=t,ae=t;return n=w(r),Y=null==n[0]?t:n[0],Q=null==n[1]?t:n[1],V=null==n[2]?t:n[2],ne=null==n[3]?t:n[3],ue=null==n[10]?t:n[10],$.$_racc_init_sysvars(),ie=ce=ae=t,N($,"catch",["racc_end_parse"],function re(){var se,K,h=null==re.$$s?this:re.$$s,Z=t;for(null==h.racc_state&&(h.racc_state=t),null==h.racc_read_next&&(h.racc_read_next=t),null==h.racc_t&&(h.racc_t=t),null==h.yydebug&&(h.yydebug=t),null==h.racc_val&&(h.racc_val=t);_(!0);)for(_(ae=ne["$[]"](h.racc_state["$[]"](-1)))?(_(h.racc_read_next)&&H(h.racc_t,0)&&(K=h.$next_token(),se=w(K),ie=null==se[0]?t:se[0],h.racc_val=null==se[1]?t:se[1],h.racc_t=_(ie)?_(Z=ue["$[]"](ie))?Z:1:0,_(h.yydebug)&&h.$racc_read_token(h.racc_t,ie,h.racc_val),h.racc_read_next=!1),ae=j(ae,h.racc_t),_(U(ae,0))&&_(ce=Y["$[]"](ae))&&z(Q["$[]"](ae),h.racc_state["$[]"](-1))||(ce=V["$[]"](h.racc_state["$[]"](-1)))):ce=V["$[]"](h.racc_state["$[]"](-1));_(ce=h.$_racc_evalact(ce,r)););},{$$s:$})}),R(f,"$yyparse",function(r,p){return this.$__send__(k("Racc_YY_Parse_Method"),r,p,this.$_racc_setup(),!0)}),R(f,"$_racc_yyparse_rb",function(r,p,n,d){var $,Q=this,V=t,ne=t,$e=t,ue=t,ce=t,ae=t,re=t;return $=w(n),V=null==$[0]?t:$[0],ne=null==$[1]?t:$[1],$e=null==$[2]?t:$[2],ue=null==$[3]?t:$[3],ce=null==$[10]?t:$[10],Q.$_racc_init_sysvars(),ae=t,re=t,N(Q,"catch",["racc_end_parse"],function se(){var K=null==se.$$s?this:se.$$s;for(null==K.racc_state&&(K.racc_state=t);!_(re=ue["$[]"](K.racc_state["$[]"](-1)));)for(;_(ae=K.$_racc_evalact($e["$[]"](K.racc_state["$[]"](-1)),n)););return N(r,"__send__",[p],function h(Z,X){var S=null==h.$$s?this:h.$$s,O=t,te=t;for(null==S.racc_t&&(S.racc_t=t),null==S.racc_state&&(S.racc_state=t),null==S.racc_read_next&&(S.racc_read_next=t),null==Z&&(Z=t),null==X&&(X=t),S.racc_t=_(Z)?_(O=ce["$[]"](Z))?O:1:0,S.racc_val=X,S.racc_read_next=!1,re=j(re,S.racc_t),_(U(re,0))&&_(ae=V["$[]"](re))&&z(ne["$[]"](re),S.racc_state["$[]"](-1))||(ae=$e["$[]"](S.racc_state["$[]"](-1)));_(ae=S.$_racc_evalact(ae,n)););for(;_(_(O=_(te=(re=ue["$[]"](S.racc_state["$[]"](-1)))["$!"]())?te:S.racc_read_next["$!"]())?O:S.racc_t["$=="](0));)for(_(re)&&_(re=j(re,S.racc_t))&&_(U(re,0))&&_(ae=V["$[]"](re))&&z(ne["$[]"](re),S.racc_state["$[]"](-1))||(ae=$e["$[]"](S.racc_state["$[]"](-1)));_(ae=S.$_racc_evalact(ae,n)););},{$$s:K})},{$$s:Q})}),R(f,"$_racc_evalact",function(r,p){var n,$e,$=this,Y=t,Q=t,ne=t,ue=t,ie=t,ce=t;if(Y=null==(n=w(p))[0]?t:n[0],Q=null==n[1]?t:n[1],ne=null==n[3]?t:n[3],$e=null==n[11]?t:n[11],ue=null==n[12]?t:n[12],_(L(r,0))&&_(F(r,$e)))_(L($.racc_error_status,0))&&(z($.racc_t,1)||($.racc_error_status=x($.racc_error_status,1))),$.racc_vstack.$push($.racc_val),$.racc_state.$push(r),$.racc_read_next=!0,_($.yydebug)&&($.racc_tstack.$push($.racc_t),$.$racc_shift($.racc_t,$.racc_tstack,$.racc_vstack));else if(_(F(r,0))&&_(L(r,ue["$-@"]()))){if(ie=N($,"catch",["racc_jump"],function ae(){var re=null==ae.$$s?this:ae.$$s;return null==re.racc_state&&(re.racc_state=t),re.racc_state.$push(re.$_racc_do_reduce(p,r)),!1},{$$s:$}),_(ie))switch(ie.valueOf()){case 1:return $.racc_user_yyerror=!0,ue["$-@"]();case 2:return $e;default:$.$raise("[Racc Bug] unknown jump code")}}else if(z(r,$e))_($.yydebug)&&$.$racc_accept(),$.$throw("racc_end_parse",$.racc_vstack["$[]"](0));else{if(z(r,ue["$-@"]())){switch($.racc_error_status.valueOf()){case 0:_(p["$[]"](21))||$.$on_error($.racc_t,$.racc_val,$.racc_vstack);break;case 3:z($.racc_t,0)&&$.$throw("racc_end_parse",t),$.racc_read_next=!0}for($.racc_user_yyerror=!1,$.racc_error_status=3;_(!0)&&!(_(ce=ne["$[]"]($.racc_state["$[]"](-1)))&&(ce=j(ce,1),_(U(ce,0))&&_(r=Y["$[]"](ce))&&z(Q["$[]"](ce),$.racc_state["$[]"](-1))));)_(W($.racc_state.$size(),1))&&$.$throw("racc_end_parse",t),$.racc_state.$pop(),$.racc_vstack.$pop(),_($.yydebug)&&($.racc_tstack.$pop(),$.$racc_e_pop($.racc_state,$.racc_tstack,$.racc_vstack));return r}$.$raise("[Racc Bug] unknown action "+r.$inspect())}return _($.yydebug)&&$.$racc_next_state($.racc_state["$[]"](-1),$.racc_state),t}),R(f,"$_racc_do_reduce",function(r,p){var n,ue,ce,Z,X,S,ee,$=this,Q=t,V=t,ne=t,$e=t,ie=t,ae=t,re=t,se=t,K=t,h=t,O=t,te=t,J=t;return Q=null==(n=w(r))[4]?t:n[4],V=null==n[5]?t:n[5],ne=null==n[6]?t:n[6],$e=null==n[7]?t:n[7],ue=null==n[8]?t:n[8],ie=null==n[9]?t:n[9],ce=null==n[13]?t:n[13],ae=$.racc_state,re=$.racc_vstack,se=$.racc_tstack,K=B(p,-3),h=ie["$[]"](K),Z=ie["$[]"](j(K,1)),X=ie["$[]"](j(K,2)),S=[],_($.yydebug)&&(O=se["$[]"](h["$-@"](),h)),te=re["$[]"](h["$-@"](),h),_($.yydebug)&&se["$[]="](h["$-@"](),h,S),re["$[]="](h["$-@"](),h,S),ae["$[]="](h["$-@"](),h,S),_(ce)?re.$push($.$__send__(X,te,re,te["$[]"](0))):re.$push($.$__send__(X,te,re)),se.$push(Z),_($.yydebug)&&$.$racc_reduce(O,Z,se,re),ee=x(Z,ue),_(K=$e["$[]"](ee))&&(K=j(K,ae["$[]"](-1)),_(U(K,0))&&_(J=Q["$[]"](K))&&z(V["$[]"](K),ee))?J:ne["$[]"](ee)}),R(f,"$on_error",function(r,p,n){var $,d=this;return d.$raise(k("ParseError"),d.$sprintf("\nparse error on value %s (%s)",p.$inspect(),_($=d.$token_to_str(r))?$:"?"))}),R(f,"$yyerror",function(){return this.$throw("racc_jump",1)}),R(f,"$yyaccept",function(){return this.$throw("racc_jump",2)}),R(f,"$yyerrok",a("racc_error_status",0)),R(f,"$racc_read_token",function(r,p,n){var d=this;return d.racc_debug_out.$print("read    "),d.racc_debug_out.$print(p.$inspect(),"(",d.$racc_token2str(r),") "),d.racc_debug_out.$puts(n.$inspect()),d.racc_debug_out.$puts()}),R(f,"$racc_shift",function(r,p,n){var d=this;return d.racc_debug_out.$puts("shift   "+d.$racc_token2str(r)),d.$racc_print_stacks(p,n),d.racc_debug_out.$puts()}),R(f,"$racc_reduce",function(r,p,n,d){var $=this,Y=t;return(Y=$.racc_debug_out).$print("reduce "),_(r["$empty?"]())?Y.$print(" <none>"):N(r,"each",[],function Q(V){return null==V&&(V=t),Y.$print(" ",(null==Q.$$s?this:Q.$$s).$racc_token2str(V))},{$$s:$}),Y.$puts(" --\x3e "+$.$racc_token2str(p)),$.$racc_print_stacks(n,d),$.racc_debug_out.$puts()}),R(f,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),R(f,"$racc_e_pop",function(r,p,n){var d=this;return d.racc_debug_out.$puts("error recovering mode: pop token"),d.$racc_print_states(r),d.$racc_print_stacks(p,n),d.racc_debug_out.$puts()}),R(f,"$racc_next_state",function(r,p){var n=this;return n.racc_debug_out.$puts("goto    "+r),n.$racc_print_states(p),n.racc_debug_out.$puts()}),R(f,"$racc_print_stacks",function(r,p){var d=t;return(d=this.racc_debug_out).$print("        ["),N(r,"each_index",[],function $(Y){return null==Y&&(Y=t),d.$print(" (",(null==$.$$s?this:$.$$s).$racc_token2str(r["$[]"](Y))," ",p["$[]"](Y).$inspect(),")")},{$$s:this}),d.$puts(" ]")}),R(f,"$racc_print_states",function(r){var n=t;return(n=this.racc_debug_out).$print("        ["),N(r,"each",[],function($){return null==$&&($=t),n.$print(" ",$)}),n.$puts(" ]")}),R(f,"$racc_token2str",function(r){var n;return _(n=c(this.$class(),"Racc_token_to_s_table")["$[]"](r))?n:this.$raise("[Racc Bug] can't convert token "+r+" to string")}),R(f,"$token_to_str",function(r){return c(this.$class(),"Racc_token_to_s_table")["$[]"](r)})}(i[0],i)},Opal.modules["bcdice/arithmetic/node"]=function(e){var a,t,T,s,f,y,g,b,i,G=e.module,M=e.klass,_=e.def,A=e.thrower,E=e.return_ivar,q=e.send2,F=e.find_super,R=e.eqeq,w=e.const_set,N=e.eqeqeq,H=e.rb_divide,j=e.truthy,z=e.assign_ivar,U=e.alias,L=[],x=e.nil,W=e.$$$;return a=L,t=i=[G(L[0],"BCDice")].concat(a),T=b=[G(i[0],"Arithmetic")].concat(t),y=[G(b[0],"Node")].concat(T),g=e.$r(y),(f=(s=M(y[0],null,"BinaryOp")).$$prototype).lhs=f.rhs=f.op=x,_(s,"$initialize",function(k,P,l){var r=this;return r.lhs=k,r.op=P,r.rhs=l}),_(s,"$eval",function(k){try{A("eval_return");var p,l=this,r=x;return r=l.lhs.$eval(k),p=l.rhs.$eval(k),r.$send(l.op,p)}catch(n){if(n===e.t_eval_return)return n.$v;throw n}}),_(s,"$output",function(){var k=this;return""+k.lhs.$output()+k.op+k.rhs.$output()}),_(s,"$s_exp",function(){var k=this;return"("+k.$op_for_s_exp()+" "+k.lhs.$s_exp()+" "+k.rhs.$s_exp()+")"}),_(s,"$op_for_s_exp",E("op")),function(o,v,s){var f=M(o,v,"DivideBase"),u=[f].concat(s),k=e.$r(u),P=f.$$prototype;P.lhs=P.rhs=P.op=x,_(f,"$initialize",function l(r,p){return l.$$p=null,q(this,F(this,"initialize",l,!1,!0),"initialize",[r,"/",p],null)}),_(f,"$eval",function(r){try{A("eval_return");var d,$,n=this;return d=n.lhs.$eval(r),$=n.rhs.$eval(r),R($,0)&&n.$raise(k("ZeroDivisionError")),n.$divide_and_round(d,$,r)}catch(Y){if(Y===e.t_eval_return)return Y.$v;throw Y}}),_(f,"$output",function l(){var r=l.$$p||x,p=this;return l.$$p=null,""+q(p,F(p,"output",l,!1,!0),"output",[],r)+p.$rounding_method()}),f.$private(),_(f,"$rounding_method",function(){return W(this.$class(),"ROUNDING_METHOD")}),_(f,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(f,"$divide_and_round",function(r,p,n){return this.$raise(k("NotImplementedError"))})}(y[0],g("BinaryOp"),y),function(o,v,s){var f=M(o,v,"DivideWithGameSystemDefault"),u=[f].concat(s),k=e.$r(u);w(u[0],"ROUNDING_METHOD",""),f.$private(),_(f,"$divide_and_round",function(l,r,p){var n,d=x;return N(W(k("RoundType"),"CEIL"),n=p)?H(l.$to_f(),r).$ceil():N(W(k("RoundType"),"ROUND"),n)?(d=H(l.$to_f(),r),j(d["$negative?"]())?d.$abs().$round()["$-@"]():d.$round()):H(l,r).$floor()})}(y[0],g("DivideBase"),y),function(o,v,s){var f=M(o,v,"DivideWithCeil"),u=[f].concat(s);w(u[0],"ROUNDING_METHOD","C"),f.$private(),_(f,"$divide_and_round",function(P,l,r){return H(P.$to_f(),l).$ceil()})}(y[0],g("DivideBase"),y),function(o,v,s){var f=M(o,v,"DivideWithRound"),u=[f].concat(s);w(u[0],"ROUNDING_METHOD","R"),f.$private(),_(f,"$divide_and_round",function(P,l,r){var p=x;return p=H(P.$to_f(),l),j(p["$negative?"]())?p.$abs().$round()["$-@"]():p.$round()})}(y[0],g("DivideBase"),y),function(o,v,s){var f=M(o,v,"DivideWithFloor"),u=[f].concat(s);w(u[0],"ROUNDING_METHOD","F"),f.$private(),_(f,"$divide_and_round",function(P,l,r){return H(P,l).$floor()})}(y[0],g("DivideBase"),y),function(o,v){var s=M(o,null,"Negative");s.$$prototype.body=x,_(s,"$initialize",z("body")),_(s,"$eval",function(k){try{return A("eval_return"),this.body.$eval(k)["$-@"]()}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),_(s,"$output",function(){return"-"+this.body.$output()}),_(s,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(y[0]),function(o,v){var s=M(o,null,"Parenthesis");s.$$prototype.expr=x,_(s,"$initialize",z("expr")),_(s,"$eval",function(k){try{return A("eval_return"),this.expr.$eval(k)}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),_(s,"$output",function(){return"("+this.expr.$output()+")"}),_(s,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(y[0]),function(o,v){var s=M(o,null,"Number");return s.$$prototype.value=x,_(s,"$initialize",z("value")),_(s,"$eval",E("value")),_(s,"$output",function(){return this.value.$to_s()}),U(s,"s_exp","output")}(y[0])},Opal.modules.strscan=function(e){var z,U,L,x,W,M=e.def,_=e.truthy,A=e.eqeqeq,E=e.Opal,q=e.return_ivar,F=e.send,R=e.alias,w=[],N=e.nil;return z=w,L=[U=(0,e.klass)(w[0],null,"StringScanner")].concat(z),x=e.$r(L),(W=U.$$prototype).pos=W.string=W.working=W.matched=W.prev_pos=W.match=N,U.$attr_reader("pos","matched"),M(U,"$initialize",function(a){var m=this;return m.string=a,m.pos=0,m.matched=N,m.working=a,m.match=[]}),U.$attr_reader("string"),M(U,"$beginning_of_line?",function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)}),M(U,"$scan",function(a){var m=this,i=(a=m.$anchor(a)).exec(m.working);return null==i?m.matched=N:(m.prev_pos=m.pos,m.pos+=i[0].length,m.working=m.working.substring(i[0].length),m.matched=i[0],m.match=i,i[0])}),M(U,"$scan_until",function(a){var m=this;a=m.$anchor(a);for(var i=m.working,D=0;i.length!=D;++D){var t=a.exec(i.substr(D));if(null!==t){var c=D+t[0].length,b=i.substr(0,c);return m.matched=t[0],m.match=t,m.prev_pos=m.pos+D,m.pos+=c,m.working=i.substr(c),b}}return m.matched=N}),M(U,"$[]",function(a){var i;if(_(this.match["$empty?"]()))return N;A(x("Symbol"),i=a)?a=a.$to_s():A(x("String"),i)||(a=E["$coerce_to!"](a,x("Integer"),"to_int"));var D=this.match;return a<0&&(a+=D.length),a<0||a>=D.length||null==D[a]?N:D[a]}),M(U,"$check",function(a){var m=this,i=(a=m.$anchor(a)).exec(m.working);return m.matched=null==i?N:i[0]}),M(U,"$check_until",function(a){var m=this,i=m.prev_pos,D=m.pos,t=m.working,c=m.$scan_until(a);return m.prev_pos=i,m.pos=D,m.working=t,c}),M(U,"$peek",function(a){return this.working.substring(0,a)}),M(U,"$eos?",function(){return 0===this.working.length}),M(U,"$exist?",function(a){var i=a.exec(this.working);return null==i?N:0==i.index?0:i.index+1}),M(U,"$skip",function(a){var m=this,i=(a=m.$anchor(a)).exec(m.working);if(null==i)return m.match=[],m.matched=N;var D=i[0],t=D.length;return m.matched=D,m.match=i,m.prev_pos=m.pos,m.pos+=t,m.working=m.working.substring(t),t}),M(U,"$skip_until",function(a){var i=this.$scan_until(a);return i===N?N:(this.matched=i.substr(-1),i.length)}),M(U,"$get_byte",function(){var a=this,m=N;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,m=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=N,m}),M(U,"$match?",function(a){var m=this,i=(a=m.$anchor(a)).exec(m.working);return null==i?N:(m.prev_pos=m.pos,i[0].length)}),M(U,"$pos=",function(a){var m=this;return a<0&&(a+=m.string.$length()),m.pos=a,m.working=m.string.slice(a)}),M(U,"$matched_size",function(){return this.matched===N?N:this.matched.length}),M(U,"$post_match",function(){var a=this;return a.matched===N?N:a.string.substr(a.pos)}),M(U,"$pre_match",function(){var a=this;return a.matched===N?N:a.string.substr(0,a.prev_pos)}),M(U,"$reset",function(){var a=this;return a.working=a.string,a.matched=N,a.pos=0}),M(U,"$rest",q("working")),M(U,"$rest?",function(){return 0!==this.working.length}),M(U,"$rest_size",function(){return this.$rest().$size()}),M(U,"$terminate",function(){var a,m=this;return m.match=N,a=[m.string.$length()],F(m,"pos=",a),a[a.length-1]}),M(U,"$unscan",function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=N,a.match=N,a}),R(U,"bol?","beginning_of_line?"),R(U,"getch","get_byte"),U.$private(),M(U,"$anchor",function(a){var m=a.toString().match(/\/([^\/]+)$/);return m=m?m[1]:void 0,new RegExp("^(?:"+a.source+")",m)})},Opal.modules["bcdice/normalize"]=function(e){var R,j,N,G=e.module,M=e.eqeqeq,_=e.def,A=e.eqeq,E=[],q=e.nil;return R=E,N=[G(E[0],"BCDice")].concat(R),(j=G(N[0],"Normalize")).$module_function(),_(j,"$comparison_operator",function(U){var L;return M(/<=|=</,L=U)?"<=":M(/>=|=>/,L)?">=":M(/<>|!=|=!/,L)?"!=":M(/</,L)?"<":M(/>/,L)?">":M(/=/,L)?"==":q}),_(j,"$target_number",function(U){return A(U,"?")?U:U.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var z,W,D,t,c,b,C,a,L,G=e.module,M=e.klass,_=e.const_set,A=e.hash2,E=e.truthy,q=e.send,F=e.def,R=e.thrower,w=e.top,N=[],H=e.nil;return w.$require("strscan"),w.$require("bcdice/normalize"),z=N,W=L=[G(N[0],"BCDice")].concat(z),D=a=[G(L[0],"Command")].concat(W),c=[t=M(a[0],null,"Lexer")].concat(D),b=e.$r(c),(C=t.$$prototype).scanner=C.notations=H,_(c[0],"SYMBOLS",A(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),F(t,"$initialize",function(I,y){var g,o,s;return I=E(s=(g=(o=I)===H||null==o?H:o.$split(" ",2))===H||null==g?H:g.$first())?s:"",this.scanner=b("StringScanner").$new(I),this.notations=q(y,"map",[],function(u){return null==u&&(u=H),E(u["$is_a?"](b("String")))?b("Regexp").$new(u):u})}),F(t,"$next_token",function(){try{var I=R("return"),y=this,g=H,o=H,s=H,f=H;return E(y.scanner["$eos?"]())?[!1,"$"]:(q(y.notations,"each",[],function u(k){var l,P=null==u.$$s?this:u.$$s;if(null==P.scanner&&(P.scanner=H),null==k&&(k=H),l=P.scanner.$scan(k),!E(l))return H;I.$throw(["NOTATION",l])},{$$s:y,$$ret:I}),E(g=y.scanner.$scan(/\d+/))?["NUMBER",g.$to_i()]:E(o=y.scanner.$scan(/[<>!=]+/))?(o=b("Normalize").$comparison_operator(o),[E(o)?"CMP_OP":"ILLEGAL",o]):(s=y.scanner.$getch().$upcase(),[E(f=b("SYMBOLS")["$[]"](s))?f:s.$to_sym(),s]))}catch(u){if(u===I)return u.$v;throw u}}),F(t,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var w,z,B,a,m,i,D,L,H,G=e.module,M=e.klass,_=e.def,A=e.return_ivar,E=e.truthy,q=[],F=e.nil;return w=q,z=H=[G(q[0],"BCDice")].concat(w),B=L=[G(H[0],"Command")].concat(z),m=[a=M(L[0],null,"Parsed")].concat(B),i=e.$r(m),(D=a.$$prototype).critical=D.fumble=D.dollar=D.modify_number=D.question_target=D.target_number=D.prefix_number=D.command=D.suffix_number=D.cmp_op=F,a.$attr_accessor("command"),a.$attr_accessor("prefix_number"),a.$attr_accessor("suffix_number"),a.$attr_accessor("critical"),a.$attr_accessor("fumble"),a.$attr_accessor("dollar"),a.$attr_accessor("modify_number"),a.$attr_accessor("cmp_op"),a.$attr_accessor("target_number"),a.$attr_writer("question_target"),_(a,"$initialize",function(){var c=this;return c.prefix_number=F,c.suffix_number=F,c.critical=F,c.fumble=F,c.dollar=F,c.cmp_op=F,c.target_number=F,c.question_target=!1}),_(a,"$question_target?",A("question_target")),_(a,"$to_s",function(c){var b=this,C=F,T=F,I=F,y=F,g=F;switch(null==c&&(c="after_command"),C=E(b.critical)?"@"+b.critical:F,T=E(b.fumble)?"#"+b.fumble:F,I=E(b.dollar)?"$"+b.dollar:F,y=i("Format").$modifier(b.modify_number),g=E(b.question_target)?"?":b.target_number,c.valueOf()){case"after_command":return[b.prefix_number,b.command,b.suffix_number,C,T,I,y,b.cmp_op,g].$join();case"after_modify_number":return[b.prefix_number,b.command,b.suffix_number,y,C,T,I,b.cmp_op,g].$join();case"after_target_number":return[b.prefix_number,b.command,b.suffix_number,y,b.cmp_op,g,C,T,I].$join();default:return F}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var c,I,f,p,n,d,$,Y,Q,V,ne,$e,ce,u,l,r,se,g,o,C,G=e.klass,M=e.module,_=e.slice,A=e.extract_kwargs,E=e.ensure_kwargs,q=e.get_kwarg,F=e.send2,R=e.find_super,w=e.def,N=e.send,H=e.eqeq,j=e.thrower,z=e.hash,U=e.const_set,L=e.truthy,x=e.to_ary,W=e.hash2,B=e.top,a=[],m=e.$r(a),i=e.nil,D=e.$$$;return B.$require("racc/parser.rb"),B.$require("bcdice/arithmetic/node"),B.$require("bcdice/command/lexer"),B.$require("bcdice/command/parsed"),G(D(m("BCDice"),"Command"),D(m("Racc"),"Parser"),"Parser"),c=a,I=C=[M(a[0],"BCDice")].concat(c),g=[M(C[0],"Command")].concat(I),o=e.$r(g),f=g,l=[u=G(g[0],D(o("Racc"),"Parser"),"Parser")].concat(f),r=e.$r(l),(se=u.$$prototype).notations=se.lexer=se.modifier=se.suffix_number=se.prefix_number=se.need_suffix_number=se.need_prefix_number=se.critical=se.fumble=se.dollar=se.allowed_cmp_op=se.question_target=i,w(u,"$initialize",function K(h,Z){var X,S,O,te,J=this;return K.$$p=null,X=_(arguments),S=A(X),S=E(S),O=X,te=q(S,"round_type"),F(J,R(J,"initialize",K,!1,!0),"initialize",[],null),J.notations=O,J.round_type=te,J.prefix_number=!1,J.suffix_number=!1,J.need_prefix_number=!1,J.need_suffix_number=!1,J.modifier=!0,J.critical=!1,J.fumble=!1,J.dollar=!1,J.allowed_cmp_op=[i,">=",">","<=","<","==","!="],J.question_target=!1},-2),w(u,"$disable_modifier",function(){return this.modifier=!1,this}),w(u,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),w(u,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),w(u,"$has_prefix_number",function(){var h=this;return h.prefix_number=!0,h.need_prefix_number=!0,h}),w(u,"$has_suffix_number",function(){var h=this;return h.suffix_number=!0,h.need_suffix_number=!0,h}),w(u,"$enable_critical",function(){return this.critical=!0,this}),w(u,"$enable_fumble",function(){return this.fumble=!0,this}),w(u,"$enable_dollar",function(){return this.dollar=!0,this}),w(u,"$restrict_cmp_op_to",function(h){var Z;return Z=_(arguments),this.allowed_cmp_op=Z,this},-1),w(u,"$enable_question_target",function(){return this.question_target=!0,this}),w(u,"$parse",function(h){var Z=this;try{return Z.lexer=r("Lexer").$new(h,Z.notations),Z.$do_parse()}catch(X){if(!e.rescue(X,[r("ParseError"),r("ZeroDivisionError")]))throw X;try{return i}finally{e.pop_exception()}}}),u.$private(),w(u,"$parsed",function(h,Z,X,S){try{return j("eval_return"),N(r("Parsed").$new(),"tap",[],function ee(J){var _e,le,de,me,ve,fe,be,oe=null==ee.$$s?this:ee.$$s;return null==oe.round_type&&(oe.round_type=i),null==J&&(J=i),J["$command="](h["$[]"]("command")),J["$prefix_number="]((_e=h["$[]"]("prefix"))===i||null==_e?i:_e.$eval(oe.round_type)),J["$suffix_number="]((le=h["$[]"]("suffix"))===i||null==le?i:le.$eval(oe.round_type)),J["$critical="]((de=Z["$[]"]("critical"))===i||null==de?i:de.$eval(oe.round_type)),J["$fumble="]((me=Z["$[]"]("fumble"))===i||null==me?i:me.$eval(oe.round_type)),J["$dollar="]((ve=Z["$[]"]("dollar"))===i||null==ve?i:ve.$eval(oe.round_type)),J["$modify_number="](X.$eval(oe.round_type)),J["$cmp_op="](S["$[]"]("cmp_op")),H(S["$[]"]("target"),"?")?(J["$question_target="](!0),N(J,"target_number=",fe=[0]),fe[fe.length-1]):(J["$question_target="](!1),fe=[(be=S["$[]"]("target"),be===i||null==be?i:be.$eval(oe.round_type))],N(J,"target_number=",fe),fe[fe.length-1])},{$$s:this})}catch(ee){if(ee===e.t_eval_return)return ee.$v;throw ee}}),w(u,"$next_token",function(){return this.lexer.$next_token()}),p=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),n=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),d=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),$=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),Y=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),Q=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),V=[i,6,13,3,9,-1,27,-15,-10,-1,-38],ne=[i,i,i,i,i,i,19,16,15,i,i],$e=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ce=z(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),U(l[0],"Racc_arg",[p,n,$,d,Y,Q,ne,V,19,$e,ce,58,35,!0]),L(r("Ractor","skip_raise")?"constant":i)&&r("Ractor").$make_shareable(r("Racc_arg")),U(l[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),L(r("Ractor","skip_raise")?"constant":i)&&r("Ractor").$make_shareable(r("Racc_token_to_s_table")),U(l[0],"Racc_debug_parser",!1),w(u,"$_reduce_1",function(h,Z,X){var S;return L(this.modifier)||this.$raise(r("ParseError")),S=x(h),this.$parsed(null==S[0]?i:S[0],null==S[1]?i:S[1],null==S[2]?i:S[2],null==S[3]?i:S[3])}),w(u,"$_reduce_2",function(h,Z,X){var S;return L(this.modifier)||this.$raise(r("ParseError")),S=x(h),this.$parsed(null==S[0]?i:S[0],null==S[2]?i:S[2],null==S[1]?i:S[1],null==S[3]?i:S[3])}),w(u,"$_reduce_3",function(h,Z,X){var S,_e;return _e=null==(S=x(h))[2]?i:S[2],this.$parsed(null==S[0]?i:S[0],null==S[1]?i:S[1],D(D(r("Arithmetic"),"Node"),"Number").$new(0),_e)}),w(u,"$_reduce_4",function(h,Z,X){var S=this;return L(S.prefix_number)&&L(S.suffix_number)||S.$raise(r("ParseError")),W(["command","prefix","suffix"],{command:h["$[]"](1),prefix:h["$[]"](0),suffix:h["$[]"](2)})}),w(u,"$_reduce_5",function(h,Z,X){var S=this;return L(S.prefix_number)||S.$raise(r("ParseError")),L(S.need_suffix_number)&&S.$raise(r("ParseError")),W(["command","prefix"],{command:h["$[]"](1),prefix:h["$[]"](0)})}),w(u,"$_reduce_6",function(h,Z,X){var S=this;return L(S.suffix_number)||S.$raise(r("ParseError")),L(S.need_prefix_number)&&S.$raise(r("ParseError")),W(["command","suffix"],{command:h["$[]"](0),suffix:h["$[]"](1)})}),w(u,"$_reduce_7",function(h,Z,X){var S=this;return(L(S.need_prefix_number)||L(S.need_suffix_number))&&S.$raise(r("ParseError")),W(["command"],{command:h["$[]"](0)})}),w(u,"$_reduce_8",function(h,Z,X){return W([],{})}),w(u,"$_reduce_9",function(h,Z,X){var S,_e,ee=i;return ee=null==(S=x(h))[0]?i:S[0],_e=null==S[2]?i:S[2],L(this.critical)&&L(ee["$[]"]("critical")["$nil?"]())||this.$raise(r("ParseError")),ee["$[]="]("critical",_e),ee}),w(u,"$_reduce_10",function(h,Z,X){var S,_e,ee=i;return ee=null==(S=x(h))[0]?i:S[0],_e=null==S[2]?i:S[2],L(this.fumble)&&L(ee["$[]"]("fumble")["$nil?"]())||this.$raise(r("ParseError")),ee["$[]="]("fumble",_e),ee}),w(u,"$_reduce_11",function(h,Z,X){var S,_e,ee=i;return ee=null==(S=x(h))[0]?i:S[0],_e=null==S[2]?i:S[2],L(this.dollar)&&L(ee["$[]"]("dollar")["$nil?"]())||this.$raise(r("ParseError")),ee["$[]="]("dollar",_e),ee}),w(u,"$_reduce_12",function(h,Z,X){return h["$[]"](1)}),w(u,"$_reduce_13",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"Negative").$new(h["$[]"](1))}),w(u,"$_reduce_14",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"+",h["$[]"](2))}),w(u,"$_reduce_15",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"-",h["$[]"](2))}),w(u,"$_reduce_16",function(h,Z,X){return L(this.allowed_cmp_op["$include?"](i))||this.$raise(r("ParseError")),W([],{})}),w(u,"$_reduce_17",function(h,Z,X){var S,ee,J;return J=null==(S=x(h))[1]?i:S[1],L(this.allowed_cmp_op["$include?"](ee=null==S[0]?i:S[0]))||this.$raise(r("ParseError")),W(["cmp_op","target"],{cmp_op:ee,target:J})}),w(u,"$_reduce_18",function(h,Z,X){var O,S=this;return O=h["$[]"](0),L(S.question_target)||S.$raise(r("ParseError")),L(S.allowed_cmp_op["$include?"](O))||S.$raise(r("ParseError")),W(["cmp_op","target"],{cmp_op:O,target:"?"})}),w(u,"$_reduce_19",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"+",h["$[]"](2))}),w(u,"$_reduce_20",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"-",h["$[]"](2))}),w(u,"$_reduce_22",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"BinaryOp").$new(h["$[]"](0),"*",h["$[]"](2))}),w(u,"$_reduce_23",function(h,Z,X){return h["$[]"](3).$new(h["$[]"](0),h["$[]"](2))}),w(u,"$_reduce_25",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(u,"$_reduce_26",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithCeil")}),w(u,"$_reduce_27",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithCeil")}),w(u,"$_reduce_28",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithRound")}),w(u,"$_reduce_29",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"DivideWithFloor")}),w(u,"$_reduce_30",function(h,Z,X){return h["$[]"](1)}),w(u,"$_reduce_31",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"Negative").$new(h["$[]"](1))}),w(u,"$_reduce_33",function(h,Z,X){return h["$[]"](1)}),w(u,"$_reduce_34",function(h,Z,X){return D(D(r("Arithmetic"),"Node"),"Number").$new(h["$[]"](0))}),w(u,"$_reduce_none",function(h,Z,X){return h["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var N,U,B,a,m,i,x,j,G=e.module,M=e.send,_=e.eqeqeq,A=e.truthy,E=e.def,q=e.return_val,F=[],R=e.nil;return N=F,U=j=[G(F[0],"BCDice")].concat(N),B=x=[G(j[0],"Deprecated")].concat(U),m=[a=G(x[0],"Checker")].concat(B),i=e.$r(m),a.$private(),E(a,"$check_result_legacy",function(t,c,b,C){var g,T=this,I=R,y=R,o=R,v=R;return I=M(c,"map",[],"sides".$to_proc()),g=(y=M(c,"map",[],"value".$to_proc())).$sum(),o=_([100],v=I)?T.$check_1D100(t,g,b,C):_([20],v)?T.$check_1D20(t,g,b,C):_([6,6],v)?T.$check_2D6(t,g,y,b,C):R,(A(o["$nil?"]())||A(o["$empty?"]()))&&(o=_([10],v=I.$uniq())?T.$check_nD10(t,g,y,b,C):_([6],v)?T.$check_nD6(t,g,y,b,C):R,A(o["$nil?"]())||A(o["$empty?"]()))?R:i("Result").$new(o.$delete_prefix(" \uff1e "))}),E(a,"$check_1D100",q(R)),E(a,"$check_1D20",q(R)),E(a,"$check_nD10",q(R)),E(a,"$check_2D6",q(R)),E(a,"$check_nD6",q(R))},Opal.modules["bcdice/base"]=function(e){var m,T,v,P,r,p,s,f,u,k,y,G=e.module,M=e.klass,_=e.slice,A=e.rb_plus,E=e.truthy,q=e.def,F=e.regexp,R=e.send,w=e.thrower,N=e.return_ivar,H=e.assign_ivar_val,j=e.eqeqeq,z=e.eqeq,U=e.return_val,L=e.range,x=e.rb_minus,W=e.rb_divide,B=e.rb_times,a=e.rb_ge,i=e.top,D=[],t=e.$r(D),c=e.nil,b=e.$$$;return i.$require("i18n"),i.$require("i18n/backend/fallbacks"),i.$require("bcdice/randomizer"),i.$require("bcdice/dice_table"),i.$require("bcdice/enum"),i.$require("bcdice/translate"),i.$require("bcdice/result"),i.$require("bcdice/command/parser"),i.$require("bcdice/deprecated/checker"),T=D,v=y=[G(D[0],"BCDice")].concat(T),f=[s=M(y[0],null,"Base")].concat(v),u=e.$r(f),(k=s.$$prototype).raw_input=k.randomizer=k.enabled_upcase_input=k.debug=c,r=[P=e.get_singleton_class(s)].concat(f),p=e.$r(r),P.$attr_reader("prefixes"),q(P,"$register_prefix",function(d){var Y,V,Q=this;return null==Q.prefixes&&(Q.prefixes=c),Y=_(arguments),Q.prefixes=A(E(V=Q.prefixes)?V:[],Y.$flatten())},-1),q(P,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),q(P,"$prefixes_pattern",function(){var d=this,$=c;return null==d.prefixes_pattern&&(d.prefixes_pattern=c),null==d.prefixes&&(d.prefixes=c),d.prefixes_pattern=E($=d.prefixes_pattern)?$:c,E(d.prefixes_pattern)?d.prefixes_pattern:(d.prefixes=E($=d.prefixes)?$:[],d.prefixes.$freeze(),d.prefixes_pattern=(E(d.prefixes["$empty?"]())?/(?!)/:F(["^(S)?(",d.prefixes.$join("|"),")"],"i")).$freeze())}),q(P,"$command_pattern",function(){var d=this,$=c,Y=c;return null==d.command_pattern&&(d.command_pattern=c),null==d.prefixes&&(d.prefixes=c),d.command_pattern=E($=d.command_pattern)?$:c,E(d.command_pattern)?d.command_pattern:(d.prefixes=E($=d.prefixes)?$:[],d.prefixes.$freeze(),Y=A(R(b(p("CommonCommand"),"COMMANDS"),"map",[],function(V){return null==V&&(V=c),b(V,"PREFIX_PATTERN").$source()}),d.prefixes),d.command_pattern=F(["^S?(",Y.$join("|"),")"],"i").$freeze())}),q(P,"$eval",function(d){try{return w("eval_return"),this.$new(d).$eval()}catch(Q){if(Q===e.t_eval_return)return Q.$v;throw Q}}),s.$include(u("Translate")),s.$include(b(u("Deprecated"),"Checker")),q(s,"$initialize",function(l){var r=this;return r.raw_input=l,r.sort_add_dice=!1,r.sort_barabara_dice=!1,r.d66_sort_type=b(u("D66SortType"),"NO_SORT"),r.enabled_d9=!1,r.round_type=b(u("RoundType"),"FLOOR"),r.sides_implicit_d=6,r.upper_dice_reroll_threshold=c,r.reroll_dice_reroll_threshold=c,r.default_cmp_op=c,r.default_target_number=c,r.enabled_upcase_input=!0,r.locale="ja_jp",r.randomizer=b(u("BCDice"),"Randomizer").$new(),r.debug=!1}),s.$attr_accessor("randomizer"),s.$attr_reader("d66_sort_type"),s.$attr_reader("round_type"),s.$attr_reader("sides_implicit_d"),s.$attr_reader("upper_dice_reroll_threshold"),s.$attr_reader("reroll_dice_reroll_threshold"),s.$attr_reader("default_cmp_op"),s.$attr_reader("default_target_number"),q(s,"$sort_add_dice?",N("sort_add_dice")),q(s,"$sort_barabara_dice?",N("sort_barabara_dice")),q(s,"$enabled_d9?",N("enabled_d9")),q(s,"$enable_debug",H("debug",!0)),q(s,"$eval",function(){var r,n,l=this,p=c;return r=b(u("BCDice"),"Preprocessor").$process(l.raw_input,l),p=E(n=l.$dice_command(r))?n:l.$eval_common_command(l.raw_input),E(p)?(p["$rands="](l.randomizer.$rand_results()),p["$detailed_rands="](l.randomizer.$detailed_rand_results()),p):c}),q(s,"$change_text",function(l){return l}),q(s,"$check_result",function(l,r,p,n){var d=this,$=c,Y=c,Q=c,V=c,ne=c;return $=d.$check_result_legacy(l,r,p,n),E($)?$:(Y=R(r,"map",[],"sides".$to_proc()),V=(Q=R(r,"map",[],"value".$to_proc())).$sum(),$=j([100],ne=Y)?d.$result_1d100(l,V,p,n):j([20],ne)?d.$result_1d20(l,V,p,n):j([6,6],ne)?d.$result_2d6(l,V,Q,p,n):c,z($,u("Result").$nothing())?c:E($)?$:($=j([10],ne=Y.$uniq())?d.$result_nd10(l,V,Q,p,n):j([6],ne)?d.$result_nd6(l,V,Q,p,n):c,z($,u("Result").$nothing())?c:E($)?$:d.$result_ndx(l,p,n)))}),q(s,"$grich_text",U(c)),s.$private(),q(s,"$eval_common_command",function(l){try{w("eval_return");var p=w("return");return l=this.$change_text(l),R(b(u("CommonCommand"),"COMMANDS"),"each",[],function d($){var Q,Y=null==d.$$s?this:d.$$s;if(null==Y.randomizer&&(Y.randomizer=c),null==$&&($=c),Q=$.$eval(l,Y,Y.randomizer),!E(Q))return c;p.$throw(Q)},{$$s:this,$$ret:p}),c}catch(d){if(d===e.t_eval_return||d===p)return d.$v;throw d}}),q(s,"$dice_command",function(l){var r=this,p=c,n=c,d=c,$=c;return E(r.enabled_upcase_input)&&(l=l.$upcase()),p=r.$class().$prefixes_pattern().$match(l),E(p)?(n=p["$[]"](1)["$nil?"]()["$!"](),E(n)&&(l=l["$[]"](L(1,-1,!1))),d=r.$eval_game_system_specific_command(l),E(d["$is_a?"](u("Result")))?(d["$secret="](E($=d["$secret?"]())?$:n),d):E(d["$nil?"]())||E(d["$empty?"]())||z(d,"1")?c:R(u("Result").$new(),"tap",[],function(Q){var V;return null==Q&&(Q=c),Q["$text="](d.$to_s()),R(Q,"secret=",V=[n]),V[V.length-1]})):c}),q(s,"$eval_game_system_specific_command",U(c)),q(s,"$result_ndx",function(l,r,p){return E(p["$is_a?"](u("String")))?c:E(l.$send(r,p))?u("Result").$success(this.$translate("success")):u("Result").$failure(this.$translate("failure"))}),q(s,"$result_1d100",U(c)),q(s,"$result_1d20",U(c)),q(s,"$result_nd10",U(c)),q(s,"$result_2d6",U(c)),q(s,"$result_nd6",U(c)),q(s,"$get_table_by_2d6",function(l){return this.$get_table_by_nD6(l,2)}),q(s,"$get_table_by_1d6",function(l){return this.$get_table_by_nD6(l,1)}),q(s,"$get_table_by_nD6",function(l,r){return this.$get_table_by_nDx(l,r,6)}),q(s,"$get_table_by_nDx",function(l,r,p){var d,$=c;return d=this.randomizer.$roll_sum(r,p),$=this.$get_table_value(l["$[]"](x(d,r))),E($["$nil?"]())?["1",0]:[$,d]}),q(s,"$get_table_by_1d3",function(l){var n,d,r=this,$=c;return r.$debug("get_table_by_1d3"),n=r.randomizer.$roll_sum(1,6),r.$debug("num",n),d=W(x(n,1),2).$to_i(),r.$debug("index",d),$=l["$[]"](d),E($["$nil?"]())?["1",0]:[$,n]}),q(s,"$get_table_by_d66_swap",function(l){var p;return p=this.randomizer.$roll_d66(b(u("D66SortType"),"ASC")),[this.$get_table_by_number(p,l),p]}),q(s,"$get_table_by_d66",function(l){var p,n,d,Y,$=c;return p=this.randomizer.$roll_once(6),n=this.randomizer.$roll_once(6),d=A(B(x(p,1),6),x(n,1)),$=l["$[]"](d),Y=""+p+n,E($["$nil?"]())?["1",Y]:[$,Y]}),q(s,"$get_table_by_number",function(l,r,p){try{var n=w("return");return null==p&&(p="1"),R(r,"each",[],function $(Y){var V,Q=null==$.$$s?this:$.$$s;if(null==Y&&(Y=c),V=Y["$[]"](0),!E(a(V,l)))return c;n.$throw(Q.$get_table_value(Y["$[]"](1)))},{$$s:this,$$ret:n}),this.$get_table_value(p)}catch($){if($===n)return $.$v;throw $}},-3),q(s,"$get_table_value",function(l){return E(l["$is_a?"](u("Proc")))?l.$call():l}),q(s,"$roll_tables",function(l,r){var n=c;return n=r["$[]"](l),E(n)?n.$roll(this.randomizer).$to_s():c}),q(s,"$debug",function(l,r){var n,d=this,$=c,Y=c;return n=_(arguments,1),E(d.debug)?($=E(l["$is_a?"](u("String")))?l:l.$inspect(),E(n["$empty?"]())?d.$warn($):(Y=R(n,"map",[],function(V){return null==V&&(V=c),E(V["$is_a?"](u("String")))?'"'+V+'"':V.$inspect()}),d.$warn($+": "+Y.$join(", ")))):c},-2),b(b(t("I18n"),"Backend"),"Simple").$include(b(b(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),t("I18n")["$default_locale="]("ja_jp"),m=[["ja_jp"]],R(t("I18n").$fallbacks(),"defaults=",m),m[m.length-1]},Opal.queue(function(e){var i,b,o,v,s,f,T,I,t,G=e.module,M=e.klass,_=e.const_set,A=e.hash2,E=e.send2,q=e.find_super,F=e.def,R=e.truthy,w=e.to_ary,N=e.rb_plus,H=e.range,j=e.neqeq,z=e.eqeq,U=e.rb_ge,L=e.rb_minus,W=[],B=e.nil,a=e.$$$;return e.top.$require("bcdice/base"),i=W,b=t=[G(W[0],"BCDice")].concat(i),T=[G(t[0],"GameSystem")].concat(b),I=e.$r(T),o=T,s=[v=M(T[0],I("Base"),"DesperateRun")].concat(o),f=e.$r(s),v.$$prototype.randomizer=B,_(s[0],"ID","DesperateRun"),_(s[0],"NAME","Desperate Run TRPG"),_(s[0],"SORT_KEY","\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG"),_(s[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868\u3000ACT\n\u30fb\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868\u3000ITEMT\n\u30fb\u52d5\u6a5f\u8868\u3000DOUKIT\n\u30fb\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868\u3000FLAGT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868\u3000ENTRYT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3000ROADT\n"),_(s[0],"TABLES",A(["ACT","ITEMT","DOUKIT","FLAGT","ENTRYT","ROADT"],{ACT:a(f("DiceTable"),"Table").$new("\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868","1D6",["PC\u5168\u54e1\u3001\u968a\u5217\u30921D6\u3067\u6c7a\u3081\u308b\uff0812\uff1a\u524d\u5217\u300134\uff1a\u4e2d\u5217\u300156\uff1a\u5f8c\u5217\uff09","1\u30bf\u30fc\u30f3\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u5074\u306e\u307f\u884c\u52d5\u3059\u308b\u3002","\u3053\u306e\u6226\u95d8\u306e\u884c\u52d5\u9806\u304c\u3001PC\u2192\u30e2\u30f3\u30b9\u30bf\u30fc\u3001\u304b\u3089\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u2192PC\u306b\u5909\u308f\u308b\u3002","PC\u5168\u54e1\u3001\u30a2\u30a4\u30c6\u30e01\u3064\u3092\u9078\u3093\u3067\u5931\u3046\u3002","PC\u5168\u54e11D6\u3092\u632f\u308b\u3002\u3053\u306e\u6226\u95d8\u4e2d\u3001\u305d\u306e\u51fa\u76ee\u306f\u30ce\u30fc\u30d7\u30e9\u30f3\u306b\u306a\u308b\u3002","PC\u5168\u54e1\u3001Flag\u304c1\u5897\u52a0\u3059\u308b\u3002"]),ITEMT:a(f("DiceTable"),"Table").$new("\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868","2D6",["\u30ed\u30b1\u30c3\u30c8\u30e9\u30f3\u30c1\u30e3\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30de\u30ab\u30d6\u30ebLv+3\u3000\u56de\u6570\uff1a\u653b\u64831\u56de","\u30ad\u30fc\u30d4\u30c3\u30af\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002\u5224\u5b9a\u306e\u51fa\u76ee\u306e\u5408\u8a08+1\u3000\u56de\u6570\uff1a2\u56de","\u30ec\u30fc\u30c0\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ce\u30fc\u30d7\u30e9\u30f3\u3000\u88c5\u5099\u6642\u3001\u300c\u5371\u967a\u300d\u30921\u6e1b\u3089\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3000\u56de\u6570\uff1a\u5371\u967a\u6e1b\u5c112\u56de","\u98df\u6599\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002Life3\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u5fdc\u6025\u30ad\u30c3\u30c8\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30e1\u30c7\u30a3\u30ab\u30ebLv+1\u3000\u56de\u6570\uff1a\u56de\u5fa93\u56de","\u5203\u7269\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30a2\u30bf\u30c3\u30afLv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u9283\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30b7\u30e5\u30fc\u30c8Lv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u30c9\u30e9\u30c3\u30b0\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u3044\u3064\u3067\u3082\u4f7f\u7528\u53ef\u3002Brave1\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u91d1\u5238\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30a2\u30d5\u30bf\u30fc\u30d7\u30ec\u30a4\u3067\u4f7f\u7528\u53ef\u3002\u7d4c\u9a13\u70b9+2\u3000\u56de\u6570\uff1a1\u56de","\u30d7\u30ed\u30c6\u30af\u30bf\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ac\u30fc\u30c9Lv+1\u3000\u56de\u6570\uff1a\u9632\u5fa15\u56de","\u30c8\u30df\u30fc\u30ac\u30f3\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30c1\u30a7\u30fc\u30f3Lv+5\u3000\u56de\u6570\uff1a\u653b\u64831\u56de"]),DOUKIT:a(f("DiceTable"),"Table").$new("\u52d5\u6a5f\u8868","1D6",["\u96b7\u5c5e\u3002\u4f55\u304b\u5f31\u307f\u306b\u4ed8\u3051\u8fbc\u307e\u308c\u3001\u5acc\u3005\u306a\u304c\u3089\u3082\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u308b\u3002\u5f8c\u308d\u3081\u305f\u3044\u4e8b\u3001\u501f\u91d1\u3001\u306a\u3069\u3002","\u732e\u8eab\u3002\u3053\u306e\u756a\u7d44\u306f\u8ab0\u304b\u306e\u305f\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\u75c5\u6c17\u306e\u5bb6\u65cf\u3092\u6551\u3046\u305f\u3081\u3001\u53c2\u52a0\u8005\u306e\u4e00\u4eba\u304c\u604b\u4eba\u3067\u3042\u308b\u3001\u306a\u3069\u3002","\u6210\u884c\u3002\u671b\u3093\u3067\u3044\u306a\u3044\u306e\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u8ab0\u304b\u304c\u52dd\u624b\u306b\u7533\u3057\u8fbc\u3093\u3060\u3001\u7d1b\u308c\u8fbc\u3093\u3067\u3057\u307e\u3063\u305f\u3001\u306a\u3069\u3002","\u6e07\u671b\u3002\u3068\u306b\u304b\u304f\u4f55\u304b\u3092\u6b32\u3057\u3066\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\u91d1\u3001\u30b9\u30ea\u30eb\u3001\u91d1\u3067\u624b\u306b\u5165\u308b\u3082\u306e\u3001\u306a\u3069\u3002","\u5947\u4eba\u3002\u597d\u304d\u597d\u3093\u3067\u3053\u306e\u756a\u7d44\u306b\u51fa\u3066\u3044\u308b\u3002\u6bba\u4eba\u7656\u3001\u30ca\u30eb\u30b7\u30b9\u30c8\u3001\u81ea\u6bba\u9858\u671b\u3001\u5316\u3051\u7269\u30de\u30cb\u30a2\u3001\u306a\u3069\u3002","\u4ed5\u4e8b\u3002\u3053\u306e\u756a\u7d44\u306b\u51fa\u308b\u306e\u306f\u4ed5\u4e8b\u3060\u304b\u3089\u3060\u3002\u8cde\u91d1\u7a3c\u304e\u3001\u82b8\u80fd\u4eba\u3001\u8a18\u8005\u3001\u756a\u7d44\u30b9\u30bf\u30c3\u30d5\u3001\u306a\u3069\u3002"]),FLAGT:a(f("DiceTable"),"Table").$new("\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868","1D6",["\u5e0c\u671b\u3002\u300c\u3053\u308c\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u4e00\u7dd2\u306b\u9152\u3067\u3082\u98f2\u3082\u3046\u3084\u300d\u300c\u3082\u3046\u4f55\u3082\u6016\u304f\u306a\u3044\u300d\u306a\u3069\u3002","\u671b\u90f7\u3002\u300c\u304f\u305d\u3063\u3001\u3001\u3001\u4ffa\u306b\u306f\u3001\u5e30\u308a\u3092\u5f85\u3064\u4eba\u304c\u3001\u3001\u3001\u3063\uff01\u300d\u300c\u3042\u3042\u3001\u6545\u90f7\u306e\u30de\u30eb\u30b2\u30ea\u30fc\u30bf\u3092\u3082\u3046\u4e00\u5ea6\u98df\u3079\u305f\u304b\u3063\u305f\u3001\u3001\u3001\u300d\u306a\u3069\u3002","\u72c2\u4e71\u3002\u300c\u304a\u524d\u3092\u3001\u6bba\u305b\u3070\u3001\u4ffa\u306f\u3001\u5104\u4e07\u9577\u8005\u306a\u3093\u3060\u3088\u3049\u3049\u3049\u304a\uff01\uff01\u300d\u300c\u30d2\u30cf\u30c3\u3001\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u3047\u3047\u3047\u3047\u300d\u306a\u3069\u3002","\u7d76\u671b\u3002\u300c\u3082\u3046\u3060\u3081\u3060\u3041\u3001\u3001\u3001\u304a\u3057\u307e\u3044\u3060\u3041\u3001\u3001\u3001\u300d\u300c\u304f\u3001\u304f\u308b\u306a\u3063\u3001\u304f\u308b\u306a\u3041\u3041\u3041\u3041\uff01\uff01\u300d\u306a\u3069\u3002","\u6162\u5fc3\u3002\u300c\u306a\u3093\u3060\u3001\u3053\u3093\u306a\u3084\u3064\u3001\u4ffa\u3060\u3051\u3067\u5341\u5206\u3060\u300d\u300c\u5927\u4e08\u592b\u3060\u3001\u554f\u984c\u306a\u3044\u300d\u306a\u3069\u3002","\u72a0\u7272\u3002\u300c\u3075\u3075\u3001\u4ffa\u306a\u3089\u5927\u4e08\u592b\u3060\u3001\u3001\u3001\u6c17\u306b\u3059\u308b\u306a\u300d\u300c\u304a\u524d\u3089\u4e0b\u304c\u308c\u3063\uff01\u3053\u3053\u306f\u4ffa\u306b\u4efb\u305b\u308d\uff01\u300d\u306a\u3069\u3002"]),ENTRYT:a(f("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868","1D6",["\u9045\u523b\u3002\u3082\u3068\u3082\u3068\u53c2\u52a0\u3059\u308b\u4e88\u5b9a\u3060\u3063\u305f\u306e\u3060\u304c\u9045\u308c\u3066\u3057\u307e\u3063\u305f\u3002\u4eca\u304b\u3089\u3067\u3082\u8d70\u308c\u3068\u7121\u7406\u77e2\u7406\u53c2\u52a0\u3002","\u73fe\u4f4f\u3002\u3082\u3068\u3082\u3068\u3053\u3053\u306b\u4f4f\u3093\u3067\u3044\u305f\u3002\u4f55\uff1f\u756a\u7d44\uff1f\u3048\uff1f\u3042\u3001\u304a\u91d1\u3082\u3089\u3048\u3093\u306e\uff1f\u30a4\u30a4\u30cd\uff01","\u7a81\u767a\u3002\u3082\u3068\u3082\u3068\u8996\u8074\u8005\u3068\u3057\u3066\u30b9\u30bf\u30b8\u30aa\u306b\u5c45\u305f\u3093\u3060\u3051\u3069\u3001\u53f8\u4f1a\u306b\u3046\u307e\u304f\u4e57\u305b\u3089\u308c\u3066\u30fb\u30fb\u30fb","\u4e71\u5165\u3002\u4f55\u304b\u76ee\u7684\u304c\u3042\u3063\u3066\u4e71\u5165\u3057\u305f\u3002\u4eca\u56de\u306e\u30b9\u30c6\u30fc\u30b8\u304c\u7c21\u5358\u306b\u898b\u3048\u305f\u308a\u3001\u53c2\u52a0\u8005\u306b\u5927\u4e8b\u306a\u4eba\u304c\u3044\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002","\u795e\u96a0\u3002\u4eca\u56de\u3088\u308a\u524d\u306e\u756a\u7d44\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u304c\u884c\u65b9\u4e0d\u660e\u30fb\u6b7b\u3093\u3060\u3068\u601d\u308f\u308c\u3066\u3044\u305f\u3002\u304c\u3002\u541b\u306f\u307e\u3060\u3053\u3053\u306b\u3044\u308b\u3002","\u8077\u54e1\u3002\u3042\u308c\u3001\u9003\u3052\u9045\u308c\u307e\u3057\u305f\uff1f\u3042\u3089\u3042\u3089\u3001\u5927\u5909\u3067\u3059\u306d\u3001\u3057\u3087\u3046\u304c\u306a\u3044\u304b\u3089\u53c2\u52a0\u8005\u3055\u3093\u3068\u4e00\u7dd2\u306b\u8d70\u3063\u3066\u304f\u3060\u3055\u3044\u3002"]),ROADT:a(f("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868","1D6",["\u6b7b\u7dda\u3002\u6b7b\u306c\u304b\u3068\u601d\u3063\u305f\u3002Flag+1","\u602a\u6211\u3002\u75db\u3044\u3002Life-1","\u5931\u610f\u3002\u3069\u3046\u3057\u3066\u3053\u3046\u306a\u3063\u305f\u3002Brave-1\u3002\u6e1b\u3089\u305b\u306a\u3044\u5834\u5408\u3001Flag+1","\u7d1b\u5931\u3002\u3069\u3063\u304b\u3044\u3063\u305f\u3002Item\u3092\u3069\u308c\u304b1\u3064\u6368\u3066\u308b\u3002\u6368\u3066\u308c\u306a\u3044\u5834\u5408\u3001Flag+1","\u8ffd\u5c3e\u3002\u5f8c\u308d\uff01\u5f8c\u308d\u30fc\u3063\uff01\u53c2\u52a0\u958b\u59cb\u90e8\u5c4b\u306e\u5371\u967a+1","\u8ff7\u5b50\u3002\u3042\u308c\u3001\u3053\u3053\u3069\u3053\u3060\uff1f\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3092\u632f\u308b\u56de\u6570+2"])}).$freeze()),v.$register_prefix("RC","DDC",f("TABLES").$keys()),F(v,"$initialize",function k(P){var r=this;return k.$$p=null,E(r,q(r,"initialize",k,!1,!0),"initialize",[P],null),r.sort_add_dice=!0,r.d66_sort_type=a(f("D66SortType"),"ASC")}),v.$private(),F(v,"$eval_game_system_specific_command",function(P){var r,p,l=this;return R(r=R(p=l.$check_roll(P))?p:l.$ddc_table(P))?r:l.$roll_tables(P,a(l.$class(),"TABLES"))}),F(v,"$check_roll",function(P){var l,r,d=B,$=B,Y=B,Q=B,V=B,ne=B,$e=B,ue=B,ie=B;return d=a(f("Command"),"Parser").$new(/RC\d+/,A(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to(B).$parse(P),R(d)?(r=this.randomizer.$roll_barabara(2,6),l=w(r),Q=N($=null==l[0]?B:l[0],Y=null==l[1]?B:l[1]),V=N(N($,Y),d.$modify_number()),ne=d.$command()["$[]"](H(2,-1,!1)).$to_i(),j(d.$modify_number(),0)&&($e="\u3000\u4fee\u6b63\u5024\uff1a"+d.$modify_number()),ie=["\u5224\u5b9a\u3000\u96e3\u6613\u5ea6\uff1a"+ne+$e,"\u51fa\u76ee\uff1a"+$+"\u3001"+Y,(ue=z($,Y)?f("Result").$critical("\u30be\u30ed\u76ee\uff01\u3010Critical\u3011"):z(Q,7)?f("Result").$fumble("\u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304c\u8868\u88cf\uff01\u3010Fumble\u3011"):R(U(V,ne))?f("Result").$success(V+"\u3001\u96e3\u6613\u5ea6\u4ee5\u4e0a\uff01\u3010Success\u3011"):f("Result").$failure(V+"\u3001\u96e3\u6613\u5ea6\u672a\u6e80\uff01\u3010Miss\u3011")).$text()],ue["$text="](ie.$join(" \uff1e ")),ue):B}),F(v,"$ddc_table",function(P){var l,r,n=B,d=B,$=B,Y=B,Q=B;return j(P,"DDC")?B:(r=this.randomizer.$roll_barabara(2,6),r=[n=null==(l=w(r))[0]?B:l[0],d=null==l[1]?B:l[1]].$sort(),"\u96e3\u6613\u5ea6\u6c7a\u5b9a \uff1e \u51fa\u76ee\uff1a"+n+"\u3001"+d+" \uff1e "+(Y=null==(l=w(r))[1]?B:l[1])+"-"+($=null==l[0]?B:l[0])+"="+(Q=L(Y,$))+" \uff1e \u96e3\u6613\u5ea6"+N(5,Q))})})}}]);