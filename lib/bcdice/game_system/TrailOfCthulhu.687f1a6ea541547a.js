(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[563],{8238:(W,X,k)=>{k(5151),Opal.queue(function(n){var L,Y,V,o,m,d,E,C,J,w,y=n.module,x=n.klass,v=n.const_set,z=n.send2,D=n.find_super,b=n.def,u=n.truthy,A=n.rb_plus,g=n.send,I=n.rb_gt,j=n.rb_ge,H=n.thrower,N=n.eqeq,S=n.neqeq,p=n.rb_minus,R=n.range,q=[],e=n.nil,B=n.$$$;return L=q,Y=w=[y(q[0],"BCDice")].concat(L),C=[y(w[0],"GameSystem")].concat(Y),J=n.$r(C),V=C,m=[o=x(C[0],J("Base"),"TrailOfCthulhu")].concat(V),d=n.$r(m),(E=o.$$prototype).round_type=E.randomizer=e,v(m[0],"ID","TrailOfCthulhu"),v(m[0],"NAME","\u30c8\u30ec\u30a4\u30eb\u30fb\u30aa\u30d6\u30fb\u30af\u30c8\u30a5\u30eb\u30fc"),v(m[0],"SORT_KEY","\u3068\u308c\u3044\u308b\u304a\u3075\u304f\u3068\u3046\u308b\u3046"),v(m[0],"HELP_MESSAGE","\u25a0\u6280\u80fd\u5224\u5b9a\u3000TCb[>=t]   b:\u6d88\u8cbb\u30d7\u30fc\u30eb\u30fb\u30dd\u30a4\u30f3\u30c8 t:\u96e3\u6613\u5ea6(\u7701\u7565\u53ef\u80fd)\n\n\u4f8b)TC2>=5:\u6d88\u8cbb\u30d7\u30fc\u30eb\u30fb\u30dd\u30a4\u30f3\u30c82,\u96e3\u6613\u5ea65\u3067\u6280\u80fd\u5224\u5b9a\u3057\u3001\u305d\u306e\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\u3002\n   TC>=3: \u96e3\u6613\u5ea63\u3067\u6280\u80fd\u5224\u5b9a\u3057\u3001\u305d\u306e\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\u3002\n   TC:    \u96e3\u6613\u5ea6\u6307\u5b9a\u305b\u305a\u306b\u6280\u80fd\u5224\u5b9a\u3059\u308b\u3002\n   TC3:   \u6d88\u8cbb\u30d7\u30fc\u30eb\u30fb\u30dd\u30a4\u30f3\u30c83,\u96e3\u6613\u5ea6\u6307\u5b9a\u305b\u305a\u306b\u6280\u80fd\u5224\u5b9a\u3059\u308b\u3002\n\n\u25a0\u795e\u8a71\u7684\u72c2\u6c17\u8868\u3000MMT[a,b]   a,b:\u9664\u5916\u3059\u308b\u795e\u8a71\u7684\u72c2\u6c17(\u7701\u7565\u6642\u306f\u5168\u795e\u8a71\u7684\u72c2\u6c17\u3092\u8868\u793a\u3059\u308b)\n\n\u4f8b)MMT[1,8]: \u795e\u8a71\u7684\u72c2\u6c17\u306e\u3046\u3061\u30011\u756a\u30688\u756a\u3092\u9664\u5916\u3057\u3066\u30ed\u30fc\u30eb\u3057\u3001\u795e\u8a71\u7684\u72c2\u6c17\u3092\u6c7a\u5b9a\u3059\u308b\u3002\n   MMT2,6:   \u795e\u8a71\u7684\u72c2\u6c17\u306e\u3046\u3061\u30012\u756a\u30686\u756a\u3092\u9664\u5916\u3057\u3066\u30ed\u30fc\u30eb\u3057\u3001\u795e\u8a71\u7684\u72c2\u6c17\u3092\u6c7a\u5b9a\u3059\u308b\u3002\n   MMT:      \u795e\u8a71\u7684\u72c2\u6c17\u30921\u756a\u304b\u30898\u756a\u307e\u3067\u5217\u6319\u3059\u308b\u3002\n\n"),o.$register_prefix("TC","MMT"),b(o,"$initialize",function M(a){var t=this;return M.$$p=null,z(t,D(t,"initialize",M,!1,!0),"initialize",[a],null),t.round_type=B(d("RoundType"),"CEIL")}),b(o,"$eval_game_system_specific_command",function(a){var t;return u(t=this.$resolute_action(a))?t:this.$roll_mythos_madness_table(a)}),o.$private(),b(o,"$resolute_action",function(a){try{H("eval_return");var i=e,r=e,s=e,c=e,_=e;return i=/^TC([+\d]*)(>=(\d+))?/.$match(a),!u(i)||(r=u(i["$[]"](1)["$empty?"]())?0:d("Arithmetic").$eval(i["$[]"](1),this.round_type),u(r["$nil?"]()))?e:(s=i["$[]"](3).$to_i(),c=this.randomizer.$roll_once(6),_=A(c,r),g(d("Result").$new(),"tap",[],function(h){var $,f=e;return null==h&&(h=e),u(I(s,0))?(h["$condition="](j(_,s)),f=["(TC"+r+">="+s+")",c+"+"+r,_.$to_s(),u(h["$success?"]())?"\u6210\u529f":"\u5931\u6557"].$compact()):f=["(TC"+r+")",c+"+"+r,_.$to_s()].$compact(),$=[f.$join(" \uff1e ")],g(h,"text=",$),$[$.length-1]}))}catch(l){if(l===n.t_eval_return)return l.$v;throw l}}),v(m[0],"MITHOS_MADDNESS",["1:\u5f37\u8feb\u6027\u969c\u5bb3","2:\u6050\u6016\u75c7","3:\u8a87\u5927\u5984\u60f3\u72c2","4:\u6bba\u4eba\u72c2","5:\u6063\u610f\u7684\u8a18\u61b6\u55aa\u5931","6:\u591a\u91cd\u4eba\u683c\u969c\u5bb3","7:\u504f\u57f7\u75c7","8:\u5984\u60f3\u75c7"].$freeze()),b(o,"$roll_mythos_madness_table",function(a){var t=e,i=e,r=e,s=e,c=e,_=e,l=e;if(t=/^MMT(\[?([1-8],[1-8])\]?)?/.$match(a),!u(t))return e;if(i=[],r="",u(t["$[]"](1))){if(s=t["$[]"](2).$split(","),!N(s.$length(),2))return e;for(i=["(MMT["+s.$join(",")+"])"],c=!0;u(c);)_=this.randomizer.$roll_once(8).$to_i(),S(_,s["$[]"](0).$to_i())&&S(_,s["$[]"](1).$to_i())&&(r=d("MITHOS_MADDNESS")["$[]"](p(_,1)),c=!1)}else i=["(MMT)"],l=[],g(R(1,8,!1),"each",[],function($){return null==$&&($=e),l.$push(d("MITHOS_MADDNESS")["$[]"](p($,1)))}),r=l.$join(", ");return g(d("Result").$new(),"tap",[],function($){var f;return null==$&&($=e),i.$push(r),f=[i.$join(" \uff1e ")],g($,"text=",f),f[f.length-1]})})})}}]);