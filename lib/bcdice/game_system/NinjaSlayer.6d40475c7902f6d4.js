(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[9991],{6130:(oe,le,_e)=>{_e(5151),Opal.modules["racc/parser"]=function(n){var K,X,C,G=n.module,E=n.klass,i=n.truthy,D=n.const_set,M=n.defs,T=n.gvars,F=n.rb_lt,z=n.def,N=n.to_ary,A=n.send,Z=n.neqeq,Q=n.rb_plus,g=n.eqeq,v=n.rb_ge,O=n.rb_gt,h=n.rb_minus,re=n.rb_le,m=n.rb_times,c=n.assign_ivar_val,b=[],j=n.$r(b),r=n.nil,ee=n.$$$;return K=b,X=[G(b[0],"Racc")].concat(K),C=n.$r(X),E(X[0],C("StandardError"),"ParseError"),i(ee("::","ParseError","skip_raise")?"constant":r)||D(b[0],"ParseError",ee(j("Racc"),"ParseError")),function(ne,K){var R,u,p,d,l,C=[G(ne,"Racc")].concat(K),te=n.$r(C);return i(te("Racc_No_Extensions","skip_raise")?"constant":r)||D(C[0],"Racc_No_Extensions",!1),R=C,p=[u=E(C[0],null,"Parser")].concat(R),d=n.$r(p),(l=u.$$prototype).yydebug=l.racc_debug_out=l.racc_error_status=l.racc_t=l.racc_vstack=l.racc_val=l.racc_state=l.racc_tstack=r,D(p[0],"Racc_Runtime_Version","1.4.6"),D(p[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),D(p[0],"Racc_Runtime_Core_Version_R","1.4.6"),D(p[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),D(p[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),D(p[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),D(p[0],"Racc_Runtime_Core_Version",d("Racc_Runtime_Core_Version_R")),D(p[0],"Racc_Runtime_Core_Revision",d("Racc_Runtime_Core_Revision_R")),D(p[0],"Racc_Runtime_Type","ruby"),M(d("Parser"),"$racc_runtime_type",function(){return d("Racc_Runtime_Type")}),z(u,"$_racc_setup",function(){var t,_,e=this,o=r,$=r;return null==T.stderr&&(T.stderr=r),i(ee(e.$class(),"Racc_debug_parser"))||(e.yydebug=!1),i(null!=(t=e.yydebug)&&t!==r?"instance-variable":r)||(e.yydebug=!1),i(e.yydebug)&&(i(null!=(_=e.racc_debug_out)&&_!==r?"instance-variable":r)||(e.racc_debug_out=T.stderr),e.racc_debug_out=i(o=e.racc_debug_out)?o:T.stderr),$=ee(e.$class(),"Racc_arg"),i(F($.$size(),14))&&$["$[]="](13,!0),$}),z(u,"$_racc_init_sysvars",function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=r,t.racc_val=r,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0}),z(u,"$do_parse",function(){return this.$__send__(d("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),z(u,"$next_token",function(){return this.$raise(d("NotImplementedError"),this.$class()+"#next_token is not defined")}),z(u,"$_racc_do_parse_rb",function(t,_){var e,$=this,k=r,L=r,y=r,Y=r,V=r,H=r,B=r,f=r;return e=N(t),k=null==e[0]?r:e[0],L=null==e[1]?r:e[1],y=null==e[2]?r:e[2],Y=null==e[3]?r:e[3],V=null==e[10]?r:e[10],$.$_racc_init_sysvars(),H=B=f=r,A($,"catch",["racc_end_parse"],function w(){var U,P,S=null==w.$$s?this:w.$$s,ce=r;for(null==S.racc_state&&(S.racc_state=r),null==S.racc_read_next&&(S.racc_read_next=r),null==S.racc_t&&(S.racc_t=r),null==S.yydebug&&(S.yydebug=r),null==S.racc_val&&(S.racc_val=r);i(!0);)for(i(f=Y["$[]"](S.racc_state["$[]"](-1)))?(i(S.racc_read_next)&&Z(S.racc_t,0)&&(P=S.$next_token(),U=N(P),H=null==U[0]?r:U[0],S.racc_val=null==U[1]?r:U[1],S.racc_t=i(H)?i(ce=V["$[]"](H))?ce:1:0,i(S.yydebug)&&S.$racc_read_token(S.racc_t,H,S.racc_val),S.racc_read_next=!1),f=Q(f,S.racc_t),i(v(f,0))&&i(B=k["$[]"](f))&&g(L["$[]"](f),S.racc_state["$[]"](-1))||(B=y["$[]"](S.racc_state["$[]"](-1)))):B=y["$[]"](S.racc_state["$[]"](-1));i(B=S.$_racc_evalact(B,t)););},{$$s:$})}),z(u,"$yyparse",function(t,_){return this.$__send__(d("Racc_YY_Parse_Method"),t,_,this.$_racc_setup(),!0)}),z(u,"$_racc_yyparse_rb",function(t,_,e,o){var $,L=this,y=r,Y=r,I=r,V=r,B=r,f=r,w=r;return $=N(e),y=null==$[0]?r:$[0],Y=null==$[1]?r:$[1],I=null==$[2]?r:$[2],V=null==$[3]?r:$[3],B=null==$[10]?r:$[10],L.$_racc_init_sysvars(),f=r,w=r,A(L,"catch",["racc_end_parse"],function U(){var P=null==U.$$s?this:U.$$s;for(null==P.racc_state&&(P.racc_state=r);!i(w=V["$[]"](P.racc_state["$[]"](-1)));)for(;i(f=P.$_racc_evalact(I["$[]"](P.racc_state["$[]"](-1)),e)););return A(t,"__send__",[_],function S(ce,ae){var W=null==S.$$s?this:S.$$s,ue=r,ie=r;for(null==W.racc_t&&(W.racc_t=r),null==W.racc_state&&(W.racc_state=r),null==W.racc_read_next&&(W.racc_read_next=r),null==ce&&(ce=r),null==ae&&(ae=r),W.racc_t=i(ce)?i(ue=B["$[]"](ce))?ue:1:0,W.racc_val=ae,W.racc_read_next=!1,w=Q(w,W.racc_t),i(v(w,0))&&i(f=y["$[]"](w))&&g(Y["$[]"](w),W.racc_state["$[]"](-1))||(f=I["$[]"](W.racc_state["$[]"](-1)));i(f=W.$_racc_evalact(f,e)););for(;i(i(ue=i(ie=(w=V["$[]"](W.racc_state["$[]"](-1)))["$!"]())?ie:W.racc_read_next["$!"]())?ue:W.racc_t["$=="](0));)for(i(w)&&i(w=Q(w,W.racc_t))&&i(v(w,0))&&i(f=y["$[]"](w))&&g(Y["$[]"](w),W.racc_state["$[]"](-1))||(f=I["$[]"](W.racc_state["$[]"](-1)));i(f=W.$_racc_evalact(f,e)););},{$$s:P})},{$$s:L})}),z(u,"$_racc_evalact",function(t,_){var e,I,$=this,k=r,L=r,Y=r,V=r,H=r,B=r;if(k=null==(e=N(_))[0]?r:e[0],L=null==e[1]?r:e[1],Y=null==e[3]?r:e[3],I=null==e[11]?r:e[11],V=null==e[12]?r:e[12],i(O(t,0))&&i(F(t,I)))i(O($.racc_error_status,0))&&(g($.racc_t,1)||($.racc_error_status=h($.racc_error_status,1))),$.racc_vstack.$push($.racc_val),$.racc_state.$push(t),$.racc_read_next=!0,i($.yydebug)&&($.racc_tstack.$push($.racc_t),$.$racc_shift($.racc_t,$.racc_tstack,$.racc_vstack));else if(i(F(t,0))&&i(O(t,V["$-@"]()))){if(H=A($,"catch",["racc_jump"],function f(){var w=null==f.$$s?this:f.$$s;return null==w.racc_state&&(w.racc_state=r),w.racc_state.$push(w.$_racc_do_reduce(_,t)),!1},{$$s:$}),i(H))switch(H.valueOf()){case 1:return $.racc_user_yyerror=!0,V["$-@"]();case 2:return I;default:$.$raise("[Racc Bug] unknown jump code")}}else if(g(t,I))i($.yydebug)&&$.$racc_accept(),$.$throw("racc_end_parse",$.racc_vstack["$[]"](0));else{if(g(t,V["$-@"]())){switch($.racc_error_status.valueOf()){case 0:i(_["$[]"](21))||$.$on_error($.racc_t,$.racc_val,$.racc_vstack);break;case 3:g($.racc_t,0)&&$.$throw("racc_end_parse",r),$.racc_read_next=!0}for($.racc_user_yyerror=!1,$.racc_error_status=3;i(!0)&&!(i(B=Y["$[]"]($.racc_state["$[]"](-1)))&&(B=Q(B,1),i(v(B,0))&&i(t=k["$[]"](B))&&g(L["$[]"](B),$.racc_state["$[]"](-1))));)i(re($.racc_state.$size(),1))&&$.$throw("racc_end_parse",r),$.racc_state.$pop(),$.racc_vstack.$pop(),i($.yydebug)&&($.racc_tstack.$pop(),$.$racc_e_pop($.racc_state,$.racc_tstack,$.racc_vstack));return t}$.$raise("[Racc Bug] unknown action "+t.$inspect())}return i($.yydebug)&&$.$racc_next_state($.racc_state["$[]"](-1),$.racc_state),r}),z(u,"$_racc_do_reduce",function(t,_){var e,V,B,ce,ae,W,$e,$=this,L=r,y=r,Y=r,I=r,H=r,f=r,w=r,U=r,P=r,S=r,ue=r,ie=r,se=r;return L=null==(e=N(t))[4]?r:e[4],y=null==e[5]?r:e[5],Y=null==e[6]?r:e[6],I=null==e[7]?r:e[7],V=null==e[8]?r:e[8],H=null==e[9]?r:e[9],B=null==e[13]?r:e[13],f=$.racc_state,w=$.racc_vstack,U=$.racc_tstack,P=m(_,-3),S=H["$[]"](P),ce=H["$[]"](Q(P,1)),ae=H["$[]"](Q(P,2)),W=[],i($.yydebug)&&(ue=U["$[]"](S["$-@"](),S)),ie=w["$[]"](S["$-@"](),S),i($.yydebug)&&U["$[]="](S["$-@"](),S,W),w["$[]="](S["$-@"](),S,W),f["$[]="](S["$-@"](),S,W),i(B)?w.$push($.$__send__(ae,ie,w,ie["$[]"](0))):w.$push($.$__send__(ae,ie,w)),U.$push(ce),i($.yydebug)&&$.$racc_reduce(ue,ce,U,w),$e=h(ce,V),i(P=I["$[]"]($e))&&(P=Q(P,f["$[]"](-1)),i(v(P,0))&&i(se=L["$[]"](P))&&g(y["$[]"](P),$e))?se:Y["$[]"]($e)}),z(u,"$on_error",function(t,_,e){var $,o=this;return o.$raise(d("ParseError"),o.$sprintf("\nparse error on value %s (%s)",_.$inspect(),i($=o.$token_to_str(t))?$:"?"))}),z(u,"$yyerror",function(){return this.$throw("racc_jump",1)}),z(u,"$yyaccept",function(){return this.$throw("racc_jump",2)}),z(u,"$yyerrok",c("racc_error_status",0)),z(u,"$racc_read_token",function(t,_,e){var o=this;return o.racc_debug_out.$print("read    "),o.racc_debug_out.$print(_.$inspect(),"(",o.$racc_token2str(t),") "),o.racc_debug_out.$puts(e.$inspect()),o.racc_debug_out.$puts()}),z(u,"$racc_shift",function(t,_,e){var o=this;return o.racc_debug_out.$puts("shift   "+o.$racc_token2str(t)),o.$racc_print_stacks(_,e),o.racc_debug_out.$puts()}),z(u,"$racc_reduce",function(t,_,e,o){var $=this,k=r;return(k=$.racc_debug_out).$print("reduce "),i(t["$empty?"]())?k.$print(" <none>"):A(t,"each",[],function L(y){return null==y&&(y=r),k.$print(" ",(null==L.$$s?this:L.$$s).$racc_token2str(y))},{$$s:$}),k.$puts(" --\x3e "+$.$racc_token2str(_)),$.$racc_print_stacks(e,o),$.racc_debug_out.$puts()}),z(u,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),z(u,"$racc_e_pop",function(t,_,e){var o=this;return o.racc_debug_out.$puts("error recovering mode: pop token"),o.$racc_print_states(t),o.$racc_print_stacks(_,e),o.racc_debug_out.$puts()}),z(u,"$racc_next_state",function(t,_){var e=this;return e.racc_debug_out.$puts("goto    "+t),e.$racc_print_states(_),e.racc_debug_out.$puts()}),z(u,"$racc_print_stacks",function(t,_){var o=r;return(o=this.racc_debug_out).$print("        ["),A(t,"each_index",[],function $(k){return null==k&&(k=r),o.$print(" (",(null==$.$$s?this:$.$$s).$racc_token2str(t["$[]"](k))," ",_["$[]"](k).$inspect(),")")},{$$s:this}),o.$puts(" ]")}),z(u,"$racc_print_states",function(t){var e=r;return(e=this.racc_debug_out).$print("        ["),A(t,"each",[],function($){return null==$&&($=r),e.$print(" ",$)}),e.$puts(" ]")}),z(u,"$racc_token2str",function(t){var e;return i(e=ee(this.$class(),"Racc_token_to_s_table")["$[]"](t))?e:this.$raise("[Racc Bug] can't convert token "+t+" to string")}),z(u,"$token_to_str",function(t){return ee(this.$class(),"Racc_token_to_s_table")["$[]"](t)})}(b[0],b)},Opal.modules.strscan=function(n){var g,v,O,h,re,E=n.def,i=n.truthy,D=n.eqeqeq,M=n.Opal,T=n.return_ivar,F=n.send,z=n.alias,N=[],A=n.nil;return g=N,O=[v=(0,n.klass)(N[0],null,"StringScanner")].concat(g),h=n.$r(O),(re=v.$$prototype).pos=re.string=re.working=re.matched=re.prev_pos=re.match=A,v.$attr_reader("pos","matched"),E(v,"$initialize",function(c){var s=this;return s.string=c,s.pos=0,s.matched=A,s.working=c,s.match=[]}),v.$attr_reader("string"),E(v,"$beginning_of_line?",function(){var c=this;return 0===c.pos||"\n"===c.string.charAt(c.pos-1)}),E(v,"$scan",function(c){var s=this,b=(c=s.$anchor(c)).exec(s.working);return null==b?s.matched=A:(s.prev_pos=s.pos,s.pos+=b[0].length,s.working=s.working.substring(b[0].length),s.matched=b[0],s.match=b,b[0])}),E(v,"$scan_until",function(c){var s=this;c=s.$anchor(c);for(var b=s.working,j=0;b.length!=j;++j){var r=c.exec(b.substr(j));if(null!==r){var ee=j+r[0].length,ne=b.substr(0,ee);return s.matched=r[0],s.match=r,s.prev_pos=s.pos+j,s.pos+=ee,s.working=b.substr(ee),ne}}return s.matched=A}),E(v,"$[]",function(c){var b;if(i(this.match["$empty?"]()))return A;D(h("Symbol"),b=c)?c=c.$to_s():D(h("String"),b)||(c=M["$coerce_to!"](c,h("Integer"),"to_int"));var j=this.match;return c<0&&(c+=j.length),c<0||c>=j.length||null==j[c]?A:j[c]}),E(v,"$check",function(c){var s=this,b=(c=s.$anchor(c)).exec(s.working);return s.matched=null==b?A:b[0]}),E(v,"$check_until",function(c){var s=this,b=s.prev_pos,j=s.pos,r=s.working,ee=s.$scan_until(c);return s.prev_pos=b,s.pos=j,s.working=r,ee}),E(v,"$peek",function(c){return this.working.substring(0,c)}),E(v,"$eos?",function(){return 0===this.working.length}),E(v,"$exist?",function(c){var b=c.exec(this.working);return null==b?A:0==b.index?0:b.index+1}),E(v,"$skip",function(c){var s=this,b=(c=s.$anchor(c)).exec(s.working);if(null==b)return s.match=[],s.matched=A;var j=b[0],r=j.length;return s.matched=j,s.match=b,s.prev_pos=s.pos,s.pos+=r,s.working=s.working.substring(r),r}),E(v,"$skip_until",function(c){var b=this.$scan_until(c);return b===A?A:(this.matched=b.substr(-1),b.length)}),E(v,"$get_byte",function(){var c=this,s=A;return c.pos<c.string.length?(c.prev_pos=c.pos,c.pos+=1,s=c.matched=c.working.substring(0,1),c.working=c.working.substring(1)):c.matched=A,s}),E(v,"$match?",function(c){var s=this,b=(c=s.$anchor(c)).exec(s.working);return null==b?A:(s.prev_pos=s.pos,b[0].length)}),E(v,"$pos=",function(c){var s=this;return c<0&&(c+=s.string.$length()),s.pos=c,s.working=s.string.slice(c)}),E(v,"$matched_size",function(){return this.matched===A?A:this.matched.length}),E(v,"$post_match",function(){var c=this;return c.matched===A?A:c.string.substr(c.pos)}),E(v,"$pre_match",function(){var c=this;return c.matched===A?A:c.string.substr(0,c.prev_pos)}),E(v,"$reset",function(){var c=this;return c.working=c.string,c.matched=A,c.pos=0}),E(v,"$rest",T("working")),E(v,"$rest?",function(){return 0!==this.working.length}),E(v,"$rest_size",function(){return this.$rest().$size()}),E(v,"$terminate",function(){var c,s=this;return s.match=A,c=[s.string.$length()],F(s,"pos=",c),c[c.length-1]}),E(v,"$unscan",function(){var c=this;return c.pos=c.prev_pos,c.prev_pos=A,c.match=A,c}),z(v,"bol?","beginning_of_line?"),z(v,"getch","get_byte"),v.$private(),E(v,"$anchor",function(c){var s=c.toString().match(/\/([^\/]+)$/);return s=s?s[1]:void 0,new RegExp("^(?:"+c.source+")",s)})},Opal.modules["bcdice/normalize"]=function(n){var z,Q,A,G=n.module,E=n.eqeqeq,i=n.def,D=n.eqeq,M=[],T=n.nil;return z=M,A=[G(M[0],"BCDice")].concat(z),(Q=G(A[0],"Normalize")).$module_function(),i(Q,"$comparison_operator",function(v){var O;return E(/<=|=</,O=v)?"<=":E(/>=|=>/,O)?">=":E(/<>|!=|=!/,O)?"!=":E(/</,O)?"<":E(/>/,O)?">":E(/=/,O)?"==":T}),i(Q,"$target_number",function(v){return D(v,"?")?v:v.$to_i()})},Opal.modules["bcdice/common_command/lexer"]=function(n){var Z,O,s,b,j,r,re,g,G=n.module,E=n.klass,i=n.const_set,D=n.hash2,M=n.truthy,T=n.def,F=n.top,z=[],N=n.nil;return F.$require("strscan"),F.$require("bcdice/normalize"),Z=z,O=g=[G(z[0],"BCDice")].concat(Z),s=re=[G(g[0],"CommonCommand")].concat(O),j=[b=E(re[0],null,"Lexer")].concat(s),r=n.$r(j),b.$$prototype.scanner=N,i(j[0],"SYMBOLS",D(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),T(b,"$initialize",function(K){var X;return K=M(X=K.$split(" ",2).$first())?X:"",this.scanner=r("StringScanner").$new(K)}),T(b,"$next_token",function(){var K=this,J=N,X=N,C=N,x=N;return M(K.scanner["$eos?"]())?[!1,"$"]:M(J=K.scanner.$scan(/\d+/))?["NUMBER",J.$to_i()]:M(X=K.scanner.$scan(/[<>!=]+/))?["CMP_OP",r("Normalize").$comparison_operator(X)]:(C=K.scanner.$getch().$upcase(),[M(x=r("SYMBOLS")["$[]"](C))?x:C.$to_sym(),C])}),T(b,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(n){var m,j,K,te,p,d,l,a,t,q,X,ee,s,G=n.module,E=n.klass,i=n.ensure_kwargs,D=n.get_kwarg,M=n.def,T=n.truthy,F=n.send,z=n.thrower,N=n.rb_lt,A=n.rb_plus,Z=n.rb_gt,Q=n.eqeq,g=n.rb_le,v=n.rb_ge,O=[],h=n.nil;return m=O,j=s=[G(O[0],"BCDice")].concat(m),K=ee=[G(s[0],"CommonCommand")].concat(j),te=X=[G(ee[0],"RerollDice")].concat(K),p=q=[G(X[0],"Node")].concat(te),l=[d=E(q[0],null,"Command")].concat(p),a=n.$r(l),(t=d.$$prototype).cmp_op=t.reroll_cmp_op=t.target_number_node=t.reroll_threshold_node=t.notations=t.source=h,M(d,"$initialize",function(e){var o,$,k,L,y,Y,I,V=this;return e=i(e),o=D(e,"secret"),$=D(e,"notations"),k=D(e,"source"),null==(L=e.$$smap.cmp_op)&&(L=h),null==(y=e.$$smap.target_number)&&(y=h),null==(Y=e.$$smap.reroll_cmp_op)&&(Y=h),null==(I=e.$$smap.reroll_threshold)&&(I=h),V.secret=o,V.notations=$,V.cmp_op=L,V.target_number_node=y,V.reroll_cmp_op=Y,V.reroll_threshold_node=I,V.source=k}),M(d,"$eval",function(e,o){try{z("eval_return");var k,L,Y,I,H,f,w,P,y=this,V=h,B=h,U=h,S=h,ce=h,ae=h,W=h,ue=h;return Y=e.$round_type(),I=T(V=y.cmp_op)?V:e.$default_cmp_op(),H=T(V=T(B=y.reroll_cmp_op)?B:I)?V:">=",f=T(V=(k=y.target_number_node)===h||null==k?h:k.$eval(Y))?V:e.$default_target_number(),w=T(V=T(B=(L=y.reroll_threshold_node)===h||null==L?h:L.$eval(Y))?B:e.$reroll_dice_reroll_threshold())?V:f,U=a("RerollCondition").$new(H,w),P=F(y.notations,"map",[],function($e){return null==$e&&($e=h),$e.$to_dice(Y)}),T(F(P,"all?",[],function($e){return null==$e&&($e=h),U["$valid?"]($e.$sides())}))?(ce=(S=y.$roll(P,o,U,e["$sort_barabara_dice?"]())).$flatten(),ae=S.$take(y.notations.$size()).$flatten().$count(1),W=T(I)?F(ce,"count",[],function($e){return null==$e&&($e=h),$e.$send(I,f)}):0,ue=[y.$expr(Y,U,I,f),F(S,"map",[],function($e){return null==$e&&($e=h),$e.$join(",")}).$join(" + "),"\u6210\u529f\u6570"+W,e.$grich_text(ae,ce.$size(),W)].$compact(),y.$result_with_text(ue.$join(" \uff1e "))):y.$result_with_text(y.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}catch(ie){if(ie===n.t_eval_return)return ie.$v;throw ie}}),d.$private(),M(d,"$roll",function(e,o,$,k){var L=h,y=h,Y=h,I=h,V=h,H=h;for(L=[],y=0;T(T(Y=e["$empty?"]()["$!"]())?N(y,a("REROLL_LIMIT")):Y);)I=e.$shift(),y=A(y,1),V=I.$roll(o),T(k)&&V["$sort!"](),L.$push(V),H=F(V,"count",[],function(f){return null==f&&(f=h),$["$reroll?"](f)}),T(Z(H,0))&&e.$push(a("Dice").$new(H,I.$sides()));return L}),M(d,"$expr",function(e,o,$,k){var y,Y,I;return y=F(this.notations,"map",[],function(H){return null==H&&(H=h),H.$to_dice(e)}).$join("+"),Y=Q(o.$cmp_op(),$)?"":a("Format").$comparison_operator(o.$cmp_op()),I=a("Format").$comparison_operator($),"("+y+"["+Y+o.$threshold()+"]"+I+k+")"}),M(d,"$result_with_text",function(e){return F(a("Result").$new(),"tap",[],function $(k){var L,y=null==$.$$s?this:$.$$s;return null==y.secret&&(y.secret=h),null==k&&(k=h),k["$secret="](y.secret),F(k,"text=",L=[e]),L[L.length-1]},{$$s:this})}),function(R,u){var p=E(R,null,"RerollCondition"),d=p.$$prototype;d.threshold=d.cmp_op=h,p.$attr_reader("cmp_op"),p.$attr_reader("threshold"),M(p,"$initialize",function(a,t){return this.cmp_op=a,this.threshold=t}),M(p,"$valid?",function(a){var t=this;if(!T(t.threshold))return!1;switch(t.cmp_op.valueOf()){case"<=":return N(t.threshold,a);case"<":return g(t.threshold,a);case">=":return Z(t.threshold,1);case">":return v(t.threshold,1);case"!=":return n.Range.$new(1,a,!1)["$include?"](t.threshold);default:return!0}}),M(p,"$reroll?",function(a){return a.$send(this.cmp_op,this.threshold)})}(q[0]),function(R,u,p){var d=E(R,null,"Notation"),l=[d].concat(p),a=n.$r(l),t=d.$$prototype;t.times=t.sides=h,M(d,"$initialize",function(e,o){return this.times=e,this.sides=o}),M(d,"$to_dice",function(e){try{var k,L;return z("eval_return"),k=this.times.$eval(e),L=this.sides.$eval(e),a("Dice").$new(k,L)}catch(y){if(y===n.t_eval_return)return y.$v;throw y}})}(q[0],0,q),function(R,u){var p=E(R,null,"Dice");return p.$attr_reader("times","sides"),M(p,"$initialize",function(l,a){return this.times=l,this.sides=a}),M(p,"$roll",function(l){return l.$roll_barabara(this.$times(),this.$sides())}),M(p,"$to_s",function(){return this.$times()+"R"+this.$sides()})}(q[0])},Opal.modules["bcdice/arithmetic/node"]=function(n){var c,r,J,R,u,C,te,ne,b,G=n.module,E=n.klass,i=n.def,D=n.thrower,M=n.return_ivar,T=n.send2,F=n.find_super,z=n.eqeq,N=n.const_set,A=n.eqeqeq,Z=n.rb_divide,Q=n.truthy,g=n.assign_ivar,v=n.alias,O=[],h=n.nil,re=n.$$$;return c=O,r=b=[G(O[0],"BCDice")].concat(c),J=ne=[G(b[0],"Arithmetic")].concat(r),C=[G(ne[0],"Node")].concat(J),te=n.$r(C),(u=(R=E(C[0],null,"BinaryOp")).$$prototype).lhs=u.rhs=u.op=h,i(R,"$initialize",function(d,l,a){var t=this;return t.lhs=d,t.op=l,t.rhs=a}),i(R,"$eval",function(d){try{D("eval_return");var _,a=this,t=h;return t=a.lhs.$eval(d),_=a.rhs.$eval(d),t.$send(a.op,_)}catch(e){if(e===n.t_eval_return)return e.$v;throw e}}),i(R,"$output",function(){var d=this;return""+d.lhs.$output()+d.op+d.rhs.$output()}),i(R,"$s_exp",function(){var d=this;return"("+d.$op_for_s_exp()+" "+d.lhs.$s_exp()+" "+d.rhs.$s_exp()+")"}),i(R,"$op_for_s_exp",M("op")),function(x,q,R){var u=E(x,q,"DivideBase"),p=[u].concat(R),d=n.$r(p),l=u.$$prototype;l.lhs=l.rhs=l.op=h,i(u,"$initialize",function a(t,_){return a.$$p=null,T(this,F(this,"initialize",a,!1,!0),"initialize",[t,"/",_],null)}),i(u,"$eval",function(t){try{D("eval_return");var o,$,e=this;return o=e.lhs.$eval(t),$=e.rhs.$eval(t),z($,0)&&e.$raise(d("ZeroDivisionError")),e.$divide_and_round(o,$,t)}catch(k){if(k===n.t_eval_return)return k.$v;throw k}}),i(u,"$output",function a(){var t=a.$$p||h,_=this;return a.$$p=null,""+T(_,F(_,"output",a,!1,!0),"output",[],t)+_.$rounding_method()}),u.$private(),i(u,"$rounding_method",function(){return re(this.$class(),"ROUNDING_METHOD")}),i(u,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),i(u,"$divide_and_round",function(t,_,e){return this.$raise(d("NotImplementedError"))})}(C[0],te("BinaryOp"),C),function(x,q,R){var u=E(x,q,"DivideWithGameSystemDefault"),p=[u].concat(R),d=n.$r(p);N(p[0],"ROUNDING_METHOD",""),u.$private(),i(u,"$divide_and_round",function(a,t,_){var e,o=h;return A(re(d("RoundType"),"CEIL"),e=_)?Z(a.$to_f(),t).$ceil():A(re(d("RoundType"),"ROUND"),e)?(o=Z(a.$to_f(),t),Q(o["$negative?"]())?o.$abs().$round()["$-@"]():o.$round()):Z(a,t).$floor()})}(C[0],te("DivideBase"),C),function(x,q,R){var u=E(x,q,"DivideWithCeil"),p=[u].concat(R);N(p[0],"ROUNDING_METHOD","C"),u.$private(),i(u,"$divide_and_round",function(l,a,t){return Z(l.$to_f(),a).$ceil()})}(C[0],te("DivideBase"),C),function(x,q,R){var u=E(x,q,"DivideWithRound"),p=[u].concat(R);N(p[0],"ROUNDING_METHOD","R"),u.$private(),i(u,"$divide_and_round",function(l,a,t){var _=h;return _=Z(l.$to_f(),a),Q(_["$negative?"]())?_.$abs().$round()["$-@"]():_.$round()})}(C[0],te("DivideBase"),C),function(x,q,R){var u=E(x,q,"DivideWithFloor"),p=[u].concat(R);N(p[0],"ROUNDING_METHOD","F"),u.$private(),i(u,"$divide_and_round",function(l,a,t){return Z(l,a).$floor()})}(C[0],te("DivideBase"),C),function(x,q){var R=E(x,null,"Negative");R.$$prototype.body=h,i(R,"$initialize",g("body")),i(R,"$eval",function(d){try{return D("eval_return"),this.body.$eval(d)["$-@"]()}catch(t){if(t===n.t_eval_return)return t.$v;throw t}}),i(R,"$output",function(){return"-"+this.body.$output()}),i(R,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(C[0]),function(x,q){var R=E(x,null,"Parenthesis");R.$$prototype.expr=h,i(R,"$initialize",g("expr")),i(R,"$eval",function(d){try{return D("eval_return"),this.expr.$eval(d)}catch(t){if(t===n.t_eval_return)return t.$v;throw t}}),i(R,"$output",function(){return"("+this.expr.$output()+")"}),i(R,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(C[0]),function(x,q){var R=E(x,null,"Number");return R.$$prototype.value=h,i(R,"$initialize",g("value")),i(R,"$eval",M("value")),i(R,"$output",function(){return this.value.$to_s()}),v(R,"s_exp","output")}(C[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(n){var h,s,ee,te,d,l,a,t,_,e,o,$,k,Y,x,u,p,K,J,j,m,G=n.module,E=n.klass,i=n.defs,D=n.def,M=n.hash,T=n.const_set,F=n.truthy,z=n.hash2,N=n.return_val,A=n.to_ary,Z=n.top,Q=[],g=n.nil,v=n.$$$;return Z.$require("racc/parser.rb"),Z.$require("bcdice/common_command/lexer"),Z.$require("bcdice/common_command/reroll_dice/node"),Z.$require("bcdice/arithmetic/node"),h=Q,s=m=[G(Q[0],"BCDice")].concat(h),ee=j=[G(m[0],"CommonCommand")].concat(s),K=[G(j[0],"BarabaraDice")].concat(ee),J=n.$r(K),te=K,u=[x=E(K[0],v(J("Racc"),"Parser"),"Parser")].concat(te),p=n.$r(u),x.$$prototype.lexer=g,i(x,"$parse",function(f){return this.$new().$parse(f)}),D(x,"$parse",function(f){try{return this.lexer=p("Lexer").$new(f),this.$do_parse()}catch(U){if(!n.rescue(U,[p("ParseError")]))throw U;try{return g}finally{n.pop_exception()}}}),x.$private(),D(x,"$next_token",function(){return this.lexer.$next_token()}),d=n.large_array_unpack("13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14"),l=n.large_array_unpack("5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7"),a=n.large_array_unpack("-6,21,-1,,56,-9,,55,1,,,,6,4,5,-5,24,,18,20,,28,,,30,32,,42,44,,,36,38,,19,,,,,"),t=n.large_array_unpack("-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19"),_=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],e=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],o=[g,1,4,8,11,-5,0,-2,-16,-13,-17],$=[g,g,g,g,g,g,g,20,16,17,g],k=n.large_array_unpack("0,0,racc_error,3,24,_reduce_1,0,25,_reduce_2,1,25,_reduce_3,0,27,_reduce_4,2,27,_reduce_5,3,26,_reduce_6,1,26,_reduce_7,3,29,_reduce_8,3,28,_reduce_9,3,28,_reduce_10,1,28,_reduce_none,3,31,_reduce_12,4,31,_reduce_13,1,31,_reduce_none,0,33,_reduce_15,1,33,_reduce_16,1,33,_reduce_17,1,33,_reduce_18,1,33,_reduce_19,2,32,_reduce_20,2,32,_reduce_21,1,32,_reduce_none,3,30,_reduce_23,1,30,_reduce_24"),Y=M(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),T(u[0],"Racc_arg",[d,l,t,a,_,e,$,o,23,k,Y,40,25,!0]),F(p("Ractor","skip_raise")?"constant":g)&&p("Ractor").$make_shareable(p("Racc_arg")),T(u[0],"Racc_token_to_s_table",n.large_array_unpack("$end,error,NUMBER,B,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,add,dice,term,mul,unary,round_type")),F(p("Ractor","skip_raise")?"constant":g)&&p("Ractor").$make_shareable(p("Racc_token_to_s_table")),T(u[0],"Racc_debug_parser",!1),D(x,"$_reduce_1",function(f,w,U){return v(p("Node"),"Command").$new(z(["secret","notations","cmp_op","target_number"],{secret:f["$[]"](0),notations:f["$[]"](1),cmp_op:f["$[]"](2)["$[]"]("cmp_op"),target_number:f["$[]"](2)["$[]"]("target")}))}),D(x,"$_reduce_2",N(!1)),D(x,"$_reduce_3",N(!0)),D(x,"$_reduce_4",function(f,w,U){return z([],{})}),D(x,"$_reduce_5",function(f,w,U){var P,ae,W;return W=null==(P=A(f))[1]?g:P[1],F(ae=null==P[0]?g:P[0])||this.$raise(p("ParseError")),z(["cmp_op","target"],{cmp_op:ae,target:W})}),D(x,"$_reduce_6",function(f,w,U){var P=g;return(P=f["$[]"](0)).$push(f["$[]"](2)),P}),D(x,"$_reduce_7",function(f,w,U){return[f["$[]"](0)]}),D(x,"$_reduce_8",function(f,w,U){var P,S;return P=f["$[]"](0),S=f["$[]"](2),v(p("Node"),"Notation").$new(P,S)}),D(x,"$_reduce_9",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"BinaryOp").$new(f["$[]"](0),"+",f["$[]"](2))}),D(x,"$_reduce_10",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"BinaryOp").$new(f["$[]"](0),"-",f["$[]"](2))}),D(x,"$_reduce_12",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"BinaryOp").$new(f["$[]"](0),"*",f["$[]"](2))}),D(x,"$_reduce_13",function(f,w,U){return f["$[]"](3).$new(f["$[]"](0),f["$[]"](2))}),D(x,"$_reduce_15",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),D(x,"$_reduce_16",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"DivideWithCeil")}),D(x,"$_reduce_17",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"DivideWithCeil")}),D(x,"$_reduce_18",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"DivideWithRound")}),D(x,"$_reduce_19",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"DivideWithFloor")}),D(x,"$_reduce_20",function(f,w,U){return f["$[]"](1)}),D(x,"$_reduce_21",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"Negative").$new(f["$[]"](1))}),D(x,"$_reduce_23",function(f,w,U){return f["$[]"](1)}),D(x,"$_reduce_24",function(f,w,U){return v(v(p("Arithmetic"),"Node"),"Number").$new(f["$[]"](0))}),D(x,"$_reduce_none",function(f,w,U){return f["$[]"](0)})},Opal.modules["bcdice/common_command/barabara_dice"]=function(n){var N,g,re,s,j,r,m,c,O,Z,G=n.module,E=n.const_set,i=n.thrower,D=n.def,T=[],F=n.nil;return n.top.$require("bcdice/common_command/barabara_dice/parser"),N=T,g=Z=[G(T[0],"BCDice")].concat(N),re=O=[G(Z[0],"CommonCommand")].concat(g),E((c=[m=G(O[0],"BarabaraDice")].concat(re))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),j=[s=n.get_singleton_class(m)].concat(c),r=n.$r(j),D(s,"$eval",function(ne,K,J){try{var C;return i("eval_return"),(C=r("Parser").$parse(ne))===F||null==C?F:C.$eval(K,J)}catch(x){if(x===n.t_eval_return)return x.$v;throw x}})},Opal.modules["bcdice/dice_table/table"]=function(n){var Z,O,s,b,j,r,ee,re,g,G=n.module,E=n.klass,i=n.hash2,D=n.defs,M=n.truthy,T=n.def,F=n.rb_minus,z=[],N=n.nil;return Z=z,O=g=[G(z[0],"BCDice")].concat(Z),s=re=[G(g[0],"DiceTable")].concat(O),j=[b=E(re[0],null,"Table")].concat(s),r=n.$r(j),(ee=b.$$prototype).times=ee.sides=ee.name=ee.items=N,D(b,"$from_i18n",function(K,J){var C=N;return C=r("I18n").$t(K,i(["locale"],{locale:J})),this.$new(C["$[]"]("name"),C["$[]"]("type"),C["$[]"]("items"))}),T(b,"$initialize",function(K,J,X){var C=this,te=N;return C.name=K,C.items=X.$freeze(),te=/(\d+)D(\d+)/i.$match(J),M(te)||C.$raise(r("ArgumentError"),"Unexpected table type: "+J),C.times=te["$[]"](1).$to_i(),C.sides=te["$[]"](2).$to_i()}),T(b,"$roll",function(K){var X,J=this;return X=K.$roll_sum(J.times,J.sides),J.$choice(X)}),T(b,"$choice",function(K){var X,J=this;return X=F(K,J.times),r("RollResult").$new(J.name,K,J.items["$[]"](X))})},Opal.queue(function(n){var b,ne,x,q,R,u,J,X,r,G=n.module,E=n.klass,i=n.const_set,D=n.send2,M=n.find_super,T=n.def,F=n.regexp,z=n.hash2,N=n.truthy,A=n.eqeqeq,Z=n.rb_gt,Q=n.thrower,g=n.rb_ge,v=n.send,O=n.rb_plus,h=n.top,re=[],m=n.nil,c=n.$$$;return h.$require("bcdice/common_command/barabara_dice"),h.$require("bcdice/dice_table/table"),b=re,ne=r=[G(re[0],"BCDice")].concat(b),J=[G(r[0],"GameSystem")].concat(ne),X=n.$r(J),x=J,R=[q=E(J[0],X("Base"),"NinjaSlayer")].concat(x),u=n.$r(R),q.$$prototype.randomizer=m,i(R[0],"ID","NinjaSlayer"),i(R[0],"NAME","\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"),i(R[0],"SORT_KEY","\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042TRPG"),i(R[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000NJ\n\u3000NJx[y] or NJx@y or NJx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:NJ4@H \u96e3\u6613\u5ea6HARD\u3001\u5224\u5b9a\u30c0\u30a4\u30b94\u3067\u5224\u5b9a\n\u30fb\u56de\u907f\u5224\u5b9a\u3000EV\n\u3000EVx[y]/z or EVx@y/z or EVx/z or EVx[y] or EVx@y or EVx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 z=\u653b\u6483\u5074\u306e\u6210\u529f\u6570(\u7701\u7565\u53ef) \u96e3\u6613\u5ea6\u3092\u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u653b\u6483\u5074\u306e\u6210\u529f\u6570\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u3001\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:EV5/3 \u96e3\u6613\u5ea6NORMAL(\u7701\u7565\u6642)\u3001\u5224\u5b9a\u30c0\u30a4\u30b95\u3001\u653b\u6483\u5074\u306e\u6210\u529f\u65703\u3067\u5224\u5b9a\n\u30fb\u8fd1\u63a5\u653b\u6483\u3000AT\n\u3000ATx[y] or ATx@y or ATx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4) \u30b5\u30c4\u30d0\u30c4\uff01\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:AT6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u8fd1\u63a5\u653b\u6483\u306e\u5224\u5b9a\n\u30fb\u30b5\u30c4\u30d0\u30c4\u5224\u5b9a\u3000SB\n\u30fb\u96fb\u5b50\u6226\u3000EL\n\u3000ELx[y] or ELx@y or ELx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:EL6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u96fb\u5b50\u6226\u306e\u5224\u5b9a\n\n\u30fb\u96e3\u6613\u5ea6\n\u3000KIDS=K,EASY=E,NORMAL=N,HARD=H,ULTRA HARD=UH \u6570\u5b57\u306b\u3082\u5bfe\u5fdc\n\n\u203b\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u7fa4\u306f\u300e\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG \u30b3\u30a2\u30fb\u30eb\u30fc\u30eb\u30d6\u30c3\u30af\u300f\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u30b3\u30a2\u30fb\u30eb\u30fc\u30eb\u30d6\u30c3\u30af\u3067\u904a\u3076\u5834\u5408\u306b\u306f\u300e\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG 2\u7248\u300f\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n"),T(q,"$initialize",function d(l){var t=this;return d.$$p=null,D(t,M(t,"initialize",d,!1,!0),"initialize",[l],null),t.default_cmp_op=">=",t.default_target_number=4}),i(R[0],"DIFFICULTY_VALUE_RE","UH|[2-6KENH]".$freeze()),i(R[0],"DIFFICULTY_RE",("(\\[("+u("DIFFICULTY_VALUE_RE")+")\\]|@("+u("DIFFICULTY_VALUE_RE")+"))").$freeze()),i(R[0],"NJ_RE",F(["^(S)?NJ(\\d+)",u("DIFFICULTY_RE"),"?$"],"i").$freeze()),i(R[0],"EV_RE",F(["^EV(\\d+)",u("DIFFICULTY_RE"),"?(?:/(\\d+))?$"],"i").$freeze()),i(R[0],"AT_RE",F(["^AT(\\d+)",u("DIFFICULTY_RE"),"?$"],"i").$freeze()),i(R[0],"EL_RE",F(["^EL(\\d+)",u("DIFFICULTY_RE"),"?$"],"i").$freeze()),i(R[0],"EV",u("Struct").$new("num","difficulty","targetValue")),i(R[0],"AT",u("Struct").$new("num","difficulty")),i(R[0],"EL",u("Struct").$new("num","difficulty")),i(R[0],"DIFFICULTY_SYMBOL_TO_INTEGER",z(["K","E","N","H","UH"],{K:2,E:3,N:4,H:5,UH:6}).$freeze()),T(q,"$change_text",function(l){var t=m,_=m,e=m;return t=u("NJ_RE").$match(l),N(t)?(_=this.$bRollCommand(t["$[]"](2),this.$integerValueOfDifficulty(N(e=t["$[]"](4))?e:t["$[]"](5))),""+t["$[]"](1)+_):l}),T(q,"$eval_game_system_specific_command",function(l){var a=this,t=m,_=m,e=m;return a.$debug("eval_game_system_specific_command begin string",l),N(t=u("TABLES")["$[]"](l))?t.$roll(a.$randomizer()):A(u("EV"),_=e=a.$parse(l))?a.$executeEV(e):A(u("AT"),_)?a.$executeAT(e):A(u("EL"),_)?a.$executeEL(e):m}),q.$private(),T(q,"$parse",function(l){var t,a=this;return A(u("EV_RE"),t=l)?a.$parseEV(u("Regexp").$last_match()):A(u("AT_RE"),t)?a.$parseAT(u("Regexp").$last_match()):A(u("EL_RE"),t)?a.$parseEL(u("Regexp").$last_match()):m}),T(q,"$parseEV",function(l){var a,_,e,o,$;return _=l["$[]"](1).$to_i(),e=this.$integerValueOfDifficulty(N(o=l["$[]"](3))?o:l["$[]"](4)),$=(a=l["$[]"](5))===m||null==a?m:a.$to_i(),u("EV").$new(_,e,$)}),T(q,"$parseAT",function(l){var t,_,e;return t=l["$[]"](1).$to_i(),_=this.$integerValueOfDifficulty(N(e=l["$[]"](3))?e:l["$[]"](4)),u("AT").$new(t,_)}),T(q,"$parseEL",function(l){var t,_,e;return t=l["$[]"](1).$to_i(),_=this.$integerValueOfDifficulty(N(e=l["$[]"](3))?e:l["$[]"](4)),u("EL").$new(t,_)}),T(q,"$executeEV",function(l){try{Q("eval_return");var _,t=this,e=m,o=m;return _=t.$bRollCommand(l.$num(),l.$difficulty()),o=[(e=c(c(u("BCDice"),"CommonCommand"),"BarabaraDice").$eval(_,t,t.randomizer)).$text()],N(l.$targetValue())&&N(Z(e.$success_num(),l.$targetValue()))&&o.$push("\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6!!"),o.$join(" \uff1e ")}catch($){if($===n.t_eval_return)return $.$v;throw $}}),T(q,"$executeAT",function(l){try{Q("eval_return");var _,o,t=this,e=m,$=m;return _=t.$bRollCommand(l.$num(),l.$difficulty()),o=(e=c(c(u("BCDice"),"CommonCommand"),"BarabaraDice").$eval(_,t,t.randomizer)).$last_dice_list().$count(6),$=[e.$text()],N(g(o,2))&&$.$push("\u30b5\u30c4\u30d0\u30c4!!"),$.$join(" \uff1e ")}catch(k){if(k===n.t_eval_return)return k.$v;throw k}}),T(q,"$executeEL",function(l){try{Q("eval_return");var _,$,k,t=this,e=m,o=m;return _=t.$bRollCommand(l.$num(),l.$difficulty()),$=(o=(e=c(c(u("BCDice"),"CommonCommand"),"BarabaraDice").$eval(_,t,t.randomizer)).$last_dice_list()).$count(6),k=v(o,"count",[],function(y){return null==y&&(y=m),g(y,l.$difficulty())}),N(g($,1))?[e.$text()+" + "+$,O(k,$)].$join(" \uff1e "):e.$text()}catch(L){if(L===n.t_eval_return)return L.$v;throw L}}),T(q,"$integerValueOfDifficulty",function(l){return N(l)?N(/^[2-6]$/.$match(l))?l.$to_i():u("DIFFICULTY_SYMBOL_TO_INTEGER").$fetch(l.$upcase()):4}),T(q,"$bRollCommand",function(l,a){return l+"B6>="+a}),i(R[0],"SATSUBATSU_TABLE",["\u300c\u6b7b\u306d\u30fc\u30c3\uff01\u300d\u8179\u90e8\u306b\u5f37\u70c8\u306a\u4e00\u6483\uff01\u3000\u6575\u306f\u304f\u306e\u5b57\u306b\u6298\u308c\u66f2\u304c\u308a\u3001\u30ef\u30a4\u30e4\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u3081\u3044\u3066\u5439\u3063\u98db\u3093\u3060\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u6575\u306f\u5f8c\u65b9\u306e\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u5411\u304b\u3063\u3066\u3001\u4f55\u30de\u30b9\u3067\u3082\u307e\u3063\u3059\u3050\u5f3e\u304d\u98db\u3070\u3055\u308c\u308b\uff08\u4ed6\u306e\u30ad\u30e3\u30e9\u306e\u3044\u308b\u30de\u30b9\u306f\u901a\u904e\u3059\u308b\uff09\u3002\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u63a5\u89e6\u3057\u305f\u6642\u70b9\u3067\u3001\u6575\u306f\u3055\u3089\u306b1\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u3002\u6575\u306f\u3053\u306e\u6fc0\u7a81\u30c0\u30e1\u30fc\u30b8\u306b\u5bfe\u3057\u3066\u6539\u3081\u3066\u300e\u56de\u907f\u5224\u5b9a\u300f\u3092\u884c\u3063\u3066\u3082\u826f\u3044\u3002","\u300c\u30a4\u30e4\u30fc\u30c3\uff01\u300d\u982d\u90e8\u3078\u306e\u75db\u70c8\u306a\u30ab\u30e9\u30c6\uff01\u3000\u773c\u7403\u7834\u58ca\u3082\u3057\u304f\u306f\u6fc0\u3057\u3044\u8133\u9707\u76ea\u304c\u6575\u3092\u8972\u3046\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u3068\u3010\u30ef\u30b6\u30de\u30a8\u3011\u304c\u305d\u308c\u305e\u308c1\u305a\u3064\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u82e6\u3057\u307f\u629c\u3044\u3066\u6b7b\u306c\u304c\u3044\u3044\u300d\u6025\u6240\u3092\u60c5\u3051\u5bb9\u8d66\u306a\u304f\u7834\u58ca\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u8010\u3048\u96e3\u3044\u82e6\u75db\u306b\u3088\u308a\u3001\u6575\u306f\u3010\u7cbe\u795e\u529b\u3011\u304c-2\u3055\u308c\u3001\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u304c1\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u9003\u3052\u3089\u308c\u308b\u3082\u306e\u306a\u3089\u9003\u3052\u3066\u307f\u3088\u300d\u6575\u306e\u811a\u3092\u7c89\u7815\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u811a\u529b\u3011\u304cD3\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u3053\u308c\u3067\u624b\u3082\u8db3\u3082\u51fa\u307e\u3044\uff01\u300d\u6575\u306e\u4e21\u8155\u3092\u5207\u308a\u98db\u3070\u3057\u305f\uff01\u3000\u9bae\u8840\u304c\u30b9\u30d7\u30ea\u30f3\u30af\u30e9\u30fc\u3081\u3044\u3066\u5674\u304d\u51fa\u3059\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30ef\u30b6\u30de\u30a8\u3011\u3068\u3010\u30ab\u30e9\u30c6\u3011\u304c\u305d\u308c\u305e\u308c2\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u30a4\u30a4\u30a4\u30e4\u30a2\u30a2\u30a2\u30a2\u30fc\u30fc\u30fc\u30fc\u30c3\uff01\u300d\u30e4\u30ea\u3081\u3044\u305f\u30c1\u30e7\u30c3\u30d7\u304c\u6575\u306e\u80f8\u3092\u8cab\u901a\uff01\u3000\u3055\u3089\u306b\u5fc3\u81d3\u3092\u63b4\u307f\u53d6\u308a\u3001\u63e1\u308a\u3064\u3076\u3057\u305f\uff01\u3000\u30ca\u30e0\u30a2\u30df\u30c0\u30d6\u30c4\uff01\uff1a\u6575\u306f\u6b8b\u308a\u3010\u4f53\u529b\u3011\u306b\u95a2\u4fc2\u306a\u304f\u5373\u6b7b\u3059\u308b\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD6\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD6\u4e0a\u6607\u3059\u308b\u3002"].$freeze()),i(R[0],"TABLES",z(["SB"],{SB:c(u("DiceTable"),"Table").$new("\u30b5\u30c4\u30d0\u30c4\u8868","1D6",u("SATSUBATSU_TABLE"))}).$freeze()),q.$register_prefix("NJ","EV","AT","EL",u("TABLES").$keys())})}}]);