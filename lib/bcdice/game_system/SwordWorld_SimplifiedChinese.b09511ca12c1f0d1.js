(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3208],{8907:(Re,xe,ke)=>{ke(5151),Opal.modules["i18n/backend/fallbacks"]=function(e){var H,u,t,i,l,g,V=e.module,G=e.class_variable_set,c=e.truthy,W=e.class_variable_get,I=e.def,f=e.send,U=e.send2,m=e.find_super,E=e.hash2,j=e.find_block_super,Y=e.neqeq,J=e.thrower,S=e.return_val,K=[],F=e.nil,A=e.$$$;return H=K,g=[l=V(K[0],"I18n")].concat(H),G(g[0],"@@fallbacks",F),u=e.get_singleton_class(l),t=[u].concat(g),i=e.$r(t),I(u,"$fallbacks",function(){var T=F;return G(t[1],"@@fallbacks",c(null!=t[1].$$cvars["@@fallbacks"]?"class variable":F)&&c(T=W(t[1],"@@fallbacks",!1))?T:A(A(i("I18n"),"Locale"),"Fallbacks").$new()),c(T=i("Thread").$current()["$[]"]("i18n_fallbacks"))?T:W(t[1],"@@fallbacks",!1)}),I(u,"$fallbacks=",function(L){var T;return G(t[1],"@@fallbacks",c(L["$is_a?"](i("Array")))?A(A(i("I18n"),"Locale"),"Fallbacks").$new(L):L),T=["i18n_fallbacks",W(t[1],"@@fallbacks",!1)],f(i("Thread").$current(),"[]=",T),T[T.length-1]}),function(u,z){var L,T,D,q,i=[V(u,"Backend")].concat(z);return L=i,D=[T=V(i[0],"Fallbacks")].concat(L),q=e.$r(D),I(T,"$translate",function w(d,b,s){try{var o=J("return"),_=w.$$p||F,N=this,x=F,k=F;return w.$$p=null,null==s&&(s=q("EMPTY_HASH")),c(s.$fetch("fallback",!0))?c(s["$[]"]("fallback_in_progress"))?U(N,m(N,"translate",w,!1,!0),"translate",[d,b,s],_):(c(s["$[]"]("default"))&&(x=N["$extract_non_symbol_default!"](s)),k=s.$merge(E(["fallback_in_progress"],{fallback_in_progress:!0})),f(q("I18n").$fallbacks()["$[]"](d),"each",[],function $(C){var r=null==$.$$s?this:$.$$s;null==C&&(C=F);try{return f(r,"catch",["exception"],function v(){var a=null==v.$$s?this:v.$$s,ee=F;if(ee=U(a,j(a,"translate",v.$$def||$.$$def||w,!1,!1),"translate",[C,b,k],null),c(ee["$nil?"]()))return F;Y(d.$to_s(),C.$to_s())&&a.$on_fallback(d,C,b,s),o.$throw(ee)},{$$s:r,$$ret:o})}catch(v){if(!e.rescue(v,[A(q("I18n"),"InvalidLocale")]))throw v;try{return F}finally{e.pop_exception()}}},{$$s:N}),c(s["$key?"]("default"))&&c(s["$[]"]("default")["$nil?"]())?F:c(x)?U(N,m(N,"translate",w,!1,!0),"translate",[d,F,s.$merge(E(["default"],{default:x}))],null):N.$throw("exception",A(q("I18n"),"MissingTranslation").$new(d,b,s))):U(N,m(N,"translate",w,!1,!0),"translate",[d,b,s],_)}catch($){if($===o)return $.$v;throw $}},-3),I(T,"$extract_non_symbol_default!",function(d){var s,b=F;return b=[d["$[]"]("default")].$flatten(),s=f(b,"detect",[],function(_){return null==_&&(_=F),_["$is_a?"](q("Symbol"))["$!"]()}),c(s)&&d["$[]="]("default",b["$[]"](0,b.$index(s))),s}),I(T,"$exists?",function w(d,b,s){try{var o=J("return"),_=w.$$p||F,N=this;return w.$$p=null,null==s&&(s=q("EMPTY_HASH")),c(s.$fetch("fallback",!0))?(f(q("I18n").$fallbacks()["$[]"](d),"each",[],function x(k){var $=null==x.$$s?this:x.$$s;null==k&&(k=F);try{if(!c(U($,j($,"exists?",x.$$def||w,!1,!1),"exists?",[k,b],null)))return F;o.$throw(!0)}catch(C){if(!e.rescue(C,[A(q("I18n"),"InvalidLocale")]))throw C;try{return F}finally{e.pop_exception()}}},{$$s:N,$$ret:o}),!1):U(N,m(N,"exists?",w,!1,!0),"exists?",[d,b,s],_)}catch(x){if(x===o)return x.$v;throw x}},-3),T.$private(),I(T,"$on_fallback",S(F))}(g[0],g)},Opal.modules["bcdice/randomizer"]=function(e){var l,y,L,T,D,q,u,z,G=e.klass,c=e.const_set,W=e.def,I=e.truthy,f=e.rb_gt,U=e.rb_plus,m=e.rb_le,E=e.send,j=e.rb_minus,Y=e.eqeq,J=e.rb_times,S=e.eqeqeq,K=e.rb_ge,F=[],A=e.nil,n=e.$$$;return l=F,u=[(0,e.module)(F[0],"BCDice")].concat(l),z=e.$r(u),y=u,T=[L=G(u[0],null,"Randomizer")].concat(y),D=e.$r(T),(q=L.$$prototype).rand_results=q.detailed_rand_results=A,c(T[0],"UPPER_LIMIT_DICE_TIMES",200),c(T[0],"UPPER_LIMIT_DICE_SIDES",1e4),c(T[0],"UPPER_LIMIT_RANDS",1e4),W(L,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),L.$attr_reader("rand_results"),L.$attr_reader("detailed_rand_results"),c(T[0],"DetailedRandResult",D("Struct").$new("kind","sides","value")),W(L,"$roll_barabara",function(d,b){var s=this;return I(f(U(s.rand_results.$size(),d),D("UPPER_LIMIT_RANDS")))&&s.$raise(D("TooManyRandsError")),I(m(d,0))||I(f(d,D("UPPER_LIMIT_DICE_TIMES")))?[]:E(D("Array"),"new",[d],function o(){return(null==o.$$s?this:o.$$s).$roll_once(b)},{$$s:s})}),W(L,"$roll_sum",function(d,b){return this.$roll_barabara(d,b).$sum()}),W(L,"$roll_once",function(d){var s=A;return I(m(d,0))||I(f(d,D("UPPER_LIMIT_DICE_SIDES")))?0:(s=this.$rand_inner(d),this.$push_to_detail("normal",d,s),s)}),W(L,"$roll_index",function(d){return j(this.$roll_once(d),1)}),W(L,"$roll_tens_d10",function(){var s,b=A;return b=this.$rand_inner(10),Y(b,10)&&(b=0),s=J(b,10),this.$push_to_detail("tens_d10",10,s),s}),W(L,"$roll_d9",function(){var b;return b=j(this.$rand_inner(10),1),this.$push_to_detail("d9",10,b),b}),W(L,"$roll_d66",function(d){var o,s=A;return s=E(D("Array"),"new",[2],function _(){return(null==_.$$s?this:_.$$s).$roll_once(6)},{$$s:this}),S(n(D("D66SortType"),"ASC"),o=d)?s["$sort!"]():S(n(D("D66SortType"),"DESC"),o)&&s["$sort!"]()["$reverse!"](),U(J(s["$[]"](0),10),s["$[]"](1))}),L.$private(),W(L,"$rand_inner",function(d){var s,b=this;return I(K(b.rand_results.$size(),D("UPPER_LIMIT_RANDS")))&&b.$raise(D("TooManyRandsError")),s=b.$random(d),b.rand_results["$<<"]([s,d]),s}),W(L,"$random",function(d){return U(D("Kernel").$rand(d),1)}),W(L,"$push_to_detail",function(d,b,s){var _;return _=D("DetailedRandResult").$new(d,b,s),this.detailed_rand_results.$push(_)}),G(u[0],z("StandardError"),"TooManyRandsError"),A},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var E,S,H,l,g,u,z,F,Y,V=e.module,G=e.klass,c=e.def,W=e.truthy,I=e.return_val,f=[],U=e.nil;return E=f,S=Y=[V(f[0],"BCDice")].concat(E),H=F=[V(Y[0],"DiceTable")].concat(S),g=[l=G(F[0],null,"RollResult")].concat(H),u=e.$r(g),(z=l.$$prototype).table_name=z.value=z.body=U,c(l,"$initialize",function(i,y,L){var T=this;return T.table_name=i,T.value=y,T.body=L}),l.$attr_reader("table_name"),l.$attr_reader("value"),l.$attr_reader("body"),c(l,"$to_s",function(){var i=this;return i.table_name+"("+i.value+") \uff1e "+i.body}),c(l,"$last_body",function(){var i=this;return W(i.body["$is_a?"](u("RollResult")))?i.body.$last_body():i.body}),c(l,"$empty?",I(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var E,S,H,l,g,u,z,F,Y,V=e.module,G=e.klass,c=e.truthy,W=e.def,I=e.rb_minus,f=[],U=e.nil;return E=f,S=Y=[V(f[0],"BCDice")].concat(E),H=F=[V(Y[0],"DiceTable")].concat(S),g=[l=G(F[0],null,"ChainTable")].concat(H),u=e.$r(g),(z=l.$$prototype).times=z.sides=z.items=z.name=U,W(l,"$initialize",function(i,y,L){var T=this,D=U;return T.name=i,T.items=L.$freeze(),D=/(\d+)D(\d+)/i.$match(y),c(D)||T.$raise(u("ArgumentError"),"Unexpected table type: "+y),T.times=D["$[]"](1).$to_i(),T.sides=D["$[]"](2).$to_i()}),W(l,"$roll",function(i){var L,T,y=this,D=U;return L=i.$roll_sum(y.times,y.sides),T=I(L,y.times),D=y.items["$[]"](T),c(D["$respond_to?"]("roll"))&&(D=D.$roll(i)),u("RollResult").$new(y.name,L,D)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var J,A,u,z,t,i,y,H,K,V=e.module,G=e.klass,c=e.hash2,W=e.defs,I=e.def,f=e.rb_plus,U=e.rb_times,m=e.rb_minus,E=[],j=e.nil;return J=E,A=K=[V(E[0],"BCDice")].concat(J),u=H=[V(K[0],"DiceTable")].concat(A),t=[z=G(H[0],null,"D66GridTable")].concat(u),i=e.$r(t),(y=z.$$prototype).name=y.items=j,W(z,"$from_i18n",function(T,D){var w=j;return w=i("I18n").$t(T,c(["locale","raise"],{locale:D,raise:!0})),this.$new(w["$[]"]("name"),w["$[]"]("items"))}),I(z,"$initialize",function(T,D){return this.name=T,this.items=D.$freeze()}),I(z,"$roll",function(T){var q,w,d,b,s;return q=T.$roll_once(6),w=T.$roll_once(6),d=f(U(q,10),w),b=m(q,1),s=m(w,1),i("RollResult").$new(this.name,d,this.items["$[]"](b)["$[]"](s))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var j,K,g,u,z,t,A,n,J,V=e.module,G=e.klass,c=e.hash2,W=e.defs,I=e.def,U=[],m=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),j=U,K=J=[V(U[0],"BCDice")].concat(j),A=[V(J[0],"DiceTable")].concat(K),n=e.$r(A),g=A,z=[u=G(A[0],n("D66GridTable"),"D66HalfGridTable")].concat(g),t=e.$r(z),W(u,"$from_i18n",function(y,L){var D=m;return D=t("I18n").$t(y,c(["locale","raise"],{locale:L,raise:!0})),this.$new(D["$[]"]("name"),D["$[]"]("items_1_2_3"),D["$[]"]("items_4_5_6"))}),I(u,"$initialize",function(y,L,T){return this.name=y,this.items=[L,L,L,T,T,T].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var j,K,g,u,z,t,A,n,J,V=e.module,G=e.klass,c=e.hash2,W=e.defs,I=e.def,U=[],m=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),j=U,K=J=[V(U[0],"BCDice")].concat(j),A=[V(J[0],"DiceTable")].concat(K),n=e.$r(A),g=A,z=[u=G(A[0],n("D66GridTable"),"D66OneThirdTable")].concat(g),t=e.$r(z),W(u,"$from_i18n",function(y,L){var D=m;return D=t("I18n").$t(y,c(["locale","raise"],{locale:L,raise:!0})),this.$new(D["$[]"]("name"),D["$[]"]("items_1_2"),D["$[]"]("items_3_4"),D["$[]"]("items_5_6"))}),I(u,"$initialize",function(y,L,T,D){return this.name=y,this.items=[L,L,T,T,D,D].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var K,H,t,i,y,L,T,g,A,V=e.module,G=e.klass,c=e.hash2,W=e.defs,I=e.def,f=e.eqeqeq,U=e.rb_plus,m=e.rb_times,E=e.truthy,j=[],Y=e.nil,J=e.$$$;return K=j,H=A=[V(j[0],"BCDice")].concat(K),t=g=[V(A[0],"DiceTable")].concat(H),y=[i=G(g[0],null,"D66Table")].concat(t),L=e.$r(y),(T=i.$$prototype).sort_type=T.items=T.name=Y,W(i,"$from_i18n",function(q,w){var s,b=Y;return b=L("I18n").$t(q,c(["locale"],{locale:w})),s=L("D66SortType").$const_get(b["$[]"]("d66_sort_type")),this.$new(b["$[]"]("name"),s,b["$[]"]("items"))}),I(i,"$initialize",function(q,w,d){var b=this;return b.name=q,b.sort_type=w,b.items=d.$freeze()}),I(i,"$roll",function(q){var w=this,d=Y,b=Y,s=Y,o=Y;return d=q.$roll_barabara(2,6),f(J(L("D66SortType"),"ASC"),b=w.sort_type)?d["$sort!"]():f(J(L("D66SortType"),"DESC"),b)&&d["$sort!"]()["$reverse!"](),s=U(m(d["$[]"](0),10),d["$[]"](1)),o=E(b=w.items["$[]"](s))?b:w.items["$[]"](s.$to_s()),E(o["$respond_to?"]("roll"))&&(o=o.$roll(q)),L("RollResult").$new(w.name,s,o)}),I(i,"$choice",function(q){return L("RollResult").$new(this.name,q,this.items["$[]"](q))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var F,l,u,z,n,V=e.module,G=e.klass,c=e.hash2,W=e.send,I=e.to_ary,f=e.rb_plus,U=e.rb_times,m=e.send2,E=e.find_super,j=e.def,J=[],S=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),F=J,l=n=[V(J[0],"BCDice")].concat(F),u=[V(n[0],"DiceTable")].concat(l),z=e.$r(u),j(G(u[0],z("D66Table"),"D66LeftRangeTable"),"$initialize",function L(T,D,q){var b;return L.$$p=null,b=c([],{}),W(q,"each",[],function(o){var _,k;return null==o&&(o=S),_=I(o),k=null==_[1]?S:_[1],W(null==_[0]?S:_[0],"each",[],function(C){return null==C&&(C=S),W(k,"each_with_index",[],function(v,a){var ee,te;return null==v&&(v=S),null==a&&(a=S),te=f(U(C,10),f(a,1)),W(b,"[]=",ee=[te,v]),ee[ee.length-1]})})}),m(this,E(this,"initialize",L,!1,!0),"initialize",[T,D,b],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var S,n,z,t,i,y,L,l,F,V=e.module,G=e.klass,c=e.hash2,W=e.defs,I=e.def,f=e.truthy,U=e.rb_minus,m=e.rb_plus,E=e.rb_times,j=[],Y=e.nil;return S=j,n=F=[V(j[0],"BCDice")].concat(S),z=l=[V(F[0],"DiceTable")].concat(n),i=[t=G(l[0],null,"D66ParityTable")].concat(z),y=e.$r(i),(L=t.$$prototype).odd=L.even=L.name=Y,W(t,"$from_i18n",function(D,q){var d=Y;return d=y("I18n").$t(D,c(["locale","raise"],{locale:q,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("odd"),d["$[]"]("even"))}),I(t,"$initialize",function(D,q,w){var d=this;return d.name=D,d.odd=q.$freeze(),d.even=w.$freeze()}),I(t,"$roll",function(D){var d,s,o,q=this,w=Y;return w=D.$roll_once(6),d=D.$roll_once(6),s=(f(w["$odd?"]())?q.odd:q.even)["$[]"](U(d,1)),o=m(E(w,10),d),y("RollResult").$new(q.name,o,s)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var j,K,l,g,u,z,t,A,J,V=e.module,G=e.klass,c=e.def,W=e.rb_plus,I=e.rb_times,f=e.send,U=[],m=e.nil;return j=U,K=J=[V(U[0],"BCDice")].concat(j),l=A=[V(J[0],"DiceTable")].concat(K),u=[g=G(A[0],null,"D66RangeTable")].concat(l),z=e.$r(u),(t=g.$$prototype).items=t.name=m,c(g,"$initialize",function(y,L){return this.name=y,this.items=L.$freeze()}),c(g,"$roll",function(y){var T,D,q,w=m;return T=y.$roll_once(6),D=y.$roll_once(6),q=W(I(T,10),D),w=f(this.items,"find",[],function(b){return null==b&&(b=m),b["$[]"](0)["$include?"](q)}),z("RollResult").$new(this.name,q,w["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var F,l,i,q,d,b,y,L,T,D,u,n,V=e.module,G=e.klass,c=e.const_set,W=e.send,I=e.hash2,f=e.def,U=e.eqeqeq,m=e.truthy,E=e.to_a,j=e.rb_times,Y=e.rb_plus,J=[],S=e.nil;return F=J,l=n=[V(J[0],"BCDice")].concat(F),i=u=[V(n[0],"DiceTable")].concat(l),L=[y=G(u[0],null,"RangeTable")].concat(i),T=e.$r(L),(D=y.$$prototype).name=D.items=D.num_of_dice=D.num_of_sides=D.formatter=S,c(L[0],"RollResult",W(T("Struct"),"new",["sum","values","content","formatted"],function q(){return(null==q.$$s?this:q.$$s).$alias_method("to_s","formatted")},{$$s:y})),c(L[0],"Item",T("Struct").$new("range","content")),c(L[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),c(L[0],"DEFAULT_FORMATTER",W(y,"lambda",[],function(w,d){return null==w&&(w=S),null==d&&(d=S),w.$name()+"("+d.$sum()+") \uff1e "+d.$content()})),y.$attr_reader("name"),y.$attr_reader("num_of_dice"),y.$attr_reader("num_of_sides"),d=[q=e.get_singleton_class(y)].concat(L),b=e.$r(d),f(q,"$from_i18n",function(o,_){var k,x=S;return x=b("I18n").$t(o,I(["locale"],{locale:_})),k=W(x["$[]"]("items"),"map",[],function $(C){return null==C&&(C=S),[(null==$.$$s?this:$.$$s).$conv_string_range(C["$[]"](0)),C["$[]"](1)]},{$$s:this}),this.$new(x["$[]"]("name"),x["$[]"]("type"),k)}),f(q,"$conv_string_range",function(o){var N,_=this;return null==_.name&&(_.name=S),U(b("Integer"),N=o)?o:U(b("String"),N)?m(o["$include?"](".."))?W(b("Range"),"new",E(W(o.$split("..",2),"map",[],function x(k){return null==k&&(k=S),(null==x.$$s?this:x.$$s).$Integer(k)},{$$s:_}))):_.$Integer(o):_.$raise(b("TypeError"),_.name+": "+o+" ("+o.$class()+") must be a String or an Integer")}),f(y,"$initialize",function q(w,d,b){var _,s=q.$$p||S,o=this,N=S;return q.$$p=null,o.name=w.$freeze(),o.formatter=m(_=s)?_:T("DEFAULT_FORMATTER"),N=T("DICE_ROLL_METHOD_RE").$match(d),m(N)||o.$raise(T("ArgumentError"),o.name+": invalid dice roll method: "+d),o.num_of_dice=N["$[]"](1).$to_i(),o.num_of_sides=N["$[]"](2).$to_i(),o.$store(b)}),f(y,"$fetch",function(w){var b,d=this;return b=W(d.items,"find",[],function(o){return null==o&&(o=S),o.$range()["$include?"](w)}),m(b)||d.$raise(T("RangeError"),d.name+": value is out of range: "+w),b}),f(y,"$roll",function(w){var s,d=this,b=S,o=S;return s=(b=w.$roll_barabara(d.num_of_dice,d.num_of_sides)).$sum(),(o=T("RollResult").$new(s,b,d.$fetch(s).$content()))["$formatted="](d.formatter["$[]"](d,o)),o}),y.$private(),f(y,"$store",function(w){var b,s,d=this;return b=W(w,"map",[],function o(_,N){return null==_&&(_=S),null==N&&(N=S),[(null==o.$$s?this:o.$$s).$coerce_to_int_range(_),N]},{$$s:d}),s=W(b,"sort_by",[],function(_,N){return null==_&&(_=S),null==N&&(N=S),_.$min()}),d.$assert_min_sum_is_covered(s),d.$assert_max_sum_is_covered(s),d.$assert_no_gap_or_overlap_in_ranges(s),d.items=W(s,"map",[],function(_,N){return null==_&&(_=S),null==N&&(N=S),T("Item").$new(_,N.$freeze()).$freeze()}).$freeze(),d}),f(y,"$coerce_to_int_range",function(w){var b;return U(T("Integer"),b=w)?T("Range").$new(w,w):U(T("Range"),b)&&m(w.$begin()["$is_a?"](T("Integer")))&&m(w.$end()["$is_a?"](T("Integer")))?w:this.$raise(T("TypeError"),this.name+": "+w+" ("+w.$class()+") must be an Integer or a Range with Integers ")}),f(y,"$assert_min_sum_is_covered",function(w){var b,d=this,s=S;return b=d.num_of_dice,s=w.$first()["$[]"](0),m(s["$include?"](b))||d.$raise(T("RangeError"),d.name+": min value ("+b+") is not covered: "+s),d}),f(y,"$assert_max_sum_is_covered",function(w){var b,d=this,s=S;return b=j(d.num_of_dice,d.num_of_sides),s=w.$last()["$[]"](0),m(s["$include?"](b))||d.$raise(T("RangeError"),d.name+": max value ("+b+") is not covered: "+s),d}),f(y,"$assert_no_gap_or_overlap_in_ranges",function(w){return W(w,"each_cons",[2],function b(s,o){var k,$,_=null==b.$$s?this:b.$$s,N=S,x=S;return null==_.name&&(_.name=S),null==s&&(s=S),null==o&&(o=S),N=s["$[]"](0),x=o["$[]"](0),k=N.$max(),$=Y(k,1),m(x["$include?"](k))&&_.$raise(T("RangeError"),_.name+": Range overlap: "+N+" and "+x),m(x["$include?"]($))?S:_.$raise(T("RangeError"),_.name+": Range gap: "+N+" and "+x)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var Y,F,g,y,L,T,D,z,n,S,V=e.module,G=e.klass,c=e.send,W=e.def,I=e.rb_minus,f=e.return_ivar,U=[],m=e.nil,E=e.$$$;return Y=U,F=S=[V(U[0],"BCDice")].concat(Y),g=n=[V(S[0],"DiceTable")].concat(F),y=z=[G(n[0],null,"SaiFicSkillTable")].concat(g),T=[L=G(z[0],null,"Category")].concat(y),D=e.$r(T),W(L,"$initialize",function(w,d,b,s){var o=this;return o.name=w,o.skills=c(d.$map(),"with_index",[2],function(N,x){return null==N&&(N=m),null==x&&(x=m),E(D("SaiFicSkillTable"),"Skill").$new(w,N,b,x,s)}),o.dice=b}),W(L,"$roll",function(w){return this.$skills()["$[]"](I(w.$roll_sum(2,6),2))}),W(L,"$to_s",f("name")),L.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var m,J,n,z,t,l,K,j,V=e.module,G=e.klass,c=e.def,W=e.hash2,I=[],f=e.nil;return m=I,J=j=[V(I[0],"BCDice")].concat(m),n=K=[V(j[0],"DiceTable")].concat(J),l=[G(K[0],null,"SaiFicSkillTable")].concat(n),(t=(z=G(l[0],null,"Skill")).$$prototype).s_format=t.category_dice=t.row_dice=t.category_name=t.name=f,c(z,"$initialize",function(y,L,T,D,q){var w=this;return w.category_name=y,w.name=L,w.category_dice=T,w.row_dice=D,w.s_format=q}),c(z,"$to_s",function(){var y=this;return y.$format(y.s_format,W(["category_dice","row_dice","category_name","skill_name"],{category_dice:y.category_dice,row_dice:y.row_dice,category_name:y.category_name,skill_name:y.name}))}),z.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var l,t,D,q,w,d,b,y,u,V=e.module,G=e.klass,c=e.ensure_kwargs,W=e.hash2,I=e.send,U=e.defs,m=e.const_set,E=e.to_ary,j=e.def,Y=e.truthy,J=e.rb_minus,S=e.rb_plus,K=e.top,F=[],A=e.nil,n=e.$$$;return K.$require("bcdice/dice_table/sai_fic_skill_table/category"),K.$require("bcdice/dice_table/sai_fic_skill_table/skill"),l=F,t=u=[V(F[0],"BCDice")].concat(l),D=y=[V(u[0],"DiceTable")].concat(t),w=[q=G(y[0],null,"SaiFicSkillTable")].concat(D),d=e.$r(w),(b=q.$$prototype).rtt=b.rtt_format=b.rct=b.rct_format=b.rttn=b.rttn_format=b.categories=A,U(q,"$from_i18n",function(o,_,N){var x,k,$,a,v=A;return null==(x=(N=c(N)).$$smap.rtt)&&(x=A),null==(k=N.$$smap.rct)&&(k=A),null==($=N.$$smap.rttn)&&($=A),a=(v=d("I18n").$t("RTT",W(["locale","raise","default"],{locale:_,raise:!1,default:W([],{})})).$merge(d("I18n").$t(o,W(["locale","raise"],{locale:_,raise:!0}))))["$[]"]("items"),v=I(v,"select",[],function(te,O){return null==te&&(te=A),null==O&&(O=A),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](te)}),this.$new(a,e.to_hash(v).$merge(W(["rtt","rct","rttn"],{rtt:x,rct:k,rttn:$})))},-3),m(w[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),m(w[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),m(w[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),m(w[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),j(q,"$initialize",function(o,_){var N,x,k,$,C,r,v,a=this;return null==(N=(_=c(_)).$$smap.rtt)&&(N=A),null==(x=_.$$smap.rct)&&(x=A),null==(k=_.$$smap.rttn)&&(k=A),null==($=_.$$smap.rtt_format)&&($=d("DEFAULT_RTT")),null==(C=_.$$smap.rct_format)&&(C=d("DEFAULT_RCT")),null==(r=_.$$smap.rttn_format)&&(r=d("DEFAULT_RTTN")),null==(v=_.$$smap.s_format)&&(v=d("DEFAULT_S")),a.categories=I(o.$map(),"with_index",[1],function(te,O){var _e,oe,se;return null==te&&(te=A),null==O&&(O=A),oe=null==(_e=E(te))[0]?A:_e[0],se=null==_e[1]?A:_e[1],n(d("SaiFicSkillTable"),"Category").$new(oe,se,O,v)},{$$has_top_level_mlhs_arg:!0}),a.rtt=N,a.rct=x,a.rttn=k.$to_a(),a.rtt_format=$,a.rct_format=C,a.rttn_format=r},-2),m(w[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),q.$attr_reader("categories"),j(q,"$roll_command",function(o,_){var x,N=this,k=A,$=A;return Y(["RTT",N.rtt]["$include?"](x=_))?N.$format_skill(N.rtt_format,N.$roll_skill(o)):Y(["RCT",N.rct]["$include?"](x))?(k=N.$roll_category(o),N.$format(N.rct_format,W(["category_dice","category_name"],{category_dice:k.$dice(),category_name:k.$name()}))):Y($=d("RTTN").$index(x))||Y($=N.rttn.$index(x))?N.$format_skill(N.rttn_format,N.categories["$[]"]($).$roll(o)):A}),j(q,"$roll_category",function(o){return this.categories["$[]"](J(o.$roll_once(6),1))}),j(q,"$roll_skill",function(o){return this.$roll_category(o).$roll(o)}),j(q,"$prefixes",function(){var o=this;return S(["RTT[1-6]?","RCT",o.rtt,o.rct],o.rttn).$compact()}),q.$private(),j(q,"$format_skill",function(o,_){return this.$format(o,W(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:_.$category_dice(),row_dice:_.$row_dice(),category_name:_.$category_name(),skill_name:_.$name(),text:_.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var Y,F,g,u,z,t,i,n,S,V=e.module,G=e.klass,c=e.hash2,W=e.defs,I=e.truthy,f=e.def,U=e.rb_minus,m=[],E=e.nil;return Y=m,F=S=[V(m[0],"BCDice")].concat(Y),g=n=[V(S[0],"DiceTable")].concat(F),z=[u=G(n[0],null,"Table")].concat(g),t=e.$r(z),(i=u.$$prototype).times=i.sides=i.name=i.items=E,W(u,"$from_i18n",function(L,T){var q=E;return q=t("I18n").$t(L,c(["locale"],{locale:T})),this.$new(q["$[]"]("name"),q["$[]"]("type"),q["$[]"]("items"))}),f(u,"$initialize",function(L,T,D){var q=this,w=E;return q.name=L,q.items=D.$freeze(),w=/(\d+)D(\d+)/i.$match(T),I(w)||q.$raise(t("ArgumentError"),"Unexpected table type: "+T),q.times=w["$[]"](1).$to_i(),q.sides=w["$[]"](2).$to_i()}),f(u,"$roll",function(L){var D,T=this;return D=L.$roll_sum(T.times,T.sides),T.$choice(D)}),f(u,"$choice",function(L){var D,T=this;return D=U(L,T.times),t("RollResult").$new(T.name,L,T.items["$[]"](D))})},Opal.modules["bcdice/dice_table"]=function(e){var V=e.top;return V.$require("bcdice/dice_table/roll_result"),V.$require("bcdice/dice_table/chain_table"),V.$require("bcdice/dice_table/d66_grid_table"),V.$require("bcdice/dice_table/d66_half_grid_table"),V.$require("bcdice/dice_table/d66_one_third_table"),V.$require("bcdice/dice_table/d66_left_range_table"),V.$require("bcdice/dice_table/d66_parity_table"),V.$require("bcdice/dice_table/d66_range_table"),V.$require("bcdice/dice_table/d66_table"),V.$require("bcdice/dice_table/range_table"),V.$require("bcdice/dice_table/sai_fic_skill_table"),V.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var f,j,J,m,V=e.module,G=e.const_set,c=[];return f=c,j=m=[V(c[0],"BCDice")].concat(f),J=[V(m[0],"D66SortType")].concat(j),G(J[0],"NO_SORT","no_sort"),G(J[0],"ASC","asc"),G(J[0],"DESC","desc"),function(E,j){var J=[V(E,"RoundType")].concat(j);return G(J[0],"CEIL","ceil"),G(J[0],"FLOOR","floor"),G(J[0],"ROUND","round")}(m[0],m)},Opal.modules["bcdice/translate"]=function(e){var j,K,F,A,n,J,V=e.module,G=e.ensure_kwargs,c=e.kwrestargs,I=e.hash2,f=e.def,U=[],m=e.nil;return j=U,K=J=[V(U[0],"BCDice")].concat(j),A=[F=V(J[0],"Translate")].concat(K),n=e.$r(A),f(F,"$translate",function(l,g){var u,z=this;return null==z.locale&&(z.locale=m),g=G(g),u=c(g,{}),n("I18n").$translate(l,I(["locale","raise"],{locale:z.locale,raise:!0}).$merge(e.to_hash(u)))},-2)},Opal.modules["bcdice/result"]=function(e){var F,H,A,j,J,G=e.klass,c=e.send,W=e.def,I=e.return_val,f=e.return_ivar,U=[],m=e.nil;return j=U,F=J=[(0,e.module)(U[0],"BCDice")].concat(j),[A=G(J[0],null,"Result")].concat(F),W(H=e.get_singleton_class(A),"$success",function(u){return c(this.$new(),"tap",[],function(i){var y;return null==i&&(i=m),i["$text="](u),c(i,"success=",y=[!0]),y[y.length-1]})}),W(H,"$failure",function(u){return c(this.$new(),"tap",[],function(i){var y;return null==i&&(i=m),i["$text="](u),c(i,"failure=",y=[!0]),y[y.length-1]})}),W(H,"$critical",function(u){return c(this.$new(),"tap",[],function(i){var y;return null==i&&(i=m),i["$text="](u),i["$critical="](!0),c(i,"success=",y=[!0]),y[y.length-1]})}),W(H,"$fumble",function(u){return c(this.$new(),"tap",[],function(i){var y;return null==i&&(i=m),i["$text="](u),i["$fumble="](!0),c(i,"failure=",y=[!0]),y[y.length-1]})}),W(H,"$nothing",I("nothing")),W(A,"$initialize",function(l){var g=this;return null==l&&(l=m),g.text=l,g.rands=m,g.detailed_rands=m,g.secret=!1,g.success=!1,g.failure=!1,g.critical=!1,g.fumble=!1},-1),A.$attr_accessor("text","rands","detailed_rands"),A.$attr_writer("secret","success","failure","critical","fumble"),W(A,"$secret?",f("secret")),W(A,"$success?",f("success")),W(A,"$failure?",f("failure")),W(A,"$critical?",f("critical")),W(A,"$fumble?",f("fumble")),W(A,"$condition=",function(l){return this.success=l,this.failure=l["$!"]()})},Opal.modules["racc/parser"]=function(e){var L,D,q,V=e.module,G=e.klass,c=e.truthy,W=e.const_set,I=e.defs,f=e.gvars,U=e.rb_lt,m=e.def,E=e.to_ary,j=e.send,Y=e.neqeq,J=e.rb_plus,S=e.eqeq,K=e.rb_ge,F=e.rb_gt,A=e.rb_minus,n=e.rb_le,H=e.rb_times,l=e.assign_ivar_val,u=[],z=e.$r(u),t=e.nil,i=e.$$$;return L=u,D=[V(u[0],"Racc")].concat(L),q=e.$r(D),G(D[0],q("StandardError"),"ParseError"),c(i("::","ParseError","skip_raise")?"constant":t)||W(u[0],"ParseError",i(z("Racc"),"ParseError")),function(y,L){var s,o,_,N,x,q=[V(y,"Racc")].concat(L),w=e.$r(q);return c(w("Racc_No_Extensions","skip_raise")?"constant":t)||W(q[0],"Racc_No_Extensions",!1),s=q,_=[o=G(q[0],null,"Parser")].concat(s),N=e.$r(_),(x=o.$$prototype).yydebug=x.racc_debug_out=x.racc_error_status=x.racc_t=x.racc_vstack=x.racc_val=x.racc_state=x.racc_tstack=t,W(_[0],"Racc_Runtime_Version","1.4.6"),W(_[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),W(_[0],"Racc_Runtime_Core_Version_R","1.4.6"),W(_[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),W(_[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),W(_[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),W(_[0],"Racc_Runtime_Core_Version",N("Racc_Runtime_Core_Version_R")),W(_[0],"Racc_Runtime_Core_Revision",N("Racc_Runtime_Core_Revision_R")),W(_[0],"Racc_Runtime_Type","ruby"),I(N("Parser"),"$racc_runtime_type",function(){return N("Racc_Runtime_Type")}),m(o,"$_racc_setup",function(){var $,C,r=this,v=t,a=t;return null==f.stderr&&(f.stderr=t),c(i(r.$class(),"Racc_debug_parser"))||(r.yydebug=!1),c(null!=($=r.yydebug)&&$!==t?"instance-variable":t)||(r.yydebug=!1),c(r.yydebug)&&(c(null!=(C=r.racc_debug_out)&&C!==t?"instance-variable":t)||(r.racc_debug_out=f.stderr),r.racc_debug_out=c(v=r.racc_debug_out)?v:f.stderr),a=i(r.$class(),"Racc_arg"),c(U(a.$size(),14))&&a["$[]="](13,!0),a}),m(o,"$_racc_init_sysvars",function(){var $=this;return $.racc_state=[0],$.racc_tstack=[],$.racc_vstack=[],$.racc_t=t,$.racc_val=t,$.racc_read_next=!0,$.racc_user_yyerror=!1,$.racc_error_status=0}),m(o,"$do_parse",function(){return this.$__send__(N("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),m(o,"$next_token",function(){return this.$raise(N("NotImplementedError"),this.$class()+"#next_token is not defined")}),m(o,"$_racc_do_parse_rb",function($,C){var r,a=this,ee=t,te=t,O=t,_e=t,oe=t,se=t,ue=t,le=t;return r=E($),ee=null==r[0]?t:r[0],te=null==r[1]?t:r[1],O=null==r[2]?t:r[2],_e=null==r[3]?t:r[3],oe=null==r[10]?t:r[10],a.$_racc_init_sysvars(),se=ue=le=t,j(a,"catch",["racc_end_parse"],function ie(){var ae,re,R=null==ie.$$s?this:ie.$$s,Z=t;for(null==R.racc_state&&(R.racc_state=t),null==R.racc_read_next&&(R.racc_read_next=t),null==R.racc_t&&(R.racc_t=t),null==R.yydebug&&(R.yydebug=t),null==R.racc_val&&(R.racc_val=t);c(!0);)for(c(le=_e["$[]"](R.racc_state["$[]"](-1)))?(c(R.racc_read_next)&&Y(R.racc_t,0)&&(re=R.$next_token(),ae=E(re),se=null==ae[0]?t:ae[0],R.racc_val=null==ae[1]?t:ae[1],R.racc_t=c(se)?c(Z=oe["$[]"](se))?Z:1:0,c(R.yydebug)&&R.$racc_read_token(R.racc_t,se,R.racc_val),R.racc_read_next=!1),le=J(le,R.racc_t),c(K(le,0))&&c(ue=ee["$[]"](le))&&S(te["$[]"](le),R.racc_state["$[]"](-1))||(ue=O["$[]"](R.racc_state["$[]"](-1)))):ue=O["$[]"](R.racc_state["$[]"](-1));c(ue=R.$_racc_evalact(ue,$)););},{$$s:a})}),m(o,"$yyparse",function($,C){return this.$__send__(N("Racc_YY_Parse_Method"),$,C,this.$_racc_setup(),!0)}),m(o,"$_racc_yyparse_rb",function($,C,r,v){var a,O=t,_e=t,ce=t,oe=t,ue=t,le=t,ie=t;return a=E(r),O=null==a[0]?t:a[0],_e=null==a[1]?t:a[1],ce=null==a[2]?t:a[2],oe=null==a[3]?t:a[3],ue=null==a[10]?t:a[10],this.$_racc_init_sysvars(),le=t,ie=t,j(this,"catch",["racc_end_parse"],function ae(){var re=null==ae.$$s?this:ae.$$s;for(null==re.racc_state&&(re.racc_state=t);!c(ie=oe["$[]"](re.racc_state["$[]"](-1)));)for(;c(le=re.$_racc_evalact(ce["$[]"](re.racc_state["$[]"](-1)),r)););return j($,"__send__",[C],function R(Z,P){var h=null==R.$$s?this:R.$$s,Q=t,p=t;for(null==h.racc_t&&(h.racc_t=t),null==h.racc_state&&(h.racc_state=t),null==h.racc_read_next&&(h.racc_read_next=t),null==Z&&(Z=t),null==P&&(P=t),h.racc_t=c(Z)?c(Q=ue["$[]"](Z))?Q:1:0,h.racc_val=P,h.racc_read_next=!1,ie=J(ie,h.racc_t),c(K(ie,0))&&c(le=O["$[]"](ie))&&S(_e["$[]"](ie),h.racc_state["$[]"](-1))||(le=ce["$[]"](h.racc_state["$[]"](-1)));c(le=h.$_racc_evalact(le,r)););for(;c(c(Q=c(p=(ie=oe["$[]"](h.racc_state["$[]"](-1)))["$!"]())?p:h.racc_read_next["$!"]())?Q:h.racc_t["$=="](0));)for(c(ie)&&c(ie=J(ie,h.racc_t))&&c(K(ie,0))&&c(le=O["$[]"](ie))&&S(_e["$[]"](ie),h.racc_state["$[]"](-1))||(le=ce["$[]"](h.racc_state["$[]"](-1)));c(le=h.$_racc_evalact(le,r)););},{$$s:re})},{$$s:this})}),m(o,"$_racc_evalact",function($,C){var r,ce,a=this,ee=t,te=t,_e=t,oe=t,se=t,ue=t;if(ee=null==(r=E(C))[0]?t:r[0],te=null==r[1]?t:r[1],_e=null==r[3]?t:r[3],ce=null==r[11]?t:r[11],oe=null==r[12]?t:r[12],c(F($,0))&&c(U($,ce)))c(F(a.racc_error_status,0))&&(S(a.racc_t,1)||(a.racc_error_status=A(a.racc_error_status,1))),a.racc_vstack.$push(a.racc_val),a.racc_state.$push($),a.racc_read_next=!0,c(a.yydebug)&&(a.racc_tstack.$push(a.racc_t),a.$racc_shift(a.racc_t,a.racc_tstack,a.racc_vstack));else if(c(U($,0))&&c(F($,oe["$-@"]()))){if(se=j(a,"catch",["racc_jump"],function le(){var ie=null==le.$$s?this:le.$$s;return null==ie.racc_state&&(ie.racc_state=t),ie.racc_state.$push(ie.$_racc_do_reduce(C,$)),!1},{$$s:a}),c(se))switch(se.valueOf()){case 1:return a.racc_user_yyerror=!0,oe["$-@"]();case 2:return ce;default:a.$raise("[Racc Bug] unknown jump code")}}else if(S($,ce))c(a.yydebug)&&a.$racc_accept(),a.$throw("racc_end_parse",a.racc_vstack["$[]"](0));else{if(S($,oe["$-@"]())){switch(a.racc_error_status.valueOf()){case 0:c(C["$[]"](21))||a.$on_error(a.racc_t,a.racc_val,a.racc_vstack);break;case 3:S(a.racc_t,0)&&a.$throw("racc_end_parse",t),a.racc_read_next=!0}for(a.racc_user_yyerror=!1,a.racc_error_status=3;c(!0)&&!(c(ue=_e["$[]"](a.racc_state["$[]"](-1)))&&(ue=J(ue,1),c(K(ue,0))&&c($=ee["$[]"](ue))&&S(te["$[]"](ue),a.racc_state["$[]"](-1))));)c(n(a.racc_state.$size(),1))&&a.$throw("racc_end_parse",t),a.racc_state.$pop(),a.racc_vstack.$pop(),c(a.yydebug)&&(a.racc_tstack.$pop(),a.$racc_e_pop(a.racc_state,a.racc_tstack,a.racc_vstack));return $}a.$raise("[Racc Bug] unknown action "+$.$inspect())}return c(a.yydebug)&&a.$racc_next_state(a.racc_state["$[]"](-1),a.racc_state),t}),m(o,"$_racc_do_reduce",function($,C){var r,oe,ue,Z,P,h,M,a=this,te=t,O=t,_e=t,ce=t,se=t,le=t,ie=t,ae=t,re=t,R=t,Q=t,p=t,X=t;return te=null==(r=E($))[4]?t:r[4],O=null==r[5]?t:r[5],_e=null==r[6]?t:r[6],ce=null==r[7]?t:r[7],oe=null==r[8]?t:r[8],se=null==r[9]?t:r[9],ue=null==r[13]?t:r[13],le=a.racc_state,ie=a.racc_vstack,ae=a.racc_tstack,re=H(C,-3),R=se["$[]"](re),Z=se["$[]"](J(re,1)),P=se["$[]"](J(re,2)),h=[],c(a.yydebug)&&(Q=ae["$[]"](R["$-@"](),R)),p=ie["$[]"](R["$-@"](),R),c(a.yydebug)&&ae["$[]="](R["$-@"](),R,h),ie["$[]="](R["$-@"](),R,h),le["$[]="](R["$-@"](),R,h),c(ue)?ie.$push(a.$__send__(P,p,ie,p["$[]"](0))):ie.$push(a.$__send__(P,p,ie)),ae.$push(Z),c(a.yydebug)&&a.$racc_reduce(Q,Z,ae,ie),M=A(Z,oe),c(re=ce["$[]"](M))&&(re=J(re,le["$[]"](-1)),c(K(re,0))&&c(X=te["$[]"](re))&&S(O["$[]"](re),M))?X:_e["$[]"](M)}),m(o,"$on_error",function($,C,r){var a,v=this;return v.$raise(N("ParseError"),v.$sprintf("\nparse error on value %s (%s)",C.$inspect(),c(a=v.$token_to_str($))?a:"?"))}),m(o,"$yyerror",function(){return this.$throw("racc_jump",1)}),m(o,"$yyaccept",function(){return this.$throw("racc_jump",2)}),m(o,"$yyerrok",l("racc_error_status",0)),m(o,"$racc_read_token",function($,C,r){var v=this;return v.racc_debug_out.$print("read    "),v.racc_debug_out.$print(C.$inspect(),"(",v.$racc_token2str($),") "),v.racc_debug_out.$puts(r.$inspect()),v.racc_debug_out.$puts()}),m(o,"$racc_shift",function($,C,r){var v=this;return v.racc_debug_out.$puts("shift   "+v.$racc_token2str($)),v.$racc_print_stacks(C,r),v.racc_debug_out.$puts()}),m(o,"$racc_reduce",function($,C,r,v){var a=this,ee=t;return(ee=a.racc_debug_out).$print("reduce "),c($["$empty?"]())?ee.$print(" <none>"):j($,"each",[],function te(O){return null==O&&(O=t),ee.$print(" ",(null==te.$$s?this:te.$$s).$racc_token2str(O))},{$$s:a}),ee.$puts(" --\x3e "+a.$racc_token2str(C)),a.$racc_print_stacks(r,v),a.racc_debug_out.$puts()}),m(o,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),m(o,"$racc_e_pop",function($,C,r){var v=this;return v.racc_debug_out.$puts("error recovering mode: pop token"),v.$racc_print_states($),v.$racc_print_stacks(C,r),v.racc_debug_out.$puts()}),m(o,"$racc_next_state",function($,C){var r=this;return r.racc_debug_out.$puts("goto    "+$),r.$racc_print_states(C),r.racc_debug_out.$puts()}),m(o,"$racc_print_stacks",function($,C){var v=t;return(v=this.racc_debug_out).$print("        ["),j($,"each_index",[],function a(ee){return null==ee&&(ee=t),v.$print(" (",(null==a.$$s?this:a.$$s).$racc_token2str($["$[]"](ee))," ",C["$[]"](ee).$inspect(),")")},{$$s:this}),v.$puts(" ]")}),m(o,"$racc_print_states",function($){var r=t;return(r=this.racc_debug_out).$print("        ["),j($,"each",[],function(a){return null==a&&(a=t),r.$print(" ",a)}),r.$puts(" ]")}),m(o,"$racc_token2str",function($){var r;return c(r=i(this.$class(),"Racc_token_to_s_table")["$[]"]($))?r:this.$raise("[Racc Bug] can't convert token "+$+" to string")}),m(o,"$token_to_str",function($){return i(this.$class(),"Racc_token_to_s_table")["$[]"]($)})}(u[0],u)},Opal.modules["bcdice/arithmetic/node"]=function(e){var l,t,T,s,o,q,w,y,u,V=e.module,G=e.klass,c=e.def,W=e.thrower,I=e.return_ivar,f=e.send2,U=e.find_super,m=e.eqeq,E=e.const_set,j=e.eqeqeq,Y=e.rb_divide,J=e.truthy,S=e.assign_ivar,K=e.alias,F=[],A=e.nil,n=e.$$$;return l=F,t=u=[V(F[0],"BCDice")].concat(l),T=y=[V(u[0],"Arithmetic")].concat(t),q=[V(y[0],"Node")].concat(T),w=e.$r(q),(o=(s=G(q[0],null,"BinaryOp")).$$prototype).lhs=o.rhs=o.op=A,c(s,"$initialize",function(N,x,k){var $=this;return $.lhs=N,$.op=x,$.rhs=k}),c(s,"$eval",function(N){try{W("eval_return");var C,k=this,$=A;return $=k.lhs.$eval(N),C=k.rhs.$eval(N),$.$send(k.op,C)}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),c(s,"$output",function(){var N=this;return""+N.lhs.$output()+N.op+N.rhs.$output()}),c(s,"$s_exp",function(){var N=this;return"("+N.$op_for_s_exp()+" "+N.lhs.$s_exp()+" "+N.rhs.$s_exp()+")"}),c(s,"$op_for_s_exp",I("op")),function(d,b,s){var o=G(d,b,"DivideBase"),_=[o].concat(s),N=e.$r(_),x=o.$$prototype;x.lhs=x.rhs=x.op=A,c(o,"$initialize",function k($,C){return k.$$p=null,f(this,U(this,"initialize",k,!1,!0),"initialize",[$,"/",C],null)}),c(o,"$eval",function($){try{W("eval_return");var v,a,r=this;return v=r.lhs.$eval($),a=r.rhs.$eval($),m(a,0)&&r.$raise(N("ZeroDivisionError")),r.$divide_and_round(v,a,$)}catch(ee){if(ee===e.t_eval_return)return ee.$v;throw ee}}),c(o,"$output",function k(){var $=k.$$p||A,C=this;return k.$$p=null,""+f(C,U(C,"output",k,!1,!0),"output",[],$)+C.$rounding_method()}),o.$private(),c(o,"$rounding_method",function(){return n(this.$class(),"ROUNDING_METHOD")}),c(o,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),c(o,"$divide_and_round",function($,C,r){return this.$raise(N("NotImplementedError"))})}(q[0],w("BinaryOp"),q),function(d,b,s){var o=G(d,b,"DivideWithGameSystemDefault"),_=[o].concat(s),N=e.$r(_);E(_[0],"ROUNDING_METHOD",""),o.$private(),c(o,"$divide_and_round",function(k,$,C){var r,v=A;return j(n(N("RoundType"),"CEIL"),r=C)?Y(k.$to_f(),$).$ceil():j(n(N("RoundType"),"ROUND"),r)?(v=Y(k.$to_f(),$),J(v["$negative?"]())?v.$abs().$round()["$-@"]():v.$round()):Y(k,$).$floor()})}(q[0],w("DivideBase"),q),function(d,b,s){var o=G(d,b,"DivideWithCeil"),_=[o].concat(s);E(_[0],"ROUNDING_METHOD","C"),o.$private(),c(o,"$divide_and_round",function(x,k,$){return Y(x.$to_f(),k).$ceil()})}(q[0],w("DivideBase"),q),function(d,b,s){var o=G(d,b,"DivideWithRound"),_=[o].concat(s);E(_[0],"ROUNDING_METHOD","R"),o.$private(),c(o,"$divide_and_round",function(x,k,$){var C=A;return C=Y(x.$to_f(),k),J(C["$negative?"]())?C.$abs().$round()["$-@"]():C.$round()})}(q[0],w("DivideBase"),q),function(d,b,s){var o=G(d,b,"DivideWithFloor"),_=[o].concat(s);E(_[0],"ROUNDING_METHOD","F"),o.$private(),c(o,"$divide_and_round",function(x,k,$){return Y(x,k).$floor()})}(q[0],w("DivideBase"),q),function(d,b){var s=G(d,null,"Negative");s.$$prototype.body=A,c(s,"$initialize",S("body")),c(s,"$eval",function(N){try{return W("eval_return"),this.body.$eval(N)["$-@"]()}catch($){if($===e.t_eval_return)return $.$v;throw $}}),c(s,"$output",function(){return"-"+this.body.$output()}),c(s,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(q[0]),function(d,b){var s=G(d,null,"Parenthesis");s.$$prototype.expr=A,c(s,"$initialize",S("expr")),c(s,"$eval",function(N){try{return W("eval_return"),this.expr.$eval(N)}catch($){if($===e.t_eval_return)return $.$v;throw $}}),c(s,"$output",function(){return"("+this.expr.$output()+")"}),c(s,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(q[0]),function(d,b){var s=G(d,null,"Number");return s.$$prototype.value=A,c(s,"$initialize",S("value")),c(s,"$eval",I("value")),c(s,"$output",function(){return this.value.$to_s()}),K(s,"s_exp","output")}(q[0])},Opal.modules.strscan=function(e){var S,K,F,A,n,G=e.def,c=e.truthy,W=e.eqeqeq,I=e.Opal,f=e.return_ivar,U=e.send,m=e.alias,E=[],j=e.nil;return S=E,F=[K=(0,e.klass)(E[0],null,"StringScanner")].concat(S),A=e.$r(F),(n=K.$$prototype).pos=n.string=n.working=n.matched=n.prev_pos=n.match=j,K.$attr_reader("pos","matched"),G(K,"$initialize",function(l){var g=this;return g.string=l,g.pos=0,g.matched=j,g.working=l,g.match=[]}),K.$attr_reader("string"),G(K,"$beginning_of_line?",function(){var l=this;return 0===l.pos||"\n"===l.string.charAt(l.pos-1)}),G(K,"$scan",function(l){var g=this,u=(l=g.$anchor(l)).exec(g.working);return null==u?g.matched=j:(g.prev_pos=g.pos,g.pos+=u[0].length,g.working=g.working.substring(u[0].length),g.matched=u[0],g.match=u,u[0])}),G(K,"$scan_until",function(l){var g=this;l=g.$anchor(l);for(var u=g.working,z=0;u.length!=z;++z){var t=l.exec(u.substr(z));if(null!==t){var i=z+t[0].length,y=u.substr(0,i);return g.matched=t[0],g.match=t,g.prev_pos=g.pos+z,g.pos+=i,g.working=u.substr(i),y}}return g.matched=j}),G(K,"$[]",function(l){var u;if(c(this.match["$empty?"]()))return j;W(A("Symbol"),u=l)?l=l.$to_s():W(A("String"),u)||(l=I["$coerce_to!"](l,A("Integer"),"to_int"));var z=this.match;return l<0&&(l+=z.length),l<0||l>=z.length||null==z[l]?j:z[l]}),G(K,"$check",function(l){var g=this,u=(l=g.$anchor(l)).exec(g.working);return g.matched=null==u?j:u[0]}),G(K,"$check_until",function(l){var g=this,u=g.prev_pos,z=g.pos,t=g.working,i=g.$scan_until(l);return g.prev_pos=u,g.pos=z,g.working=t,i}),G(K,"$peek",function(l){return this.working.substring(0,l)}),G(K,"$eos?",function(){return 0===this.working.length}),G(K,"$exist?",function(l){var u=l.exec(this.working);return null==u?j:0==u.index?0:u.index+1}),G(K,"$skip",function(l){var g=this,u=(l=g.$anchor(l)).exec(g.working);if(null==u)return g.match=[],g.matched=j;var z=u[0],t=z.length;return g.matched=z,g.match=u,g.prev_pos=g.pos,g.pos+=t,g.working=g.working.substring(t),t}),G(K,"$skip_until",function(l){var u=this.$scan_until(l);return u===j?j:(this.matched=u.substr(-1),u.length)}),G(K,"$get_byte",function(){var l=this,g=j;return l.pos<l.string.length?(l.prev_pos=l.pos,l.pos+=1,g=l.matched=l.working.substring(0,1),l.working=l.working.substring(1)):l.matched=j,g}),G(K,"$match?",function(l){var g=this,u=(l=g.$anchor(l)).exec(g.working);return null==u?j:(g.prev_pos=g.pos,u[0].length)}),G(K,"$pos=",function(l){var g=this;return l<0&&(l+=g.string.$length()),g.pos=l,g.working=g.string.slice(l)}),G(K,"$matched_size",function(){return this.matched===j?j:this.matched.length}),G(K,"$post_match",function(){var l=this;return l.matched===j?j:l.string.substr(l.pos)}),G(K,"$pre_match",function(){var l=this;return l.matched===j?j:l.string.substr(0,l.prev_pos)}),G(K,"$reset",function(){var l=this;return l.working=l.string,l.matched=j,l.pos=0}),G(K,"$rest",f("working")),G(K,"$rest?",function(){return 0!==this.working.length}),G(K,"$rest_size",function(){return this.$rest().$size()}),G(K,"$terminate",function(){var l,g=this;return g.match=j,l=[g.string.$length()],U(g,"pos=",l),l[l.length-1]}),G(K,"$unscan",function(){var l=this;return l.pos=l.prev_pos,l.prev_pos=j,l.match=j,l}),m(K,"bol?","beginning_of_line?"),m(K,"getch","get_byte"),K.$private(),G(K,"$anchor",function(l){var g=l.toString().match(/\/([^\/]+)$/);return g=g?g[1]:void 0,new RegExp("^(?:"+l.source+")",g)})},Opal.modules["bcdice/normalize"]=function(e){var m,J,j,V=e.module,G=e.eqeqeq,c=e.def,W=e.eqeq,I=[],f=e.nil;return m=I,j=[V(I[0],"BCDice")].concat(m),(J=V(j[0],"Normalize")).$module_function(),c(J,"$comparison_operator",function(K){var F;return G(/<=|=</,F=K)?"<=":G(/>=|=>/,F)?">=":G(/<>|!=|=!/,F)?"!=":G(/</,F)?"<":G(/>/,F)?">":G(/=/,F)?"==":f}),c(J,"$target_number",function(K){return W(K,"?")?K:K.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var S,n,z,t,i,y,L,l,F,V=e.module,G=e.klass,c=e.const_set,W=e.hash2,I=e.truthy,f=e.send,U=e.def,m=e.thrower,E=e.top,j=[],Y=e.nil;return E.$require("strscan"),E.$require("bcdice/normalize"),S=j,n=F=[V(j[0],"BCDice")].concat(S),z=l=[V(F[0],"Command")].concat(n),i=[t=G(l[0],null,"Lexer")].concat(z),y=e.$r(i),(L=t.$$prototype).scanner=L.notations=Y,c(i[0],"SYMBOLS",W(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),U(t,"$initialize",function(D,q){var w,d,s;return D=I(s=(w=(d=D)===Y||null==d?Y:d.$split(" ",2))===Y||null==w?Y:w.$first())?s:"",this.scanner=y("StringScanner").$new(D),this.notations=f(q,"map",[],function(_){return null==_&&(_=Y),I(_["$is_a?"](y("String")))?y("Regexp").$new(_):_})}),U(t,"$next_token",function(){try{var D=m("return"),q=this,w=Y,d=Y,s=Y,o=Y;return I(q.scanner["$eos?"]())?[!1,"$"]:(f(q.notations,"each",[],function _(N){var k,x=null==_.$$s?this:_.$$s;if(null==x.scanner&&(x.scanner=Y),null==N&&(N=Y),k=x.scanner.$scan(N),!I(k))return Y;D.$throw(["NOTATION",k])},{$$s:q,$$ret:D}),I(w=q.scanner.$scan(/\d+/))?["NUMBER",w.$to_i()]:I(d=q.scanner.$scan(/[<>!=]+/))?(d=y("Normalize").$comparison_operator(d),[I(d)?"CMP_OP":"ILLEGAL",d]):(s=q.scanner.$getch().$upcase(),[I(o=y("SYMBOLS")["$[]"](s))?o:s.$to_sym(),s]))}catch(_){if(_===D)return _.$v;throw _}}),U(t,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var E,S,H,l,g,u,z,F,Y,V=e.module,G=e.klass,c=e.def,W=e.return_ivar,I=e.truthy,f=[],U=e.nil;return E=f,S=Y=[V(f[0],"BCDice")].concat(E),H=F=[V(Y[0],"Command")].concat(S),g=[l=G(F[0],null,"Parsed")].concat(H),u=e.$r(g),(z=l.$$prototype).critical=z.fumble=z.dollar=z.modify_number=z.question_target=z.target_number=z.prefix_number=z.command=z.suffix_number=z.cmp_op=U,l.$attr_accessor("command"),l.$attr_accessor("prefix_number"),l.$attr_accessor("suffix_number"),l.$attr_accessor("critical"),l.$attr_accessor("fumble"),l.$attr_accessor("dollar"),l.$attr_accessor("modify_number"),l.$attr_accessor("cmp_op"),l.$attr_accessor("target_number"),l.$attr_writer("question_target"),c(l,"$initialize",function(){var i=this;return i.prefix_number=U,i.suffix_number=U,i.critical=U,i.fumble=U,i.dollar=U,i.cmp_op=U,i.target_number=U,i.question_target=!1}),c(l,"$question_target?",W("question_target")),c(l,"$to_s",function(i){var y=this,L=U,T=U,D=U,q=U,w=U;switch(null==i&&(i="after_command"),L=I(y.critical)?"@"+y.critical:U,T=I(y.fumble)?"#"+y.fumble:U,D=I(y.dollar)?"$"+y.dollar:U,q=u("Format").$modifier(y.modify_number),w=I(y.question_target)?"?":y.target_number,i.valueOf()){case"after_command":return[y.prefix_number,y.command,y.suffix_number,L,T,D,q,y.cmp_op,w].$join();case"after_modify_number":return[y.prefix_number,y.command,y.suffix_number,q,L,T,D,y.cmp_op,w].$join();case"after_target_number":return[y.prefix_number,y.command,y.suffix_number,q,y.cmp_op,w,L,T,D].$join();default:return U}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var i,D,o,C,r,v,a,ee,te,O,_e,ce,ue,_,k,$,ae,w,d,L,V=e.klass,G=e.module,c=e.slice,W=e.extract_kwargs,I=e.ensure_kwargs,f=e.get_kwarg,U=e.send2,m=e.find_super,E=e.def,j=e.send,Y=e.eqeq,J=e.thrower,S=e.hash,K=e.const_set,F=e.truthy,A=e.to_ary,n=e.hash2,H=e.top,l=[],g=e.$r(l),u=e.nil,z=e.$$$;return H.$require("racc/parser.rb"),H.$require("bcdice/arithmetic/node"),H.$require("bcdice/command/lexer"),H.$require("bcdice/command/parsed"),V(z(g("BCDice"),"Command"),z(g("Racc"),"Parser"),"Parser"),i=l,D=L=[G(l[0],"BCDice")].concat(i),w=[G(L[0],"Command")].concat(D),d=e.$r(w),o=w,k=[_=V(w[0],z(d("Racc"),"Parser"),"Parser")].concat(o),$=e.$r(k),(ae=_.$$prototype).notations=ae.lexer=ae.modifier=ae.suffix_number=ae.prefix_number=ae.need_suffix_number=ae.need_prefix_number=ae.critical=ae.fumble=ae.dollar=ae.allowed_cmp_op=ae.question_target=u,E(_,"$initialize",function re(R,Z){var P,h,Q,p,X=this;return re.$$p=null,P=c(arguments),h=W(P),h=I(h),Q=P,p=f(h,"round_type"),U(X,m(X,"initialize",re,!1,!0),"initialize",[],null),X.notations=Q,X.round_type=p,X.prefix_number=!1,X.suffix_number=!1,X.need_prefix_number=!1,X.need_suffix_number=!1,X.modifier=!0,X.critical=!1,X.fumble=!1,X.dollar=!1,X.allowed_cmp_op=[u,">=",">","<=","<","==","!="],X.question_target=!1},-2),E(_,"$disable_modifier",function(){return this.modifier=!1,this}),E(_,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),E(_,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),E(_,"$has_prefix_number",function(){var R=this;return R.prefix_number=!0,R.need_prefix_number=!0,R}),E(_,"$has_suffix_number",function(){var R=this;return R.suffix_number=!0,R.need_suffix_number=!0,R}),E(_,"$enable_critical",function(){return this.critical=!0,this}),E(_,"$enable_fumble",function(){return this.fumble=!0,this}),E(_,"$enable_dollar",function(){return this.dollar=!0,this}),E(_,"$restrict_cmp_op_to",function(R){var Z;return Z=c(arguments),this.allowed_cmp_op=Z,this},-1),E(_,"$enable_question_target",function(){return this.question_target=!0,this}),E(_,"$parse",function(R){var Z=this;try{return Z.lexer=$("Lexer").$new(R,Z.notations),Z.$do_parse()}catch(P){if(!e.rescue(P,[$("ParseError"),$("ZeroDivisionError")]))throw P;try{return u}finally{e.pop_exception()}}}),_.$private(),E(_,"$parsed",function(R,Z,P,h){try{return J("eval_return"),j($("Parsed").$new(),"tap",[],function M(X){var B,ne,$e,fe,de,me,ve,he=null==M.$$s?this:M.$$s;return null==he.round_type&&(he.round_type=u),null==X&&(X=u),X["$command="](R["$[]"]("command")),X["$prefix_number="]((B=R["$[]"]("prefix"))===u||null==B?u:B.$eval(he.round_type)),X["$suffix_number="]((ne=R["$[]"]("suffix"))===u||null==ne?u:ne.$eval(he.round_type)),X["$critical="](($e=Z["$[]"]("critical"))===u||null==$e?u:$e.$eval(he.round_type)),X["$fumble="]((fe=Z["$[]"]("fumble"))===u||null==fe?u:fe.$eval(he.round_type)),X["$dollar="]((de=Z["$[]"]("dollar"))===u||null==de?u:de.$eval(he.round_type)),X["$modify_number="](P.$eval(he.round_type)),X["$cmp_op="](h["$[]"]("cmp_op")),Y(h["$[]"]("target"),"?")?(X["$question_target="](!0),j(X,"target_number=",me=[0]),me[me.length-1]):(X["$question_target="](!1),me=[(ve=h["$[]"]("target"),ve===u||null==ve?u:ve.$eval(he.round_type))],j(X,"target_number=",me),me[me.length-1])},{$$s:this})}catch(M){if(M===e.t_eval_return)return M.$v;throw M}}),E(_,"$next_token",function(){return this.lexer.$next_token()}),C=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),r=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),v=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),a=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),ee=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),te=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),O=[u,6,13,3,9,-1,27,-15,-10,-1,-38],_e=[u,u,u,u,u,u,19,16,15,u,u],ce=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ue=S(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),K(k[0],"Racc_arg",[C,r,a,v,ee,te,_e,O,19,ce,ue,58,35,!0]),F($("Ractor","skip_raise")?"constant":u)&&$("Ractor").$make_shareable($("Racc_arg")),K(k[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),F($("Ractor","skip_raise")?"constant":u)&&$("Ractor").$make_shareable($("Racc_token_to_s_table")),K(k[0],"Racc_debug_parser",!1),E(_,"$_reduce_1",function(R,Z,P){var h,p=this;return F(p.modifier)||p.$raise($("ParseError")),h=A(R),p.$parsed(null==h[0]?u:h[0],null==h[1]?u:h[1],null==h[2]?u:h[2],null==h[3]?u:h[3])}),E(_,"$_reduce_2",function(R,Z,P){var h,p=this;return F(p.modifier)||p.$raise($("ParseError")),h=A(R),p.$parsed(null==h[0]?u:h[0],null==h[2]?u:h[2],null==h[1]?u:h[1],null==h[3]?u:h[3])}),E(_,"$_reduce_3",function(R,Z,P){var h,B;return B=null==(h=A(R))[2]?u:h[2],this.$parsed(null==h[0]?u:h[0],null==h[1]?u:h[1],z(z($("Arithmetic"),"Node"),"Number").$new(0),B)}),E(_,"$_reduce_4",function(R,Z,P){var h=this;return F(h.prefix_number)&&F(h.suffix_number)||h.$raise($("ParseError")),n(["command","prefix","suffix"],{command:R["$[]"](1),prefix:R["$[]"](0),suffix:R["$[]"](2)})}),E(_,"$_reduce_5",function(R,Z,P){var h=this;return F(h.prefix_number)||h.$raise($("ParseError")),F(h.need_suffix_number)&&h.$raise($("ParseError")),n(["command","prefix"],{command:R["$[]"](1),prefix:R["$[]"](0)})}),E(_,"$_reduce_6",function(R,Z,P){var h=this;return F(h.suffix_number)||h.$raise($("ParseError")),F(h.need_prefix_number)&&h.$raise($("ParseError")),n(["command","suffix"],{command:R["$[]"](0),suffix:R["$[]"](1)})}),E(_,"$_reduce_7",function(R,Z,P){var h=this;return(F(h.need_prefix_number)||F(h.need_suffix_number))&&h.$raise($("ParseError")),n(["command"],{command:R["$[]"](0)})}),E(_,"$_reduce_8",function(R,Z,P){return n([],{})}),E(_,"$_reduce_9",function(R,Z,P){var h,B,M=u;return M=null==(h=A(R))[0]?u:h[0],B=null==h[2]?u:h[2],F(this.critical)&&F(M["$[]"]("critical")["$nil?"]())||this.$raise($("ParseError")),M["$[]="]("critical",B),M}),E(_,"$_reduce_10",function(R,Z,P){var h,B,M=u;return M=null==(h=A(R))[0]?u:h[0],B=null==h[2]?u:h[2],F(this.fumble)&&F(M["$[]"]("fumble")["$nil?"]())||this.$raise($("ParseError")),M["$[]="]("fumble",B),M}),E(_,"$_reduce_11",function(R,Z,P){var h,B,M=u;return M=null==(h=A(R))[0]?u:h[0],B=null==h[2]?u:h[2],F(this.dollar)&&F(M["$[]"]("dollar")["$nil?"]())||this.$raise($("ParseError")),M["$[]="]("dollar",B),M}),E(_,"$_reduce_12",function(R,Z,P){return R["$[]"](1)}),E(_,"$_reduce_13",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"Negative").$new(R["$[]"](1))}),E(_,"$_reduce_14",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"+",R["$[]"](2))}),E(_,"$_reduce_15",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"-",R["$[]"](2))}),E(_,"$_reduce_16",function(R,Z,P){return F(this.allowed_cmp_op["$include?"](u))||this.$raise($("ParseError")),n([],{})}),E(_,"$_reduce_17",function(R,Z,P){var h,M,X;return X=null==(h=A(R))[1]?u:h[1],F(this.allowed_cmp_op["$include?"](M=null==h[0]?u:h[0]))||this.$raise($("ParseError")),n(["cmp_op","target"],{cmp_op:M,target:X})}),E(_,"$_reduce_18",function(R,Z,P){var Q,h=this;return Q=R["$[]"](0),F(h.question_target)||h.$raise($("ParseError")),F(h.allowed_cmp_op["$include?"](Q))||h.$raise($("ParseError")),n(["cmp_op","target"],{cmp_op:Q,target:"?"})}),E(_,"$_reduce_19",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"+",R["$[]"](2))}),E(_,"$_reduce_20",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"-",R["$[]"](2))}),E(_,"$_reduce_22",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"*",R["$[]"](2))}),E(_,"$_reduce_23",function(R,Z,P){return R["$[]"](3).$new(R["$[]"](0),R["$[]"](2))}),E(_,"$_reduce_25",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),E(_,"$_reduce_26",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"DivideWithCeil")}),E(_,"$_reduce_27",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"DivideWithCeil")}),E(_,"$_reduce_28",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"DivideWithRound")}),E(_,"$_reduce_29",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"DivideWithFloor")}),E(_,"$_reduce_30",function(R,Z,P){return R["$[]"](1)}),E(_,"$_reduce_31",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"Negative").$new(R["$[]"](1))}),E(_,"$_reduce_33",function(R,Z,P){return R["$[]"](1)}),E(_,"$_reduce_34",function(R,Z,P){return z(z($("Arithmetic"),"Node"),"Number").$new(R["$[]"](0))}),E(_,"$_reduce_none",function(R,Z,P){return R["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var j,K,H,l,g,u,A,J,V=e.module,G=e.send,c=e.eqeqeq,W=e.truthy,I=e.def,f=e.return_val,U=[],m=e.nil;return j=U,K=J=[V(U[0],"BCDice")].concat(j),H=A=[V(J[0],"Deprecated")].concat(K),g=[l=V(A[0],"Checker")].concat(H),u=e.$r(g),l.$private(),I(l,"$check_result_legacy",function(t,i,y,L){var w,T=this,D=m,q=m,d=m,b=m;return D=G(i,"map",[],"sides".$to_proc()),w=(q=G(i,"map",[],"value".$to_proc())).$sum(),d=c([100],b=D)?T.$check_1D100(t,w,y,L):c([20],b)?T.$check_1D20(t,w,y,L):c([6,6],b)?T.$check_2D6(t,w,q,y,L):m,(W(d["$nil?"]())||W(d["$empty?"]()))&&(d=c([10],b=D.$uniq())?T.$check_nD10(t,w,q,y,L):c([6],b)?T.$check_nD6(t,w,q,y,L):m,W(d["$nil?"]())||W(d["$empty?"]()))?m:u("Result").$new(d.$delete_prefix(" \uff1e "))}),I(l,"$check_1D100",f(m)),I(l,"$check_1D20",f(m)),I(l,"$check_nD10",f(m)),I(l,"$check_2D6",f(m)),I(l,"$check_nD6",f(m))},Opal.modules["bcdice/base"]=function(e){var g,T,b,x,$,C,s,o,_,N,q,V=e.module,G=e.klass,c=e.slice,W=e.rb_plus,I=e.truthy,f=e.def,U=e.regexp,m=e.send,E=e.thrower,j=e.return_ivar,Y=e.assign_ivar_val,J=e.eqeqeq,S=e.eqeq,K=e.return_val,F=e.range,A=e.rb_minus,n=e.rb_divide,H=e.rb_times,l=e.rb_ge,u=e.top,z=[],t=e.$r(z),i=e.nil,y=e.$$$;return u.$require("i18n"),u.$require("i18n/backend/fallbacks"),u.$require("bcdice/randomizer"),u.$require("bcdice/dice_table"),u.$require("bcdice/enum"),u.$require("bcdice/translate"),u.$require("bcdice/result"),u.$require("bcdice/command/parser"),u.$require("bcdice/deprecated/checker"),T=z,b=q=[V(z[0],"BCDice")].concat(T),o=[s=G(q[0],null,"Base")].concat(b),_=e.$r(o),(N=s.$$prototype).raw_input=N.randomizer=N.enabled_upcase_input=N.debug=i,$=[x=e.get_singleton_class(s)].concat(o),C=e.$r($),x.$attr_reader("prefixes"),f(x,"$register_prefix",function(v){var ee,O;return null==this.prefixes&&(this.prefixes=i),ee=c(arguments),this.prefixes=W(I(O=this.prefixes)?O:[],ee.$flatten())},-1),f(x,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),f(x,"$prefixes_pattern",function(){var v=this,a=i;return null==v.prefixes_pattern&&(v.prefixes_pattern=i),null==v.prefixes&&(v.prefixes=i),v.prefixes_pattern=I(a=v.prefixes_pattern)?a:i,I(v.prefixes_pattern)?v.prefixes_pattern:(v.prefixes=I(a=v.prefixes)?a:[],v.prefixes.$freeze(),v.prefixes_pattern=(I(v.prefixes["$empty?"]())?/(?!)/:U(["^(S)?(",v.prefixes.$join("|"),")"],"i")).$freeze())}),f(x,"$command_pattern",function(){var v=this,a=i,ee=i;return null==v.command_pattern&&(v.command_pattern=i),null==v.prefixes&&(v.prefixes=i),v.command_pattern=I(a=v.command_pattern)?a:i,I(v.command_pattern)?v.command_pattern:(v.prefixes=I(a=v.prefixes)?a:[],v.prefixes.$freeze(),ee=W(m(y(C("CommonCommand"),"COMMANDS"),"map",[],function(O){return null==O&&(O=i),y(O,"PREFIX_PATTERN").$source()}),v.prefixes),v.command_pattern=U(["^S?(",ee.$join("|"),")"],"i").$freeze())}),f(x,"$eval",function(v){try{return E("eval_return"),this.$new(v).$eval()}catch(te){if(te===e.t_eval_return)return te.$v;throw te}}),s.$include(_("Translate")),s.$include(y(_("Deprecated"),"Checker")),f(s,"$initialize",function(k){var $=this;return $.raw_input=k,$.sort_add_dice=!1,$.sort_barabara_dice=!1,$.d66_sort_type=y(_("D66SortType"),"NO_SORT"),$.enabled_d9=!1,$.round_type=y(_("RoundType"),"FLOOR"),$.sides_implicit_d=6,$.upper_dice_reroll_threshold=i,$.reroll_dice_reroll_threshold=i,$.default_cmp_op=i,$.default_target_number=i,$.enabled_upcase_input=!0,$.locale="ja_jp",$.randomizer=y(_("BCDice"),"Randomizer").$new(),$.debug=!1}),s.$attr_accessor("randomizer"),s.$attr_reader("d66_sort_type"),s.$attr_reader("round_type"),s.$attr_reader("sides_implicit_d"),s.$attr_reader("upper_dice_reroll_threshold"),s.$attr_reader("reroll_dice_reroll_threshold"),s.$attr_reader("default_cmp_op"),s.$attr_reader("default_target_number"),f(s,"$sort_add_dice?",j("sort_add_dice")),f(s,"$sort_barabara_dice?",j("sort_barabara_dice")),f(s,"$enabled_d9?",j("enabled_d9")),f(s,"$enable_debug",Y("debug",!0)),f(s,"$eval",function(){var $,r,k=this,C=i;return $=y(_("BCDice"),"Preprocessor").$process(k.raw_input,k),C=I(r=k.$dice_command($))?r:k.$eval_common_command(k.raw_input),I(C)?(C["$rands="](k.randomizer.$rand_results()),C["$detailed_rands="](k.randomizer.$detailed_rand_results()),C):i}),f(s,"$change_text",function(k){return k}),f(s,"$check_result",function(k,$,C,r){var v=this,a=i,ee=i,te=i,O=i,_e=i;return a=v.$check_result_legacy(k,$,C,r),I(a)?a:(ee=m($,"map",[],"sides".$to_proc()),O=(te=m($,"map",[],"value".$to_proc())).$sum(),a=J([100],_e=ee)?v.$result_1d100(k,O,C,r):J([20],_e)?v.$result_1d20(k,O,C,r):J([6,6],_e)?v.$result_2d6(k,O,te,C,r):i,S(a,_("Result").$nothing())?i:I(a)?a:(a=J([10],_e=ee.$uniq())?v.$result_nd10(k,O,te,C,r):J([6],_e)?v.$result_nd6(k,O,te,C,r):i,S(a,_("Result").$nothing())?i:I(a)?a:v.$result_ndx(k,C,r)))}),f(s,"$grich_text",K(i)),s.$private(),f(s,"$eval_common_command",function(k){try{E("eval_return");var C=E("return");return k=this.$change_text(k),m(y(_("CommonCommand"),"COMMANDS"),"each",[],function v(a){var te,ee=null==v.$$s?this:v.$$s;if(null==ee.randomizer&&(ee.randomizer=i),null==a&&(a=i),te=a.$eval(k,ee,ee.randomizer),!I(te))return i;C.$throw(te)},{$$s:this,$$ret:C}),i}catch(v){if(v===e.t_eval_return||v===C)return v.$v;throw v}}),f(s,"$dice_command",function(k){var $=this,C=i,r=i,v=i,a=i;return I($.enabled_upcase_input)&&(k=k.$upcase()),C=$.$class().$prefixes_pattern().$match(k),I(C)?(r=C["$[]"](1)["$nil?"]()["$!"](),I(r)&&(k=k["$[]"](F(1,-1,!1))),v=$.$eval_game_system_specific_command(k),I(v["$is_a?"](_("Result")))?(v["$secret="](I(a=v["$secret?"]())?a:r),v):I(v["$nil?"]())||I(v["$empty?"]())||S(v,"1")?i:m(_("Result").$new(),"tap",[],function(te){var O;return null==te&&(te=i),te["$text="](v.$to_s()),m(te,"secret=",O=[r]),O[O.length-1]})):i}),f(s,"$eval_game_system_specific_command",K(i)),f(s,"$result_ndx",function(k,$,C){return I(C["$is_a?"](_("String")))?i:I(k.$send($,C))?_("Result").$success(this.$translate("success")):_("Result").$failure(this.$translate("failure"))}),f(s,"$result_1d100",K(i)),f(s,"$result_1d20",K(i)),f(s,"$result_nd10",K(i)),f(s,"$result_2d6",K(i)),f(s,"$result_nd6",K(i)),f(s,"$get_table_by_2d6",function(k){return this.$get_table_by_nD6(k,2)}),f(s,"$get_table_by_1d6",function(k){return this.$get_table_by_nD6(k,1)}),f(s,"$get_table_by_nD6",function(k,$){return this.$get_table_by_nDx(k,$,6)}),f(s,"$get_table_by_nDx",function(k,$,C){var v,a=i;return v=this.randomizer.$roll_sum($,C),a=this.$get_table_value(k["$[]"](A(v,$))),I(a["$nil?"]())?["1",0]:[a,v]}),f(s,"$get_table_by_1d3",function(k){var r,v,$=this,a=i;return $.$debug("get_table_by_1d3"),r=$.randomizer.$roll_sum(1,6),$.$debug("num",r),v=n(A(r,1),2).$to_i(),$.$debug("index",v),a=k["$[]"](v),I(a["$nil?"]())?["1",0]:[a,r]}),f(s,"$get_table_by_d66_swap",function(k){var C;return C=this.randomizer.$roll_d66(y(_("D66SortType"),"ASC")),[this.$get_table_by_number(C,k),C]}),f(s,"$get_table_by_d66",function(k){var C,r,v,ee,a=i;return C=this.randomizer.$roll_once(6),r=this.randomizer.$roll_once(6),v=W(H(A(C,1),6),A(r,1)),a=k["$[]"](v),ee=""+C+r,I(a["$nil?"]())?["1",ee]:[a,ee]}),f(s,"$get_table_by_number",function(k,$,C){try{var r=E("return");return null==C&&(C="1"),m($,"each",[],function a(ee){var O,te=null==a.$$s?this:a.$$s;if(null==ee&&(ee=i),O=ee["$[]"](0),!I(l(O,k)))return i;r.$throw(te.$get_table_value(ee["$[]"](1)))},{$$s:this,$$ret:r}),this.$get_table_value(C)}catch(a){if(a===r)return a.$v;throw a}},-3),f(s,"$get_table_value",function(k){return I(k["$is_a?"](_("Proc")))?k.$call():k}),f(s,"$roll_tables",function(k,$){var r=i;return r=$["$[]"](k),I(r)?r.$roll(this.randomizer).$to_s():i}),f(s,"$debug",function(k,$){var r,v=this,a=i,ee=i;return r=c(arguments,1),I(v.debug)?(a=I(k["$is_a?"](_("String")))?k:k.$inspect(),I(r["$empty?"]())?v.$warn(a):(ee=m(r,"map",[],function(O){return null==O&&(O=i),I(O["$is_a?"](_("String")))?'"'+O+'"':O.$inspect()}),v.$warn(a+": "+ee.$join(", ")))):i},-2),y(y(t("I18n"),"Backend"),"Simple").$include(y(y(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),t("I18n")["$default_locale="]("ja_jp"),g=[["ja_jp"]],m(t("I18n").$fallbacks(),"defaults=",g),g[g.length-1]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var Y,F,u,L,T,D,q,t,n,H,S,V=e.module,G=e.klass,c=e.const_set,W=e.hash2,I=e.truthy,f=e.def,m=[],E=e.nil;return e.top.$require("strscan"),Y=m,F=S=[V(m[0],"BCDice")].concat(Y),n=[V(S[0],"GameSystem")].concat(F),H=e.$r(n),u=n,L=t=[G(n[0],H("Base"),"SwordWorld")].concat(u),D=[T=G(t[0],null,"RatingLexer")].concat(L),q=e.$r(D),T.$$prototype.scanner=E,c(D[0],"SYMBOLS",W(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),f(T,"$initialize",function(b){var s,o,N;return b=I(N=(s=(o=b)===E||null==o?E:o.$split(" ",2))===E||null==s?E:s.$first())?N:"",this.scanner=q("StringScanner").$new(b)}),f(T,"$next_token",function(){var b=this,s=E,o=E,N=E;return I(b.scanner["$eos?"]())?[!1,"$"]:I(s=b.scanner.$scan(/\d+/))?["NUMBER",s.$to_i()]:(o=b.scanner.$getch().$upcase(),[I(N=q("SYMBOLS")["$[]"](o))?N:o.$to_sym(),o])}),f(T,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){var J,A,z,T,D,q,w,d,i,H,l,K,V=e.module,G=e.klass,c=e.def,W=e.truthy,I=e.rb_le,f=e.rb_plus,U=e.rb_lt,m=e.neqeq,E=[],j=e.nil;return J=E,A=K=[V(E[0],"BCDice")].concat(J),H=[V(K[0],"GameSystem")].concat(A),l=e.$r(H),z=H,T=i=[G(H[0],l("Base"),"SwordWorld")].concat(z),q=[D=G(i[0],null,"RatingParsed")].concat(T),w=e.$r(q),(d=D.$$prototype).modifier_after_half=d.modifier_after_one_and_a_half=d.semi_fixed_val=d.kept_modify=d.rate=d.greatest_fortune=d.modifier=j,D.$attr_accessor("rate"),D.$attr_accessor("critical"),D.$attr_accessor("kept_modify"),D.$attr_accessor("first_to"),D.$attr_accessor("first_modify"),D.$attr_accessor("rateup"),D.$attr_accessor("greatest_fortune"),D.$attr_accessor("semi_fixed_val"),D.$attr_accessor("tmp_fixed_val"),D.$attr_accessor("modifier"),D.$attr_accessor("modifier_after_half"),D.$attr_accessor("modifier_after_one_and_a_half"),c(D,"$initialize",function(s,o){var _=this;return _.rate=s,_.modifier=o,_.critical=13,_.kept_modify=0,_.first_to=0,_.first_modify=0,_.greatest_fortune=!1,_.rateup=0,_.semi_fixed_val=0,_.tmp_fixed_val=0,_.modifier_after_half=j,_.modifier_after_one_and_a_half=j}),c(D,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()}),c(D,"$one_and_a_half",function(){return this.modifier_after_one_and_a_half["$nil?"]()["$!"]()}),c(D,"$min_critical",function(){var s=this;return W(I(s.semi_fixed_val,1))?3:f(f(s.semi_fixed_val,s.kept_modify),2).$clamp(3,13)}),c(D,"$infinite_roll?",function(){return U(this.$critical(),this.$min_critical())}),c(D,"$to_s",function(){var s=this,o=j;return o="KeyNo."+s.rate,W(U(s.$critical(),13))&&(o=f(o,"c["+s.$critical()+"]")),m(s.$first_modify(),0)&&(o=f(o,"m["+w("Format").$modifier(s.$first_modify())+"]")),m(s.$first_to(),0)&&(o=f(o,"m["+s.$first_to()+"]")),m(s.$rateup(),0)&&(o=f(o,"r["+s.$rateup()+"]")),W(s.greatest_fortune)&&(o=f(o,"gf")),m(s.$semi_fixed_val(),0)&&(o=f(o,"sf["+s.$semi_fixed_val()+"]")),m(s.$tmp_fixed_val(),0)&&(o=f(o,"tf["+s.$tmp_fixed_val()+"]")),m(s.$kept_modify(),0)&&(o=f(o,"a["+w("Format").$modifier(s.$kept_modify())+"]")),m(s.modifier,0)&&(o=f(o,w("Format").$modifier(s.modifier))),o})},Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(e){var m,J,H,t,g,K,F,j,V=e.module,G=e.klass,c=e.truthy,W=e.def,I=[];return m=I,J=j=[V(I[0],"BCDice")].concat(m),K=[V(j[0],"GameSystem")].concat(J),F=e.$r(K),H=K,g=[G(K[0],F("Base"),"SwordWorld")].concat(H),(t=G(g[0],null,"RatingOptions")).$attr_accessor("critical"),t.$attr_accessor("kept_modify"),t.$attr_accessor("first_to"),t.$attr_accessor("first_modify"),t.$attr_accessor("rateup"),t.$attr_accessor("greatest_fortune"),t.$attr_accessor("semi_fixed_val"),t.$attr_accessor("tmp_fixed_val"),t.$attr_accessor("modifier"),t.$attr_accessor("modifier_after_half"),t.$attr_accessor("modifier_after_one_and_a_half"),W(t,"$settable_first_roll_adjust_option?",function(){var L;return c(L=this.$first_modify()["$nil?"]())?this.$first_to()["$nil?"]():L}),W(t,"$settable_non_2d_roll_option?",function(){var L,T,y=this;return c(L=c(T=y.$greatest_fortune()["$nil?"]())?y.$semi_fixed_val()["$nil?"]():T)?y.$tmp_fixed_val()["$nil?"]():L})},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){var g,i,w,N,v,a,ee,te,O,_e,ce,oe,se,ie,x,C,r,R,b,s,L,T,z,V=e.module,G=e.klass,c=e.ensure_kwargs,W=e.send2,I=e.find_super,f=e.def,U=e.send,m=e.truthy,E=e.not,j=e.thrower,Y=e.hash,J=e.const_set,S=e.to_ary,K=e.eqeq,F=e.top,A=[],n=e.nil,H=e.$$$;return F.$require("racc/parser.rb"),F.$require("bcdice/arithmetic/node"),F.$require("bcdice/enum"),F.$require("bcdice/game_system/sword_world/rating_lexer"),F.$require("bcdice/game_system/sword_world/rating_parsed"),F.$require("bcdice/game_system/sword_world/rating_options"),g=A,i=z=[V(A[0],"BCDice")].concat(g),L=[V(z[0],"GameSystem")].concat(i),T=e.$r(L),w=L,b=[G(L[0],T("Base"),"SwordWorld")].concat(w),s=e.$r(b),N=b,C=[x=G(b[0],H(s("Racc"),"Parser"),"RatingParser")].concat(N),r=e.$r(C),(R=x.$$prototype).lexer=R.round_type=R.version=n,f(x,"$initialize",function Z(P){var h,Q,M=this;return Z.$$p=null,null==(h=(P=c(P)).$$smap.version)&&(h="v1_0"),null==(Q=P.$$smap.round_type)&&(Q=H(r("RoundType"),"CEIL")),W(M,I(M,"initialize",Z,!1,!0),"initialize",[],null),M.version=h,M.round_type=Q},-1),f(x,"$set_debug",function(){return this.yydebug=!0,this}),f(x,"$parse",function(P){try{return this.lexer=r("RatingLexer").$new(P),this.$do_parse()}catch(Q){if(!e.rescue(Q,[r("ParseError"),r("ZeroDivisionError")]))throw Q;try{return n}finally{e.pop_exception()}}}),x.$private(),f(x,"$parsed",function(P,h,Q){try{return j("eval_return"),U(r("RatingParsed").$new(P,h),"tap",[],function X(B){var ne,$e,fe,de,me,ve,he,ye,pe,ge=null==X.$$s?this:X.$$s,be=n;return null==ge.round_type&&(ge.round_type=n),null==B&&(B=n),B["$kept_modify="](m(be=(ne=Q.$kept_modify())===n||null==ne?n:ne.$eval(ge.round_type))?be:0),B["$first_to="](m(be=Q.$first_to())?be:0),B["$first_modify="](m(be=Q.$first_modify())?be:0),B["$rateup="](m(be=($e=Q.$rateup())===n||null==$e?n:$e.$eval(ge.round_type))?be:0),E(Q.$greatest_fortune()["$nil?"]())&&B["$greatest_fortune="](Q.$greatest_fortune()),B["$semi_fixed_val="](m(be=(fe=Q.$semi_fixed_val())===n||null==fe?n:fe.$clamp(1,6))?be:0),B["$tmp_fixed_val="](m(be=(de=Q.$tmp_fixed_val())===n||null==de?n:de.$clamp(1,6))?be:0),B["$modifier_after_half="]((me=Q.$modifier_after_half())===n||null==me?n:me.$eval(ge.round_type)),B["$modifier_after_one_and_a_half="]((ve=Q.$modifier_after_one_and_a_half())===n||null==ve?n:ve.$eval(ge.round_type)),he=[m((pe=Q.$critical(),ye=pe===n||null==pe?n:pe.$eval(ge.round_type),be=ye===n||null==ye?n:ye.$clamp(0,13)))?be:m(B.$half())||m(B.$one_and_a_half())?13:10],U(B,"critical=",he),he[he.length-1]},{$$s:this})}catch(X){if(X===e.t_eval_return)return X.$v;throw X}}),f(x,"$next_token",function(){return this.lexer.$next_token()}),v=e.large_array_unpack("18,16,17,19,6,20,21,23,24,64,65,27,28,13,66,14,22,15,18,16,17,19,5,20,21,23,24,5,9,3,4,13,10,14,22,15,18,16,17,19,11,20,21,23,24,34,5,34,40,13,42,14,22,15,30,31,30,31,33,34,33,34,62,63,62,63,34,43,30,31,30,31,33,34,33,30,31,44,34,33,34,52,30,31,57,34,33,30,31,30,31,33,34,33,30,31,58,34,33,34,60,30,31,61,34,33,30,31,30,31,33,34,33,30,31,,34,33,34,,30,31,,34,33,30,31,30,31,33,36,33,30,31,62,63,33,62,63,37,38,62,63,62,63,62,63"),a=e.large_array_unpack("7,7,7,7,1,7,7,7,7,55,55,12,12,7,55,7,7,7,25,25,25,25,3,25,25,25,25,0,4,0,0,25,5,25,25,25,49,49,49,49,6,49,49,49,49,13,9,14,17,49,19,49,49,49,13,13,14,14,13,16,14,18,46,46,48,48,22,20,16,16,18,18,16,23,18,22,22,21,24,22,27,29,23,23,37,28,23,24,24,27,27,24,30,27,28,28,38,31,28,33,43,30,30,44,40,30,31,31,33,33,31,62,33,40,40,,63,40,64,,62,62,,65,62,63,63,64,64,63,15,64,65,65,50,50,65,51,51,15,15,56,56,69,69,70,70"),ee=e.large_array_unpack("24,4,,19,23,30,40,-4,,43,,,0,43,45,128,57,43,59,42,59,69,64,71,76,14,,78,83,63,90,95,,97,,,,82,94,,102,,,98,101,,49,,51,32,121,124,,,,-2,128,,,,,,109,114,116,121,,,,130,132"),te=e.large_array_unpack("-36,-36,-5,-36,-36,-36,-36,-1,-5,-36,-4,71,-6,-36,-36,-36,-12,-36,-36,-36,-36,-36,-36,-36,-36,-2,-5,-36,-36,-36,-36,-36,-33,-36,-35,-8,-9,-36,-36,-13,-14,-16,-17,-36,-36,-20,-21,-30,-22,-3,-23,-24,-7,-31,-32,-36,-27,-10,-11,-15,-18,-19,-36,-36,-36,-36,-34,-28,-29,-25,-26"),O=e.large_array_unpack("29,35,7,39,1,41,46,48,25,45,50,51,2,55,,8,56,53,54,,,26,,,,,49,59,,,,,,,,,,,,,,,,,,,,69,70,67,68"),_e=e.large_array_unpack("5,5,3,5,1,5,6,6,3,5,6,6,2,7,,2,6,5,5,,,2,,,,,3,5,,,,,,,,,,,,,,,,,,,,6,6,5,5"),ce=[n,4,12,0,n,-13,-17,-20,n],oe=[n,n,n,n,12,47,n,n,32],se=e.large_array_unpack("0,0,racc_error,2,23,_reduce_1,3,23,_reduce_2,4,23,_reduce_3,2,24,_reduce_4,0,25,_reduce_5,2,25,_reduce_6,4,25,_reduce_7,3,25,_reduce_8,3,25,_reduce_9,4,25,_reduce_10,4,25,_reduce_11,2,25,_reduce_12,3,25,_reduce_13,3,25,_reduce_14,4,25,_reduce_15,3,25,_reduce_16,3,25,_reduce_17,4,25,_reduce_18,4,25,_reduce_19,3,25,_reduce_20,2,26,_reduce_21,2,26,_reduce_22,3,26,_reduce_23,3,26,_reduce_24,3,29,_reduce_25,3,29,_reduce_26,1,29,_reduce_none,3,28,_reduce_28,3,28,_reduce_29,1,28,_reduce_none,2,27,_reduce_31,2,27,_reduce_32,1,27,_reduce_none,3,30,_reduce_34,1,30,_reduce_35"),ie=Y(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"O",6,"G",7,"F",8,"S",9,"T",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16,"BRACKETL",17,"BRACKETR",18,"AT",19,"SHARP",20,"DOLLAR",21),J(C[0],"Racc_arg",[v,a,te,ee,O,_e,oe,ce,22,se,ie,71,36,!0]),m(r("Ractor","skip_raise")?"constant":n)&&r("Ractor").$make_shareable(r("Racc_arg")),J(C[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","O","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),m(r("Ractor","skip_raise")?"constant":n)&&r("Ractor").$make_shareable(r("Racc_token_to_s_table")),J(C[0],"Racc_debug_parser",!1),f(x,"$_reduce_1",function(P,h,Q){try{j("eval_return");var M,ne,de,$e=n,fe=n;return ne=null==(M=S(P))[0]?n:M[0],fe=m(de=($e=null==M[1]?n:M[1]).$modifier())?de:H(H(r("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ne,fe.$eval(this.round_type),$e)}catch(me){if(me===e.t_eval_return)return me.$v;throw me}}),f(x,"$_reduce_2",function(P,h,Q){try{j("eval_return");var M,$e,de,B=this,fe=n,me=n;return $e=null==(M=S(P))[1]?n:M[1],m((fe=null==M[2]?n:M[2]).$modifier_after_one_and_a_half())&&B.$raise(r("ParseError")),m(fe.$modifier_after_half())||fe["$modifier_after_half="](H(H(r("Arithmetic"),"Node"),"Number").$new(0)),me=m(de=fe.$modifier())?de:H(H(r("Arithmetic"),"Node"),"Number").$new(0),B.$parsed($e,me.$eval(B.round_type),fe)}catch(ve){if(ve===e.t_eval_return)return ve.$v;throw ve}}),f(x,"$_reduce_3",function(P,h,Q){try{j("eval_return");var M,$e,de,B=this,fe=n,me=n;return $e=null==(M=S(P))[2]?n:M[2],m((fe=null==M[3]?n:M[3]).$modifier_after_half())&&B.$raise(r("ParseError")),m(fe.$modifier_after_one_and_a_half())||fe["$modifier_after_one_and_a_half="](H(H(r("Arithmetic"),"Node"),"Number").$new(0)),me=m(de=fe.$modifier())?de:H(H(r("Arithmetic"),"Node"),"Number").$new(0),B.$parsed($e,me.$eval(B.round_type),fe)}catch(ve){if(ve===e.t_eval_return)return ve.$v;throw ve}}),f(x,"$_reduce_4",function(P,h,Q){return P["$[]"](1).$to_i()}),f(x,"$_reduce_5",function(P,h,Q){return r("RatingOptions").$new()}),f(x,"$_reduce_6",function(P,h,Q){var p,ne,B=n;return ne=null==(p=S(P))[1]?n:p[1],m((B=null==p[0]?n:p[0]).$modifier()["$nil?"]())||this.$raise(r("ParseError")),B["$modifier="](ne),B}),f(x,"$_reduce_7",function(P,h,Q){var p,$e,B=n;return $e=null==(p=S(P))[2]?n:p[2],m((B=null==p[0]?n:p[0]).$critical()["$nil?"]())||this.$raise(r("ParseError")),B["$critical="]($e),B}),f(x,"$_reduce_8",function(P,h,Q){var p,$e,B=n;return $e=null==(p=S(P))[2]?n:p[2],m((B=null==p[0]?n:p[0]).$critical()["$nil?"]())||this.$raise(r("ParseError")),B["$critical="]($e),B}),f(x,"$_reduce_9",function(P,h,Q){var p,B=n,$e=n;return $e=null==(p=S(P))[2]?n:p[2],m((B=null==p[0]?n:p[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),B["$first_to="]($e.$to_i()),B}),f(x,"$_reduce_10",function(P,h,Q){var p,B=n,$e=n;return $e=null==(p=S(P))[3]?n:p[3],m((B=null==p[0]?n:p[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),B["$first_modify="]($e.$to_i()),B}),f(x,"$_reduce_11",function(P,h,Q){var p,B=n,$e=n;return $e=null==(p=S(P))[3]?n:p[3],m((B=null==p[0]?n:p[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),B["$first_modify="]($e.$to_i()["$-@"]()),B}),f(x,"$_reduce_12",function(P,h,Q){var p,B=n;return p=S(P),m((B=null==p[0]?n:p[0]).$modifier_after_half()["$nil?"]())||this.$raise(r("ParseError")),B["$modifier_after_half="](H(H(r("Arithmetic"),"Node"),"Number").$new(0)),B}),f(x,"$_reduce_13",function(P,h,Q){var p,$e,B=n;return $e=null==(p=S(P))[2]?n:p[2],m((B=null==p[0]?n:p[0]).$modifier_after_half()["$nil?"]())||this.$raise(r("ParseError")),B["$modifier_after_half="]($e),B}),f(x,"$_reduce_14",function(P,h,Q){var p,B=n;return p=S(P),m((B=null==p[0]?n:p[0]).$modifier_after_one_and_a_half())&&this.$raise(r("ParseError")),B["$modifier_after_one_and_a_half="](H(H(r("Arithmetic"),"Node"),"Number").$new(0)),B}),f(x,"$_reduce_15",function(P,h,Q){var p,$e,B=n;return $e=null==(p=S(P))[3]?n:p[3],m((B=null==p[0]?n:p[0]).$modifier_after_one_and_a_half())&&this.$raise(r("ParseError")),B["$modifier_after_one_and_a_half="]($e),B}),f(x,"$_reduce_16",function(P,h,Q){var p,$e,B=n;return B=null==(p=S(P))[0]?n:p[0],$e=null==p[2]?n:p[2],m(["v2_5","v2_0"]["$include?"](this.version))&&m(B.$rateup()["$nil?"]())||this.$raise(r("ParseError")),B["$rateup="]($e),B}),f(x,"$_reduce_17",function(P,h,Q){var p,B=n;return B=null==(p=S(P))[0]?n:p[0],m(["v2_5","v2_0"]["$include?"](this.version))&&m(B["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),B["$greatest_fortune="](!0),B}),f(x,"$_reduce_18",function(P,h,Q){var p,B=n,$e=n;return B=null==(p=S(P))[0]?n:p[0],$e=null==p[3]?n:p[3],m(["v2_5","v2_0"]["$include?"](this.version))&&m(B["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),B["$semi_fixed_val="]($e.$to_i()),B}),f(x,"$_reduce_19",function(P,h,Q){var p,B=n,$e=n;return B=null==(p=S(P))[0]?n:p[0],$e=null==p[3]?n:p[3],m(["v2_5","v2_0"]["$include?"](this.version))&&m(B["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),B["$tmp_fixed_val="]($e.$to_i()),B}),f(x,"$_reduce_20",function(P,h,Q){var p,$e,B=n;return B=null==(p=S(P))[0]?n:p[0],$e=null==p[2]?n:p[2],K(this.version,"v2_5")&&m(B.$kept_modify()["$nil?"]())||this.$raise(r("ParseError")),B["$kept_modify="]($e),B}),f(x,"$_reduce_21",function(P,h,Q){return P["$[]"](1)}),f(x,"$_reduce_22",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"Negative").$new(P["$[]"](1))}),f(x,"$_reduce_23",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"+",P["$[]"](2))}),f(x,"$_reduce_24",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"-",P["$[]"](2))}),f(x,"$_reduce_25",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"+",P["$[]"](2))}),f(x,"$_reduce_26",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"-",P["$[]"](2))}),f(x,"$_reduce_28",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"*",P["$[]"](2))}),f(x,"$_reduce_29",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(P["$[]"](0),P["$[]"](2))}),f(x,"$_reduce_31",function(P,h,Q){return P["$[]"](1)}),f(x,"$_reduce_32",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"Negative").$new(P["$[]"](1))}),f(x,"$_reduce_34",function(P,h,Q){return P["$[]"](1)}),f(x,"$_reduce_35",function(P,h,Q){return H(H(r("Arithmetic"),"Node"),"Number").$new(P["$[]"](0))}),f(x,"$_reduce_none",function(P,h,Q){return P["$[]"](0)})},Opal.modules["bcdice/game_system/SwordWorld"]=function(e){var L,w,N,x,k,$,C,b,s,D,V=e.module,G=e.klass,c=e.const_set,W=e.send2,I=e.find_super,f=e.def,U=e.truthy,m=e.rb_ge,E=e.rb_le,j=e.eqeq,Y=e.neqeq,J=e.rb_minus,S=e.rb_gt,K=e.hash2,F=e.send,A=e.to_ary,n=e.rb_plus,H=e.rb_lt,l=e.rb_times,g=e.thrower,u=e.rb_divide,z=e.top,t=[],i=e.nil;return z.$require("bcdice/base"),z.$require("bcdice/game_system/sword_world/rating_parser"),L=t,w=D=[V(t[0],"BCDice")].concat(L),b=[V(D[0],"GameSystem")].concat(w),s=e.$r(b),N=b,k=[x=G(b[0],s("Base"),"SwordWorld")].concat(N),$=e.$r(k),(C=x.$$prototype).rating_table=C.randomizer=i,c(k[0],"ID","SwordWorld"),c(k[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),c(k[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),c(k[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),x.$register_prefix("H?K"),f(x,"$initialize",function r(v){return r.$$p=null,W(this,I(this,"initialize",r,!1,!0),"initialize",[v],null),this.rating_table=0}),f(x,"$result_2d6",function(v,a,ee,te,O){return U(m(a,12))?$("Result").$critical(this.$translate("SwordWorld.critical")):U(E(a,2))?$("Result").$fumble(this.$translate("SwordWorld.fumble")):Y(te,">=")||j(O,"?")?i:U(m(v,O))?$("Result").$success(this.$translate("success")):$("Result").$failure(this.$translate("failure"))}),f(x,"$eval_game_system_specific_command",function(v){return this.$rating(v)}),x.$private(),f(x,"$rating_parser",function(){return $("RatingParser").$new()}),f(x,"$rating",function(v){var a,ee,te=this,O=i,_e=i,ce=i,oe=i,se=i,ue=i,le=i,ie=i,ae=i,re=i,R=i,Z=i,P=i,h=i,p=i,M=i;return te.$debug("rating string",v),O=te.$rating_parser().$parse(v),U(O)?(_e=te.$getSW2_0_RatingTable(),ce=J(_e.$length(),1),te.$debug("keyMax",ce),U(S(O.$rate(),ce))?$("Result").$new(te.$translate("SwordWorld.keynumber_exceeds",K(["keyMax"],{keyMax:ce}))):U(O["$infinite_roll?"]())?$("Result").$new(te.$translate("SwordWorld.infinite_critical",K(["min_critical"],{min_critical:O.$min_critical()}))):(oe=te.$getNewRates(_e),se=O+" \uff1e ",ue=[],le=[],ie=[],ae=0,re=0,R=0,Z=0,P=O.$first_to(),h=O.$first_modify(),function(){try{var X=g("break");return F(te,"loop",[],function B(){var ne,$e,ve,he,fe=null==B.$$s?this:B.$$s,de=i,me=i;if($e=fe.$rollDice(O,Z),me=null==(ne=A($e))[1]?i:ne[1],ae=de=null==ne[0]?i:ne[0],Y(P,0)?(ae=de=P,P=0):Y(h,0)&&(ae=n(ae,h),h=0),U(E(de,2))&&(ue["$<<"](de.$to_s()),le["$<<"](me.$to_s()),ie["$<<"]("**"),Z=n(Z,1),X.$throw()),Y(O.$kept_modify(),0)&&Y(ae,2)&&(ae=n(ae,O.$kept_modify())),U(H(ae,2))&&(ae=2),U(S(ae,12))&&(ae=12),ve=n(O.$rate(),l(Z,O.$rateup())).$clamp(0,ce),fe.$debug("currentKey",ve),he=oe["$[]"](ae)["$[]"](ve),fe.$debug("rateValue",he),R=n(R,he),re=n(re,ae),ue["$<<"](ae.$to_s()),le["$<<"](me.$to_s()),ie["$<<"](U(S(ae,2))?he:"**"),Z=n(Z,1),U(m(ae,O.$critical())))return i;X.$throw()},{$$s:te})}catch(B){if(B===X)return B.$v;throw B}}(),ee=te.$getResultText(R,O,le,ue,ie,re,Z),a=A(ee),p=null==a[1]?i:a[1],M=null==a[2]?i:a[2],se=n(se,null==a[0]?i:a[0]),F($("Result").$new(),"tap",[],function(B){var ne;return null==B&&(B=i),B["$text="](se),B["$critical="](p),F(B,"fumble=",ne=[M]),ne[ne.length-1]}))):(te.$debug("not matched"),"1")}),f(x,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]}),f(x,"$getNewRates",function(v){var a,ee,O=i,_e=i,ce=i,oe=i,se=i,ue=i,le=i,ie=i,ae=i,re=i,R=i;return O=[],_e=[],ce=[],oe=[],se=[],ue=[],le=[],ie=[],ae=[],re=[],R=[],F(v,"each",[],function(h){var Q=i;return null==h&&(h=i),Q=h.$split(/,/),R.$push(0),O.$push(Q["$[]"](1).$to_i()),_e.$push(Q["$[]"](2).$to_i()),ce.$push(Q["$[]"](3).$to_i()),oe.$push(Q["$[]"](4).$to_i()),se.$push(Q["$[]"](5).$to_i()),ue.$push(Q["$[]"](6).$to_i()),le.$push(Q["$[]"](7).$to_i()),ie.$push(Q["$[]"](8).$to_i()),ae.$push(Q["$[]"](9).$to_i()),re.$push(Q["$[]"](10).$to_i())}),j(this.rating_table,1)&&re["$[]="](31,(a=[32,(ee=[33,10],F(re,"[]=",ee),ee[ee.length-1])],F(re,"[]=",a),a[a.length-1])),[R,R,R,O,_e,ce,oe,se,ue,le,ie,ae,re]}),f(x,"$rollDice",function(v,a){var te=i;return[(te=this.randomizer.$roll_barabara(2,6)).$sum(),te.$join(",")]}),f(x,"$getResultText",function(v,a,ee,te,O,_e,ce){var se=i,ue=i,le=i,ie=i,ae=i;return(se=[]).$push("2D:["+ee.$join(" ")+"]="+te.$join(",")),U(E(_e,2))?(se.$push(O.$join(",")),se.$push(this.$translate("SwordWorld.fumble")),[se.$join(" \uff1e "),!1,!0]):(U(S(O.$size(),1))||Y(a.$modifier(),0)?(ue=n(O.$join(","),$("Format").$modifier(a.$modifier())),U(a.$half())?(ue="("+ue+")/2",Y(a.$modifier_after_half(),0)&&(ue=n(ue,$("Format").$modifier(a.$modifier_after_half())))):U(a.$one_and_a_half())&&(ue="("+ue+")*1.5",Y(a.$modifier_after_one_and_a_half(),0)&&(ue=n(ue,$("Format").$modifier(a.$modifier_after_one_and_a_half())))),se.$push(ue)):U(a.$half())?(ue=O.$first()+"/2",Y(a.$modifier_after_half(),0)&&(ue=n(ue,$("Format").$modifier(a.$modifier_after_half()))),se.$push(ue)):U(a.$one_and_a_half())&&(ue=O.$first()+"*1.5",Y(a.$modifier_after_one_and_a_half(),0)&&(ue=n(ue,$("Format").$modifier(a.$modifier_after_one_and_a_half()))),se.$push(ue)),U(S(ce,1))&&(le=this.$translate("SwordWorld.round_text",K(["reroll_count"],{reroll_count:J(ce,1)})),se.$push(le)),ie=n(v,a.$modifier()),U(a.$half())?(ie=u(ie,2).$ceil(),Y(a.$modifier_after_half(),0)&&(ie=n(ie,a.$modifier_after_half()))):U(a.$one_and_a_half())&&(ie=l(ie,1.5).$ceil(),Y(a.$modifier_after_one_and_a_half(),0)&&(ie=n(ie,a.$modifier_after_one_and_a_half()))),ae=ie.$to_s(),se.$push(ae),[se.$join(" \uff1e "),S(ce,1),!1])})},Opal.queue(function(e){var Y,F,u,z,t,n,H,S,V=e.module,G=e.klass,c=e.const_set,W=e.send2,I=e.find_super,f=e.def,m=[];return e.top.$require("bcdice/game_system/SwordWorld"),Y=m,F=S=[V(m[0],"BCDice")].concat(Y),n=[V(S[0],"GameSystem")].concat(F),H=e.$r(n),u=n,c((t=[z=G(n[0],H("SwordWorld"),"SwordWorld_SimplifiedChinese")].concat(u))[0],"ID","SwordWorld:SimplifiedChinese"),c(t[0],"NAME","\u5251\u4e16\u754c"),c(t[0],"SORT_KEY","\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c"),c(t[0],"HELP_MESSAGE","\u30fbSW\u3000\u5a01\u529b\u8868\u3000(Kx[c]+m$f) (x:\u5a01\u529b\u503c, c:\u66b4\u51fb\u503c, m:\u52a0\u503c, f:\u9ab0\u5b50\u51fa\u76ee\u4fee\u6b63)\n"),z.$register_prefix_from_super_class(),f(z,"$initialize",function i(y){var T=this;return i.$$p=null,W(T,I(T,"initialize",i,!1,!0),"initialize",[y],null),T.locale="zh_hans"})})}}]);